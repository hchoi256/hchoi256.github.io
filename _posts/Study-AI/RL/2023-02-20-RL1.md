---
layout: single
title: "[ê°•í™”í•™ìŠµ] Q-Learning ì´í•´í•˜ê¸°"
categories: RL
tag: [Reinforcement Learning, Q-Learning]
toc: true
toc_sticky: true
toc_label: "ì­ŒìŠ¤log"
#author_profile: false
header:
    teaser: /assets/images/posts/rl.png
sidebar:
    nav: "docs"
---

****
# í•œì¤„ìš”ì•½ âœ”

****
# Introduction ğŸ™Œ
![image](https://user-images.githubusercontent.com/39285147/220178882-8bf22966-234c-4860-a3cb-e57908aef2d5.png)

AlphaGoì˜ ë“±ì¥ ì´ë˜ ê°•í™”í•™ìŠµì— ëŒ€í•œ ê´€ì‹¬ì´ ê¸°í•˜ê¸‰ìˆ˜ì ìœ¼ë¡œ ì¦ê°€í–ˆê³ , 2023ë…„ í˜„ì¬ chatGPTì˜ ë“±ì¥ìœ¼ë¡œ ë‹¤ì–‘í•œ ì‚°ì—… ë¶„ì•¼ ì „ë°˜ì—ì„œ ê·¸ ì˜í–¥ë ¥ì´ ì–´ë§ˆë¬´ì‹œí•´ì§€ê³  ìˆë‹¤.

Dotaë¼ëŠ” ê²Œì„ì˜ í”„ë¡œê·¸ë˜ë¨¸ë¥¼ ê°•í™”í•™ìŠµ ê¸°ë°˜ ë¡œë´‡ì´ ì´ê¸´ ì‚¬ë¡€ ë˜í•œ ìˆì—ˆë‹¤.

![image](https://user-images.githubusercontent.com/39285147/220175123-39773555-453f-4b43-a7cd-b2e18c026ce3.png)

ìƒê¸° ì´ë¯¸ì§€ì—ì„œ, 18ë¶„ ì •ë„ ì‹¤íŒ¨ë¥¼ ê±°ë“­í•˜ë©° ìŠ¤ìŠ¤ë¡œ ê°•í™”í•™ìŠµí•œ ë¡œë´‡ì´ ì–´ëŠ ê³¨ë°˜ì„ êº¾ì–´ì•¼ ì „ë°©ìœ¼ë¡œ ë‚˜ì•„ê°ˆ ìˆ˜ ìˆëŠ”ì§€ ì œëŒ€ë¡œ í•™ìŠµí•œ ëª¨ìŠµì´ë‹¤.

í•˜ì—¬ ê°•í™”í•™ìŠµì˜ ì‘ìš© ë¶„ì•¼ëŠ” ë¬´ê¶ë¬´ì§„í•˜ë©°, í•„ìì˜ ê´€ì‹¬ ë¶„ì•¼ì¸ ììœ¨ì£¼í–‰ ì—°êµ¬ì—ë„ ë§ì´ ì‚¬ìš©ëœë‹¤.
- í…ŒìŠ¬ë¼ëŠ” ì•„ì§ `ëª¨ë°© í•™ìŠµ(imitation learning)` ê¸°ë°˜ìœ¼ë¡œ ììœ¨ì£¼í–‰ ê¸°ìˆ ì„ ì—°êµ¬í•˜ì§€ë§Œ, ì¥ì°¨ ê°•í™”í•™ìŠµìœ¼ë¡œ ì „í™˜í•˜ë ¤ëŠ” ì›€ì§ì„ì´ë‹¤.

## Deep Learning vs Reinforcement Learning
![image](https://user-images.githubusercontent.com/39285147/220175775-7e9cc013-92fa-4cb7-a494-5f758a48ee0b.png)

Deep learningê³¼ ê°•í™”í•™ìŠµì„ ë¿Œë¦¬ë¶€í„° ë‹¤ë¥´ë‹¤.

Deep learningì€ ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ë¼ëŠ” ì‹ ê²½ë§ì„ í™œìš©í•´ì„œ ì£¼ì–´ì§„ downstream taskë¥¼ ìŠ¤ìŠ¤ë¡œ í•™ìŠµí•˜ì—¬ ê° ë…¸ë“œ(íŠ¹ì§•)ë§ˆë‹¤ ìµœì ì˜ ê°€ì¤‘ì¹˜ë¥¼ ë°œê²¬í•˜ëŠ” ê³¼ì •ì´ë‹¤.

ê°•í™”í•™ìŠµì€ ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ ì‹ ê²½ë§ì„ êµ¬í˜„í•˜ì§€ ì•Šê³ , ë³´í†µ `model-free`í•˜ê²Œ ê° stageë³„ë§ˆë‹¤ ìµœì ì˜ ì„ íƒì„ í•˜ë©´ì„œ í•™ìŠµí•˜ëŠ” **greedy algorithm**ì´ë‹¤.

> `Model-free`: ì£¼ì–´ì§„ Environmentë¥¼ ëª¨ë¥´ëŠ” ìƒíƒœ.

ê·¸ë ‡ë‹¤ë©´ RLëŠ” ê³¼ì—° ë¬´ì—‡ì´ê³ , ì–´ë– í•œ ì•Œê³ ë¦¬ì¦˜ë“¤ë¡œ greedy í•™ìŠµì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì¸ì§€ ì‚´í´ë³´ì.

## Reinforcement Learningì´ë€
![image](https://user-images.githubusercontent.com/39285147/220176311-13f809d1-edff-481f-909d-7b7944984c98.png)

ê°•í™”í•™ìŠµì˜ ëª©í‘œëŠ” í™˜ê²½(environment)ê³¼ ìƒí˜¸ì‘ìš©í•˜ëŠ” ì„ì˜ì˜ ì—ì´ì „íŠ¸(agent)ë¥¼ í•™ìŠµì‹œí‚¤ëŠ” ê²ƒì´ë‹¤.

ì¼ë°˜ì ìœ¼ë¡œ ê°•í™”í•™ìŠµì€ **stage**, **reward**, **action**ì´ë¼ëŠ” ì„¸ ê°€ì§€ êµ¬ì„± ìš”ì†Œë¥¼ ê°€ì§€ê³  í•™ìŠµì„ ì§„í–‰í•œë‹¤.

ì—ì´ì „íŠ¸ëŠ” í™˜ê²½ ì†ì—ì„œ ìƒíƒœ(state)ë¥¼ ì¸ì‹í•˜ì—¬ í–‰ë™(action)í•˜ë©° í•™ìŠµí•´ ë‚˜ê°€ë©°, agentê°€ ì·¨í•œ í–‰ë™ì˜ ì‘ë‹µìœ¼ë¡œ í™˜ê²½ì€ ì–‘ìˆ˜ í˜¹ì€ ìŒìˆ˜ ë˜ëŠ” 0ì„ ë³´ìƒ(Reward)ìœ¼ë¡œ ê°–ëŠ”ë‹¤.

ì—ì´ì „íŠ¸ì˜ ëª©í‘œëŠ” ì´ˆê¸° ìƒíƒœë¶€í„° ì¢…ë£Œ ìƒíƒœê¹Œì§€ ë°›ì„ ìˆ˜ ìˆëŠ” ë³´ìƒì„ ìµœëŒ€í™”í•˜ëŠ” ê²ƒìœ¼ë¡œ, agentê°€ ì¢‹ì€ í–‰ë™ì„ í–ˆì„ ë•ŒëŠ” í° ë³´ìƒì„ ì£¼ì–´ ê·¸ í–‰ë™ì„ ê°•í™”í•˜ê³  ê·¸ë ‡ì§€ ì•Šì€ í–‰ë™ì„ í–ˆì„ ë•ŒëŠ” ì‘ì€ ë³´ìƒ í˜¹ì€ ìŒì˜ ë³´ìƒì„ ì¤€ë‹¤.

****
# Q-Learning âœ¨
QëŸ¬ë‹ì€ ê°•í™”í•™ìŠµ ê¸°ë²• ê°€ìš´ë° í•˜ë‚˜ë¡œ, ì•ŒíŒŒê³  ì´ì „ë¶€í„° ì¡´ì¬í–ˆë˜ í™”ì„ê°™ì€ ì•Œê³ ë¦¬ì¦˜ì…ë‹ˆë‹¤.

[*ëª¨ë‘ë¥¼ ìœ„í•œ ê°•í™”í•™ìŠµ - ê¹€ì„±í›ˆ*]

![image](https://user-images.githubusercontent.com/39285147/220176913-c784abe4-32bc-4a50-99ed-e12f910911c5.png)

QëŸ¬ë‹ ì´í•´ë¥¼ ìœ„í•´ Frozen Lakeë¼ëŠ” í™˜ê²½(environment)ë¥¼ í•˜ë‚˜ ê°€ì •í•˜ë ¤ í•©ë‹ˆë‹¤.

Frozen lake ë¬¸ì œëŠ” ë¹™íŒ ìœ„ì˜ ì—ì´ì „íŠ¸ê°€ ì‹œì‘ ì§€ì ì—ì„œ ì¶œë°œí•˜ì—¬ ëª©ì ì§€ê¹Œì§€ ìµœì ì˜ ê²½ë¡œë¡œ ë„ì°©í•´ì•¼ í•˜ëŠ” ë¬¸ì œì´ë‹¤. 

ë¹™íŒ ê³³ê³³ì—ëŠ” êµ¬ë©(hole)ì´ ìˆì–´ êµ¬ë©ì„ í”¼í•´ ëª©ì ì§€ì— ë„ì°©í•´ì•¼ í•œë‹¤.

> AgentëŠ” ì „ì²´ íŒì„ ë³¼ ìˆ˜ ì—†ê³  í˜„ì¬ ìƒíƒœë§Œ ì•Œ ìˆ˜ ìˆìœ¼ë©°, í–‰ë™ì„ ì—¬ëŸ¬ ë²ˆ ë°˜ë³µí•˜ë‹¤ê°€ ëª©ì ì§€(G)ì— ë„ì°©í•˜ë“ ê°€ êµ¬ë©ì— ë¹ ì ¸ì„œ ê²Œì„ì´ ëë‚˜ì„œì•¼ ì—ì´ì „íŠ¸ëŠ” í–‰ë™ì´ ì˜í•œ ê±´ì§€ ì•Œ ìˆ˜ ìˆë‹¤.

### Q-Value
![image](https://user-images.githubusercontent.com/39285147/220177518-2d7fe917-a4b5-4bd1-ae77-90fb8dea06c4.png)

ìƒê¸° ìˆ˜ì‹ì—ì„œ, agentëŠ” í˜„ì¬ $$s$$ë¼ëŠ” ìƒíƒœì—ì„œ $$a$$ë¼ëŠ” ì•¡ì…˜ì„ ì·¨í•˜ì—¬, $$s'$$ ìƒíƒœë¡œ ì´ë™í•œë‹¤.

$$a$$ë¼ëŠ” ì•¡ì…˜ì— ëŒ€í•´ agentëŠ” $$r$$ ë³´ìƒì„ ì–»ëŠ”ë‹¤.

![image](https://user-images.githubusercontent.com/39285147/220178912-b1cefe1b-8b1c-4471-aee0-1cc74253d1e6.png)

ë˜í•œ ì œìë¦¬ì—ì„œ ìœ„-ì•„ë˜ ë°˜ë³µì´ë™í•˜ì—¬ ë³´ìƒê°’ì„ ëˆ„ì í•˜ëŠ” ë¬´í•œë£¨í”„ í˜„ìƒì„ íƒ€íŒŒí•˜ê³ ì, `Discount factor`ë¼ëŠ” ê°œë…ì„ ë„ì…í•˜ì—¬ íŠ¹ì • Actionì„ ì·¨í–ˆì„ ë•Œ, Episodeê°€ ì¢…ë£Œë˜ê¸°ê¹Œì§€ rewardì˜ ì´í•©ì˜ ì˜ˆì¸¡ê°’ì„ ê³„ì‚°í•œë‹¤.

> `Discount Factor`: í˜„ì¬ ì–»ëŠ” ë³´ìƒì´ ë¯¸ë˜ì— ì–»ëŠ” ë³´ìƒë³´ë‹¤ ì–¼ë§ˆë‚˜ ë” ì¤‘ìš”í•œì§€ë¥¼ ì˜ë¯¸í•˜ëŠ” ê°’.

$$Q(): S \times A \rightarrow R$$

![image](https://user-images.githubusercontent.com/39285147/220179142-41aa3fee-263a-43dd-b9e4-34ef65a7fcf5.png)

- $$t$$: íŠ¹ì • ì‹œì .
- $$\gamma$$: `disconut factor`.

ì´ëŠ” ì–´ë–¤ ì‹œê°„ $$t$$ì—ì„œ ì „ëµ $$\pi$$ë¥¼ ë”°ë¼ í–‰ë™ $$a$$ë¥¼ í•  ë•Œ, ë¯¸ë˜ì˜ ë³´ìƒë“¤ì˜ ì´í•©ì˜ ê¸°ëŒ€ê°’ì´ë‹¤.

## Q Function
![image](https://user-images.githubusercontent.com/39285147/220177121-266bda7a-ac44-4233-9f2c-e8e2db7b6339.png)

Q Functionì€ **ìƒíƒœ-í–‰ë™ ê°€ì¹˜ í•¨ìˆ˜**ë¼ëŠ” ëª…ì¹­ìœ¼ë¡œë„ ë¶ˆë¦¬ë©°, ìƒíƒœ(state)ì™€ í–‰ë™(action)ì„ ì£¼ë©´ ì´ëŸ° ìƒíƒœì—ì„œ ì´ëŸ° í–‰ë™ì„ í•˜ë©´ ì–¼ë§ˆí¼ì˜ ë³´ìƒì„ ë°›ì„ ìˆ˜ ìˆëŠ”ì§€ ì•Œë ¤ì¤ë‹ˆë‹¤.

AgentëŠ” ê·¸ëŸ¬í•œ ë³´ìƒê°’ì„ ìµœëŒ€ë¡œ í•˜ëŠ” ì–´ë–¤ ì •ì±…(policy)ë¥¼ ì·¨í•˜ëŠ” í–‰ë™ì„ í•˜ë©´ ëœë‹¤ (í•˜ê¸° ìˆ˜ì‹ ì°¸ì¡°).

![image](https://user-images.githubusercontent.com/39285147/220177230-db3e2265-7d92-4ee7-b66d-14323b9cb0ac.png)

- $$\pi$$: ì •ì±….
- $$\pi^*$$: ìµœì ì˜ ì •ì±…; Që¥¼ ìµœëŒ€ë¡¤ í•˜ëŠ” actionì„ ì·¨í•˜ëŠ” ì •ì±…ì´ ìµœì ì´ë‹¤.

![image](https://user-images.githubusercontent.com/39285147/220179516-bf083f95-707c-484d-a762-d07601f5278c.png)

ì•Œê³ ë¦¬ì¦˜ì´ ì‹œì‘ë˜ê¸° ì „ì— Q í•¨ìˆ˜ëŠ” ê³ ì •ëœ ì„ì˜ì˜ ê°’ì„ ê°–ê³ , ë§¤ time-step($$t$$)ë§ˆë‹¤ AgentëŠ” í–‰ë™$$a$$ë¥¼ ì„ íƒí•˜ê²Œ ë˜ê³ , ë³´ìƒ$$r$$ë¥¼ ë°›ìœ¼ë©° ìƒˆë¡œìš´ ìƒíƒœ $$s_{t+1}$$ë¡œ ì „ì´í•˜ë©´ì„œ Q ê°’ì„ ê°±ì‹ í•œë‹¤.

ì´ ì•Œê³ ë¦¬ì¦˜ì˜ í•µì‹¬ì€ ì´ì „ì˜ ê°’ê³¼ ìƒˆë¡œìš´ ì •ë³´ì˜ ê°€ì¤‘í•©(weighted sum)ì„ ì´ìš©í•˜ëŠ” **Value Iteration Update** ê¸°ë²•ì´ë‹¤. 

****
# Reference
[ëª¨ë‘ë¥¼ ìœ„í•œ ê°•í™”í•™ìŠµ - ê¹€ì„±í›ˆ](https://www.facebook.com/groups/TensorFlowKR/permalink/431952443812486/)