---
layout: single
title: "[ììœ¨ì£¼í–‰ ì‹œë®¬ë ˆì´í„°] CARLA ì˜¤ë¸Œì íŠ¸ ìƒì„±, ë‚ ì”¨ ë³€ê²½, Autopilot, Spectator"
categories: CV
tag: [CARLA, Window, Python]
toc: true
toc_sticky: true
toc_label: "ì­ŒìŠ¤log"
#author_profile: false
header:
    teaser: /assets/images/posts/carla.jpg
sidebar:
    nav: "docs"
---

# INTRO ğŸ™Œ
ì´ì „ ì‹œê°„ì—ëŠ” CARLA ì„œë²„ ë° í´ë¼ì´ì–¸íŠ¸ ìƒì„± ë°©ë²•ì— ëŒ€í•´ ë‹¤ë¤˜ë‹¤.

ì´ë²ˆì—ëŠ” CARLA ì‹œë®¬ë ˆì´í„°ì—ì„œ **ê²Œì„ ì˜¤ë¸Œì íŠ¸ ìƒì„± ë° ë‚ ì”¨ ë³€ê²½** ë°©ë²•ì— ëŒ€í•´ ì•Œì•„ë³´ì.

> ì½”ë“œ ë¶„ì„ì€ ê° ë¼ì¸ë³„ ì£¼ì„ìœ¼ë¡œ ëŒ€ì²´í•œë‹¤.
>
> [GitHub Repository](#reference)ì—ì„œ ì´ë²ˆ í•™ìŠµ ëª¨ë“ˆ(Learning Task 2 & 3) íŒŒì¼ì„ ì—´ëŒí•  ìˆ˜ ìˆë‹¤.

# ì˜¤ë¸Œì íŠ¸ ìƒì„±í•˜ê¸° ğŸ‘“
## ì˜¤ë¸Œì íŠ¸ ë¶ˆëŸ¬ì˜¤ê¸°
CARLAëŠ” ì¹œì ˆí•˜ê²Œë„ ì›”ë“œ blueprintì—ì„œ ë‹¤ì–‘í•œ í˜„ì‹¤ ìš©ë¡€ ì˜¤ë¸Œì íŠ¸ í”„ë¦¬ì…‹ì„ ì œê³µí•œë‹¤.

                world = client.get_world()
                blueprint_library = world.get_blueprint_library()
                cone_bp_1 = blueprint_library.find('static.prop.constructioncone')
                
> *world* ì˜¤ë¸Œì íŠ¸ëŠ” 

ìƒê¸° ì½”ë“œë¥¼ í†µí•´, ê³µì‚¬ ì£¼ì˜ ê¼¬ê¹”ì„ ë‹´ì•„ì™”ë‹¤.

## ì˜¤ë¸Œì íŠ¸ ì†Œí™˜ ìœ„ì¹˜
ì´ë²ˆ ì˜ˆì œì—ì„œëŠ” ìˆ˜ë™ìœ¼ë¡œ ë¬´ì‘ìœ„ ì†Œí™˜ ìœ„ì¹˜ë¥¼ ì§€ì •í•´ë³´ì.

                import carla
                transform_1 = carla.Transform(carla.Location(x=-52, y=57, z=0))
                cone_1 = world.spawn_actor(cone_bp_1, transform_1)

![image](https://user-images.githubusercontent.com/39285147/195050681-247c998a-1976-4876-997e-f9da507a780c.png)

ì •ìƒì ìœ¼ë¡œ ê¼¬ê¹”ì´ ìƒì„±ëœ ëª¨ìŠµì´ë‹¤!

# ë‚ ì”¨ ë³€ê²½í•˜ê¸° ğŸ˜œ
ìš°ì„ , ì›”ë“œë§µ ê°ì²´ì—ì„œ ë‚ ì”¨ ê´€í•  ì˜¤ë¸Œì íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¤ì.

                weather = world.get_weather()

ì²« ë²ˆì¨° ì˜ˆì œë¡œ ì•ˆê°œë‚€ ë‚ ì”¨ë¥¼ êµ¬í˜„í•´ë³´ì.

                weather.sun_altitude_angle = -30
                weather.fog_density = 65
                weather.fog_distance = 10
                world.set_weather(weather)

![image](https://user-images.githubusercontent.com/39285147/195051083-c4fc155d-2d6b-4144-b293-a7c740e4abfa.png)

ë‘ ë²ˆì§¸ ì˜ˆì œë¡œ ë¹„ì˜¤ëŠ” ë‚ ì”¨ë¡œ ì„¸íŒ…í•´ë³´ì.

                weather.sun_altitude_angle = 10
                weather.cloudiness = 10
                weather.precipitation = 80
                weather.precipitation_deposits = 60
                world.set_weather(weather)

![image](https://user-images.githubusercontent.com/39285147/195051186-32bc7958-4059-4f35-a99d-02028b2f0521.png)

# Autopilot ëª¨ë“œ ğŸ§¿
í•˜ê¸° ì½”ë“œì—ì„œ 'model3'ëŠ” Tesla Model 3 blueprintë¥¼ ì§€ì¹­í•œë‹¤.

Tesla ìë™ì°¨ ëª¨ë¸ í”„ë¦¬ì…‹ ì¤‘ì—ì„œ *[0]* ì²« ë²ˆì§¸ ëª¨ë¸ì„ ê°€ì ¸ì˜¨ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.

                vehicle_1_bp = blueprint_library.filter('model3')[0] 
                spawn_points = world.get_map().get_spawn_points() # random spawn point
                spawn_point_1 = spawn_points[0] 
                vehicle_1 = world.spawn_actor(vehicle_1_bp, spawn_point_1) # create a vehicle object
                vehicle_1.set_autopilot(True) # autopilot mode turned on
                actor_list.append(vehicle_1) # add the vehicle to the world

ë¼ì¸ *vehicle_1.set_autopilot(True)* ì¶”ê°€ë¥¼ í†µí•´ í•´ë‹¹ ìë™ì°¨ ê°ì²´ì— ëŒ€í•´ ì˜¤í† íŒŒì¼ëŸ¿ ëª¨ë“œ ì§€ì›ì„ ì œê³µí•œë‹¤.

ì´ì œ, ìë™ì°¨ì— ëŒ€í•œ í˜•íƒœì— ëŒ€í•œ êµ¬í˜„ë¶€ëŠ” ëë‚¬ê³ , ì†ì„± ë¶€ë¶„ì„ ì •ì˜í•´ë³´ì.

ìë™ì°¨ ììœ¨ì£¼í–‰ì—ì„œ í•„ìš”í•œ ì†ë„ ë° ê°„ê²©ê³¼ ê°™ì€ ì†ì„±ì„ ì •ì˜í•˜ë ¤ê³  í•œë‹¤.

ìƒì„±í•œ ì›”ë“œì˜ ìë™ì°¨, í‘œì§€íŒ ë“± ëª¨ë“  êµí†µ ì •ë³´ë¥¼ ë‹´ê³ ìˆëŠ” ê°ì²´ë¥¼ ë¶ˆëŸ¬ì˜¤ì.

ì´ ê°ì²´ë¥¼ í†µí•´, í˜„ì¬ ìš°ë¦¬ì˜ íƒ€ê²Ÿ ìë™ì°¨ê°€ ë‹¤ë¥¸ ìë™ì°¨ì™€ì˜ ê°„ê²©ê³¼ ê°™ì€ ì†ì„±ì„ ì •ì˜í•  ê²ƒì´ë‹¤.

                tm = client.get_trafficmanager(8000)

ìš°ë¦¬ëŠ” í•´ë‹¹ ìë™ì°¨ê°€ ë‹¤ë¥¸ ìë™ì°¨ì™€ 2 ë¯¸í„° ê°„ê²©ì„ ìœ ì§€í•˜ê³  í˜„ì¬ ì†ë„ì—ì„œ 20% ì •ë„ ë¹ ë¥´ê²Œ ë‹¬ë¦¬ê¸¸ ì›í•œë‹¤.

                current_veh = vehicle_1
                tm.distance_to_leading_vehicle(current_veh,2) # 2ë¯¸í„° ê°„ê²©
                tm.vehicle_percentage_speed_difference(current_veh,-20) # 20% ë¹ ë¦„

ì´ ì†ì„±ê°’ë“¤ì„ ì¡°ì •í•˜ë©´ì„œ, ë‚œí­ ìš´ì „ì„ í•˜ëŠ” ììœ¨ì£¼í–‰ ìë™ì°¨ë¥¼ ì§ì ‘ ì‘ìš© êµ¬í˜„í•´ë³´ê¸¸ ì¶”ì²œí•œë‹¤.

# ì‹œì (Spectator) ë³€ê²½í•˜ê¸° ğŸ‘€
í•˜ê¸° ë°˜ë³µë¬¸ì€ ì¹´ë©”ë¼ ì‹œì  spectatorì˜ ìœ„ì¹˜ì™€ íšŒì „ê°’ì„ ì¡°ì •í•œë‹¤.

                while True:
                        transform = vehicle_1.get_transform()

                        spectator_location = transform.location + carla.Location(z=20) # í•˜ëŠ˜ ë°©í–¥ìœ¼ë¡œ 20ë§Œí¼ ì¤Œ ì•„ì›ƒ
                        spectator_rotation = carla.Rotation(pitch=-90) # 90ë„ ê¸°ìš¸ì—¬ì„œ ë³´ê¸°

![image](https://user-images.githubusercontent.com/39285147/195054080-052269b1-6787-49fe-ac58-de9b558a514e.png)

ì§€ë©´ì—ì„œ 20ë§Œí¼ ë–¨ì–´ì§„ í•˜ëŠ˜ì—ì„œ 90ë„ ê¸°ìš¸ì—¬ì„œ ë‚´ë ¤ë‹¤ ë³¸ ëª¨ìŠµìœ¼ë¡œ ì¹´ë©”ë¼ ì‹œì ì„ ì¡°ì •í–ˆë‹¤.

í•˜ê¸° 1ì¸ì¹­ ì‹œì ì€ ì§ì ‘ êµ¬í˜„í•´ë³´ê¸¸ ë°”ë€ë‹¤.

![image](https://user-images.githubusercontent.com/39285147/195054328-f80878f3-fe25-4a22-9a9e-22371866699e.png)

# Reference
[**GitHub Repository**](https://github.com/hchoi256/carla-research-project)

[*UW Madison CARLA Research Team*](https://cavh.cee.wisc.edu/carla-simulation-project/)

[*CARLA Simulator*](https://carla.readthedocs.io/en/latest/)