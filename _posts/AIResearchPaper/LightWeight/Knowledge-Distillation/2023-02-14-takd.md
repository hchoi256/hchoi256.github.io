---
layout: single
title: "[ë…¼ë¬¸ë¶„ì„] Teaching Assistant Knowledge Distillation"
categories: AIPaperLightWeight
tag: [Model Compression, Light-weight, Knowledge Distillation]
toc: true
toc_sticky: true
toc_label: "ì­ŒìŠ¤log"
#author_profile: false
header:
    teaser: /assets/images/posts/qntzn.png
sidebar:
    nav: "docs"
---

[ë…¼ë¬¸ë§í¬: Improved Knowledge Distillation via Teacher Assistant](https://arxiv.org/abs/1902.03393)

****
# í•œì¤„ìš”ì•½ âœ”
ê¸°ì¡´ ì§€ì‹ì¦ë¥˜ ë°©ì‹ì˜ ë¬¸ì œì ì€ Teacher~Student ì‚¬ì´ ì°¨ì´ê°€ ì‹¬í•  ê²½ìš°, ì •í™•ë„ê°€ ë–¨ì–´ì§€ëŠ” ê²½í–¥ì´ ìˆëŠ”ë°, ì œì•ˆëœ ë°©ë²• (TAKD)ëŠ” Teacherê³¼ Student ì‚¬ì´ `Teaching Assistant`ë¼ëŠ” ìƒˆë¡œìš´ ì¤‘ê°„ìë¥¼ ì¶”ê°€í•œë‹¤.

T~TA ê·¸ë¦¬ê³  TA~S, ì´ ë‘ ë²ˆì˜ ì§€ì‹ì¦ë¥˜ë¥¼ í†µí•˜ì—¬ ê¸°ì¡´ Teacherê³¼ Student ì‚¬ì´ ê°„ê·¹ì„ ì¢íŒë‹¤ (T: Teacher, TA: Teaching Assistant, S: Student).

****
# Introduction ğŸ™Œ
ìµœê·¼ ë”¥ëŸ¬ë‹ ëª¨ë¸ í¬ê¸°ê°€ ì»¤ì§€ë©´ì„œ ì •í™•ë„ í–¥ìƒì´ ì‡ë‹¬ì•˜ìœ¼ë‚˜, ë§ë‹¨ ì¥ë¹„ë“¤ì—ì„œ í•´ë‹¹ ëª¨ë¸ì„ ì ìš©ì‹œí‚¤ê¸° ì–´ë ¤ì›Œ ëª¨ë¸ ì••ì¶•ì— ëŒ€í•œ ê´€ì‹¬ë„ê°€ ë†’ì•„ì¡Œë‹¤.

ëª¨ë¸ ì••ì¶•ì—ëŠ” ì—¬ëŸ¬ ê°€ì§€ ë°©ë²•ì´ ìˆìœ¼ë‚˜, ì´ ê¸€ì—ì„œëŠ” **í–¥ìƒëœ ì§€ì‹ ì¦ë¥˜** ë°©ë²•ì„ ì†Œê°œí•œë‹¤.

## Knowledge Distillation (KD)
![image](https://user-images.githubusercontent.com/39285147/218952582-3a96a0f5-9164-4944-bfed-213e2a5d218a.png)

![image](https://user-images.githubusercontent.com/39285147/218954499-dad9bb52-ee05-4a89-9f72-ea1005130014.png)

ê±°ëŒ€ ëª¨ë¸ (Teacher)ì—ì„œ ì‘ì€ ëª¨ë¸ (Student)ë¡œ ì§€ì‹(ê°€ì¤‘ì¹˜)ë¥¼ ì „ë‹¬í•˜ì—¬, Studentê°€ ê±°ëŒ€ ëª¨ë¸ì˜ ì˜ˆì¸¡ì„ ëª¨ë°©(mimic)í•˜ë„ë¡ í•œë‹¤.

> **ì „ì´ í•™ìŠµ**ê³¼ì˜ ì°¨ì´ì ì€ ì „ì´ í•™ìŠµì€ ê¸°í•™ìŠµ ëª¨ë¸ì´ ë‹¤ë¥¸ taskë¥¼ ìˆ˜í–‰í•˜ì—¬ ì–»ì€ ê°€ì¤‘ì¹˜ë¥¼ ì „ë‹¬í•˜ì§€ë§Œ, ì§€ì‹ì¦ë¥˜ëŠ” ê°™ì€ taskë¥¼ ìˆ˜í–‰í•œ ê±°ëŒ€ ê¸°í•™ìŠµ ëª¨ë¸ì„ ì´ìš©í•œë‹¤.

### Student Network Loss
![image](https://user-images.githubusercontent.com/39285147/218953667-0fc3b4ed-d509-4249-b729-10f840ccf3aa.png)

$$H(): Cross\ entropy$$

$$a_s: input$$

$$y_r: ground-truth label$$

### KL Divergence
![image](https://user-images.githubusercontent.com/39285147/218953966-9f88bd20-acb7-4309-ac8c-f275ad5a3cf4.png)

$$y_s=softmax(\frac{a_s}{\tau})$$: Softened ouput of Student

$$y_r=softmax(\frac{a_t}{\tau})$$: Softened ouput of Teacher

$$\tau$$: Temperature parameter, ì¦ë¥˜í•  ì§€ì‹ëŸ‰ ê²°ì •  

### KL Loss
![image](https://user-images.githubusercontent.com/39285147/218954379-f99fb037-23c1-43ab-bb84-0d1cea5aafb1.png)

**Soft** Student predictions ~ **soft** Teacher labels ì‚¬ì´ì˜ ì˜ˆì¸¡ ê°„ê·¹ ì¢íˆê¸° ìœ„í•¨.

****
# Definition âœ
                `Given` a pre-trained model as Teacher
                `Find` the parameters of Student
                `Such that` the parameters maximize the accuracy of Student

****
# Proposed Method ğŸ§¿
## TAKD
![image](https://user-images.githubusercontent.com/39285147/218954794-ab46c33e-d314-448e-ad5d-61b6beb7fb3a.png)

- Student ì„±ëŠ¥ì€ Teacher í¬ê¸°ì— ë”°ë¼ ë³€í•œë‹¤
- KD íš¨ê³¼ëŠ” Student í¬ê¸°ì— ë”°ë¼ ë³€í•œë‹¤.

## Best TA Size
![image](https://user-images.githubusercontent.com/39285147/218955761-a7cd5a33-75e5-421b-a236-fc8886afb25f.png)

![image](https://user-images.githubusercontent.com/39285147/218955902-4767f8c2-e33e-45c6-919d-57f56fe22666.png)

## Theoretical Analysis
![image](https://user-images.githubusercontent.com/39285147/218956915-13a798f9-2ec0-49f5-892e-c668c2314c43.png)

![image](https://user-images.githubusercontent.com/39285147/218957010-204c4ca3-3e4a-44cb-b7f0-1187fd164450.png)

![image](https://user-images.githubusercontent.com/39285147/218957071-e9fbd9ab-c56a-48c7-9264-14838b9015a6.png)

TAKDëŠ” íƒ€ KD ë°©ë²•ë“¤ì— ë¹„í•´ Local minima ì§€ì ì—ì„œ ë” ë‚©ì‘í•œ í‘œë©´ì„ í˜•ì„±í•œë‹¤ (= ë” ì˜ ìˆ˜ë ´í•œë‹¤ = í•™ìŠµ ì™„ë£Œê°€ ë” ì˜ëœë‹¤).

****
# Experiment ğŸ‘€
![image](https://user-images.githubusercontent.com/39285147/218955621-c4901e88-7e0d-4659-bfc0-d29c25eee5be.png)

![image](https://user-images.githubusercontent.com/39285147/218955694-13b68973-156a-4185-a1b0-17e71d063ef4.png)

![image](https://user-images.githubusercontent.com/39285147/218956041-e9ce64d0-3c4b-4ff3-a96e-a4e307ea3bd6.png)


****
# Conclusion âœ¨
## Strength
- Student ~ Teacher ì‚¬ì´ ê°„ê·¹ ì¤„ì—¬ì„œ ë” ë†’ì€ ì •í™•ë„ ëŒì–´ëƒ„
- TAKDëŠ” íƒ€ KD ë°©ë²•ë“¤ì— ë¹„í•´ ë†’ì€ ì„±ëŠ¥

****
# Reference ğŸ’•