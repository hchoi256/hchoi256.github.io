---
layout: single
title: "DBMS: Relational Algebra"
categories: DB
tag: [Database, Relational Algebra]
toc: true
toc_sticky: true
toc_label: "쭌스log"
#author_profile: false
header:
    teaser: /assets/images/posts/db.png
sidebar:
    nav: "docs"
---

# INTRO 🙌
저번 시간에는 Relational Algebra Operations 에 대하여 알아보았다.

이번 시간에는 상기 과정이 **Relational Algebra**가 무엇인지 알아보자.

****
# RA
- 다섯 개의 기본 연산자; 기본 연산자로부터 파생물 多
- 쿼리 생성을 위해 연산자 조합
    - **RA expressions**, 주로 트리 형태

## Complex Expressions (복잡한 표현식)
- RA는 대수학과 비슷하게 동작
    - 가령 $(x + 4)*(y - 3)$
- 3가지 notations (just as in arithmetic):
    - 1. Sequences of assignment statements
    - 2. Expressions with several operators
    - 3. Expression trees

### 1) Sequences of Assignment
$R3\ :=\ R1\ JOINC\ R2$

$R4\ :=\ R1 * R2$

$R3\ :=\ SELECTC\ (R4)$

- 임시 relation 이름 생성
- Renaming can be implied by giving relations a list of attributes

### 2) Expressions with Several Operators
$theta-join\ R3\ :=\ R1\ JOINC\ R2$

$R3\ :=\ SELECTC\ (R1 * R2)$

- 관계 연산자(relational operators) 우선 순위:
    1. Unary operators (i.e., select, project, rename)
    2. Products and joins
    3. Intersection
    4. Union and set difference

> 괄호() 사용하여 항상 우선 순위를 변경 가능

### 3) Expression Trees
- 가지(Leaves) = operands
    - 관계 변수 (variables standing for relations)
    - 특정 관계 (particular, constant relations)
- Interior nodes = operators
    - applied to their child or children.

### 응용
***"Maple St." 이름을 가졌거나 "Bud" 가격이 \$3 보다 작은 모든 bars 이름 가져오기***

$Bars(name, addr)$

$Sells(bar, beer, price)$ 

![image](https://user-images.githubusercontent.com/39285147/201670239-1c4b8c51-a671-4591-88c0-899c992773b4.png)

***서로 다른 두 개의 맥주를 같은 가격에 파는 bars 가져오기***

$Sells(bar, beer, price)$ 

![image](https://user-images.githubusercontent.com/39285147/201671137-ebac22e8-8d70-443c-89e7-0e8a6bfa7b6b.png)

**Renaming**을 통해 Sells의 복사본 $S(bar, beer1, price)$을 정의하는 모습이다.

이후, *Sells*과 *S*을 **Natural Join**으로 묶어, 주어진 조건을 만족하는 $quadruples(bar, beer, beer1, price)$를 생성한다.

## Complex Queries (복잡한 쿼리)
        Product ( pid, name,  price, category, maker-cid)
        Purchase (buyer-ssn,  seller-ssn,  store,  pid)
        Company (cid, name, stock price, country)
        Person(ssn, name, phone number, city)

- *Purchase*
    - buyer-ssn, seller-ssn: foreign keys in Person
    - pid: foreign key in Product; 
- *Product*
    - maker-cid: a foreign key in Company

하기 예시들을 통해 응용 이해를 도모하기를 바란다.

Ex #0: ***Find phone numbers of people who bought gizmos from Fred.***

> ![image](https://user-images.githubusercontent.com/39285147/201672020-92a15eec-b26c-46b3-8696-7d611790a9fe.png)

Ex #1: Find people who bought telephony products.

Ex #2: Find names of people who bought American products 

Ex #3: Find telephony products that somebody bought

Ex #4: Find names of people who bought American products and did not buy French products

Ex #5: Find names of people who bought American products and they live in Champaign.
 
Ex #6: Find people who bought stuff from Joe or bought products from a company whose stock prices is more than $50.

## Operations on Bags
- **Union**: $\{a,b,b,c\}\ U\ \{a,b,b,b,e,f,f\}\ =\ \{a,a,b,b,b,b,b,c,e,f,f\}$
    - add the number of occurrences
- **Difference**: $\{a,b,b,b,c,c\}\ –\ \{b,c,c,c,d\}\ =\ \{a,b,b,d\}$
    - subtract the number of occurrences
- **Intersection**: $\{a,b,b,b,c,c\}\ \cap\ \{b,b,c,c,c,c,d\}\ =\ \{b,b,c,c\}$
    - minimum of the two numbers of occurrences
- **Selection**: 특정 요소 선택; preserve the number of occurrences (중복 제거)
- **Projection**: 특정 요소 선택; preserve the number of occurrences (중복 포함)
- **Cartesian product, join**: 중복 제거; no duplicate elimination


****
# Reference 
[Database Management Systems by Raghu Ramakrishnan and Johannes Gehrke](https://pages.cs.wisc.edu/~dbbook/)

[Relational Operators](https://www.javatpoint.com/dbms-relational-algebra)