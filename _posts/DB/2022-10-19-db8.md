---
layout: single
title: "DBMS: Basic RA Operations"
categories: DB
tag: [Database, Basic RA Operations]
toc: true
toc_sticky: true
toc_label: "ì­ŒìŠ¤log"
#author_profile: false
header:
    teaser: /assets/images/posts/db.png
sidebar:
    nav: "docs"
---

# INTRO ğŸ™Œ
ì €ë²ˆ ì‹œê°„ì—ëŠ” File Organization and Indexingì— ëŒ€í•˜ì—¬ ì•Œì•„ë³´ì•˜ë‹¤.

ì´ë²ˆ ì‹œê°„ì—ëŠ” **Relational Algebra Operations**ì— ê°œë…ì— ëŒ€í•´ ì•Œì•„ë³´ì.

****
# ë°°ê²½ì§€ì‹ ğŸ—‚
![image](https://user-images.githubusercontent.com/39285147/196815244-61c24a3e-83a4-403d-bf83-1c82a0446acd.png)

**Relational Data Operation**
- ì›í•˜ëŠ” ë°ì´í„°ë¥¼ ì–»ê¸° ìœ„í•´ Relationì— í•„ìš”í•œ Queryë¥¼ ìˆ˜í–‰í•˜ëŠ” ê²ƒ

**Relational Algebra(ê´€ê³„ ëŒ€ìˆ˜)**
- ì ˆì°¨ì‹ ì–¸ì–´ë¡œ ì›í•˜ëŠ” ê²°ê³¼ë¥¼ ì–»ê¸° ìœ„í•´ ë°ì´í„° ì²˜ë¦¬ ê³¼ì •ì„ ìˆœì„œëŒ€ë¡œ ê¸°ìˆ í•œë‹¤.

**Relational Calculus(ê´€ê³„ í•´ì„)**
- ë¹„ì ˆì°¨ì‹ ì–¸ì–´ë¡œ ì›í•˜ëŠ” ê²°ê³¼ë¥¼ ì–»ê¸° ìœ„í•´ ì²˜ë¦¬ë¥¼ ì›í•˜ëŠ” ë°ì´í„°ê°€ ë¬´ì—‡ì¸ì§€ë§Œ ê¸°ìˆ 

****
# ì§ê´€ âœ”
        Employees(eid, ename, city, state)
        Departments(did, dname, mid)

        Select E.ename
        From Employees E, Departments D
        Where E.eid = D.mid and E.city = â€˜Madisonâ€™

ì–´ë–»ê²Œ ìƒê¸° ì¿¼ë¦¬ë¥¼ ì‹¤í•¼í•  ìˆ˜ ìˆë‚˜?
- ê°€ëŠ¥í•œ ê³„íš ìˆ˜ë¦½
- plan ë³„ runtime ì˜ˆì¸¡
- ê°€ì¥ ë¹ ë¥¸ plan ì„ íƒ & ì‹¤í–‰

ì—¬ê¸°ì„œ ìš°ë¦¬ëŠ” ì–´ë–»ê²Œ planì„ ì„ íƒí•´ì•¼ í•˜ëŠ”ì§€ì— ëŒ€í•œ ê¶ê¸ˆì¦ì´ í”¼ì–´ë‚  ê²ƒì´ë‹¤.

plan ì„ íƒì„ ìœ„í•´, ì•„ë˜ SQL ì»´íŒŒì¼ëŸ¬ì˜ ë‚´ë¶€ ë™ì‘ ê³¼ì •ì„ ì´í•´í•´ë³¼ í•„ìš”ê°€ ìˆë‹¤.

> *SQL Compiler*: compile ë‚´ë¶€ ë™ì¥ ê³¼ì •
> 1. compile ì‹¤í–‰ì‹œ, ì „ì²´ ì½”ë“œë¥¼ graph í˜•íƒœë¡œ ë³€í™˜
> 2. í•´ë‹¹ graphë¥¼ ìµœì í™”
> 3. ìµœì í™”ëœ graphë¥¼ execute

****
# RA Operations 5ê°€ì§€
## 1. Union
$$R1 U R2$$

- **ëª¨ë“  tuples in R1 or R2**
- R1, R2, (R1 U R2) ê°ê°ê³¼ ë™ì¼í•œ schemaë¥¼ ê³µìœ í•œë‹¤.
    - i.e., ActiveEmployees U RetiredEmployees

## 2. Set difference
$$R1 - R2$$

- **Tuples in R1, not in R2**
- R1, R2, (R1 - R2) ê°ê°ê³¼ ë™ì¼í•œ schemaë¥¼ ê³µìœ í•œë‹¤.
    - i.e., ActiveEmployees - RetiredEmployees

## 3. Selection
$$\sigma_\{c\}(R)$$

- **ì„ íƒí•  tuples íŠ¹ì • ì¡°ê±´ ë§Œì¡±**
- *c* = a condition (i.e., =, <, >, and, or, not)
- Output schema = input schema

![image](https://user-images.githubusercontent.com/39285147/199603100-6eda386d-913b-4f07-bec9-29a14cc4afaa.png)

ì—°ë´‰ $40,000 ì´ìƒì€ ëª¨ë“  ì§ì› ê²€ìƒ‰: $$\sigma_\{Salary > 40000\} (Employee)$$

![image](https://user-images.githubusercontent.com/39285147/199603194-7ea69a86-1388-4ec6-81e4-51f0c652d881.png)

## 4. Projection
$\prod_\{A1,â€¦,An\}(R)$

- *Unary operation*: **returns certain columns**
- Eliminates duplicate tuples
- Input schema $$R(B1,â€¦,Bm)$$
- Condition: $$\{A1, â€¦, An\} \subseteq \{B1, â€¦, Bm\}$$
- Output schema $$S(A1,â€¦,An)$$

Project social-security number and names:

![image](https://user-images.githubusercontent.com/39285147/199603607-0a078003-cc6f-4a55-8e76-12d0c3fb7446.png)

![image](https://user-images.githubusercontent.com/39285147/199604224-6805a6c4-1eaa-4b96-9fac-2d759b1aba9c.png)

## 5. Cartesian product   
$$R1 X R2$$

- **Each tuple in R1 with each tuple in R2**
    - $$A=\{a,b\},\ B=\{1,2\}, AXB=\{a1,a2,b1,b2\}$$
- Input schemas: $R1(A1,â€¦,An), R2(B1,â€¦,Bm)$
- Condition: $\{A1,â€¦,An\} \cap \{B1,â€¦Bm\} = \emptyset$
- Output schema: $S(A1, â€¦, An, B1, â€¦, Bm)$
- Very rare in practice; but joins are very common

[*Employee x Dependents*]

![image](https://user-images.githubusercontent.com/39285147/199604408-450796bd-5b8f-4efe-aaa1-c6909193015e.png)

### í•œê³„ì 
![image](https://user-images.githubusercontent.com/39285147/199604768-07c2e2c5-85b1-4224-b1e9-b76e9909838f.png)

ìƒê¸° ì´ë¯¸ì§€ëŠ” ì„œë¡œ ë‹¤ë¥¸ ë‘ ê·¸ë£¹ì´ ë™ì¼í•œ columnë¥¼ í¬í•¨í•˜ëŠ” ê²½ìš°ì´ë‹¤.

í•´ë‹¹ ê²½ìš°, ë™ì¼í•œ columnì— ëŒ€í•´ collisionì´ ë°œìƒí•œë‹¤.

ë”°ë¼ì„œ, ê° colì— ëŒ€í•´ ì•Œë§ê²Œ ì´ë¦„ ë³€ê²½ í•„ìš”í•œë°, ì´ëŸ¬í•œ í•œê³„ì  í•´ê²°í•˜ê³ ì [Renaming](#renaming)ì´ ë„ì…ë˜ì—ˆë‹¤ (í•˜ê¸° ì°¸ì¡°).

### Renaming
$$\rho_\{B1,â€¦,Bn\}(R)$$

- relational instance ë³€ê²½ X
- relational schema ë³€ê²½ O
- Input schema: $R(A1, â€¦, An)$
- Output schema: $S(B1, â€¦, Bn)$

![image](https://user-images.githubusercontent.com/39285147/199605072-8badda3a-bb94-4b27-9f61-3a973df7a986.png)

![image](https://user-images.githubusercontent.com/39285147/199605216-0e550f1a-a03d-465b-bb93-40b150df5db1.png)

## ì‹œí—˜ ì¶œì œ â˜…â˜…â˜…
1. 6ê°€ì§€ operator ê¸°ë§ê³ ì‚¬ ë¬´ì¡°ê±´ ì¶œì œâ˜…â˜…

2. í•˜ê¸° í˜•íƒœ ì´í•´í•  ìˆ˜ ìˆì–´ì•¼ ë¨

$$\prod\sigma_\{A1,â€¦,An\}(Employee)$$

****
# Derived RA Operations ğŸ„
## 1. Intersection
$$R1 \cap R2$$
$$ R1 \cap R2  =  R1 â€“ (R1 â€“ R2)$$

- **Difference: all tuples both in R1 and in R2**
- R1, R2, $R1 \cap R2$ must have the same schema

$UnionizedEmployees \cap RetiredEmployees$

## 2. Join (*Most importantly*)
### íŠ¹ì§•
- JOINì€ **ì„œë¡œ ë‹¤ë¥¸ 3ê°œ ì´ìƒì˜ í…Œì´ë¸”**ì´ ì¡´ì¬í•  ë•Œ, ê·¸ë“¤ì˜ ì—°ê´€ì„±ì„ ìœ ì§€í•˜ë©´ì„œ selectioní•  ë•Œ êµ‰ì¥íˆ íš¨ìœ¨ì ì´ë‹¤.
- Extremely costly
- Derived operator

### Theta join (= Condition join)
$R1 \infty_\{\theta\} R2, where\ \theta\ is\ a\ condition$

- **A join that involves a predicate**
- Input schemas: R1(A1,â€¦,An), R2(B1,â€¦,Bm)
- $\{A1,â€¦An\} \cap \{B1,â€¦,Bm\} = \emptyset$ 
- Output schema: S(A1,â€¦,An,B1,â€¦,Bm)

[*Derived operator*]

$R1 \infty_\{\theta\} R2 = \sigma_\{\theta\}(R1 * R2)$

![image](https://user-images.githubusercontent.com/39285147/199608852-2e390479-3fbc-4c65-9b6e-3adb0cd1c9dc.png)

### Natural join
$R1 \infty R2$

- **combine all pairs of tuples in R1 and R2 that agree on the attributes**
- ê°™ì€ ê°’ ì¡´ì¬ x (ëª¨ë‘ ë‹¤ join condition ì˜í•´ í•©ì³ì§)

$\{A1,â€¦,An\} \cap \{B1,â€¦, Bm\}   (called\ the\ join\ attributes)$

- Input Schema: $$R1(A1, â€¦, An), R2(B1, â€¦, Bm)$$
- Output Schema: $$S(C1,â€¦,Cp), where \{C1, â€¦, Cp\} = \{A1, â€¦, An\} \cup \{B1, â€¦, Bm\}$$
Equivalent to a cross product followed by selection

$Employee\ \infty\ Dependents$

#### ì‹œí—˜ ì¶œì œ â˜…â˜…â˜…â˜…â˜…â˜…
![image](https://user-images.githubusercontent.com/39285147/199609455-b1f61210-b459-4891-aa56-c64ab9e6c4be.png)

ì‹œí—˜ì—ì„œ ì´ëŸ° ì‹ìœ¼ë¡œ expression ì ê²Œ ë ê±°ì„!!! â˜…â˜…â˜…â˜…â˜…â˜…

> Midtermì—ì„œëŠ” SQL ì§ì ‘ ì ì—ˆëŠ”ë° FINAL ì—ì„œëŠ” ìœ„ í‘œí˜„ì‹ìœ¼ë¡œ ë¬¼ì–´ë³´ëŠ” ë¬¸ì œ ë‚˜ì˜´

![image](https://user-images.githubusercontent.com/39285147/199610083-8e1cf1d5-9826-4cc8-b6b6-2c94d35f2f83.png)

#### ì‹¤ìŠµ
- Given the schemas R(A, B, C, D), S(A, C, E), what is the schema of R âˆ S?
- Given R(A, B, C),  S(D, E), what is R âˆ S?
- Given R(A, B),  S(A, B),  what is  R âˆ S?

![image](https://user-images.githubusercontent.com/39285147/199609583-4d865dc0-e4de-4301-9da4-3d71f545b8ce.png)

### Equi-join
![image](https://user-images.githubusercontent.com/39285147/205431539-82fdc801-d591-4fc8-9572-5a3a60e05923.png)

$$R1\ \infty_\{A=B\}R2$$

- Natural join = equi-joinì˜ í•œ ì¢…ë¥˜
    - Natural Joinì€ index column ì¤‘ë³µ ì œê±°
- A lot of research on how to do it efficiently

### ê¸°íƒ€
- Semi-join
- Inner join
- Outer join
- etc.

> í•´ë‹¹ courseì—ì„œëŠ” ì•ˆ ë‹¤ë£¸. ë‚˜ì¤‘ì— ë°°ì›Œë„ ë¨!

ë‹¤ìŒ ì‹œê°„ì—ëŠ” [Relational Algebra](https://hchoi256.github.io/db/db9/)ì— ëŒ€í•´ ì•Œì•„ë³´ì.

****
# Reference 
[Database Management Systems by Raghu Ramakrishnan and Johannes Gehrke](https://pages.cs.wisc.edu/~dbbook/)

[Relational Operators](https://www.javatpoint.com/dbms-relational-algebra)