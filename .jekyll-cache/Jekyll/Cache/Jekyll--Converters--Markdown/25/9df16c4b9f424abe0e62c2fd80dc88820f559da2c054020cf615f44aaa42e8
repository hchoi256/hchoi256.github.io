I"ê<p>Hierarchical Agglomerate Clustering(HAC) ì´ìš©í•´ì„œ ì„œë¡œ ë‹¤ë¥¸ íŠ¹ì„±ì„ ê³µìœ í•˜ëŠ” Pokemonë“¤ì„ êµ°ì§‘ìœ¼ë¡œ ë¬¶ì–´ë³´ì.</p>

<p>â€˜Pokemon.csvâ€™ëŠ” ì˜¨ë¼ì¸ì—ì„œ ì†ì‰½ê²Œ êµ¬í•  ìˆ˜ ìˆë‹¤.</p>

<p>ì´ í”„ë¡œì íŠ¸ëŠ” <strong>êµ°ì§‘í™”(Clustering)</strong>ì˜ ê°œë…ì„ ìˆ™ì§€í•˜ê³  ìˆë‹¤ëŠ” ì „ì œë¡œ ìˆ˜í–‰í•œë‹¤.</p>

<h1 id="code">Code</h1>
<p class="notice--danger"><strong>[Notice]</strong> <a href="https://github.com/hchoi256/cs540-AI/tree/main/hierarchical-clustering-pokemon">download here</a></p>

<h1 id="ë°ì´í„°ì…‹-ê´€ì°°">ë°ì´í„°ì…‹ ê´€ì°°</h1>

<p><img src="https://user-images.githubusercontent.com/39285147/184554603-837ebc40-75b2-4c96-b87e-385eec2b63bd.png" alt="image" /></p>

<ul>
  <li>Columns: <em>Attack, Sp. Atk, Speed, Defense, Sp. Def, and HP</em></li>
</ul>

<h1 id="ë¼ì´ë¸ŒëŸ¬ë¦¬-ë¶ˆëŸ¬ì˜¤ê¸°">ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¶ˆëŸ¬ì˜¤ê¸°</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">dendrogram</span><span class="p">,</span> <span class="n">linkage</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy.linalg</span> <span class="k">as</span> <span class="n">LA</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</code></pre></div></div>

<h1 id="ë°ì´í„°-ë¶ˆëŸ¬ì˜¤ê¸°">ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
    <span class="n">pokemons</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">"utf-8"</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="p">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">csvfile</span><span class="p">)</span> <span class="c1"># ì‚¬ì „ í˜•íƒœë¡œ csv ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¨ë‹¤
</span>        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
            <span class="n">dic</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="n">dic</span><span class="p">[</span><span class="s">"#"</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s">'#'</span><span class="p">]</span>
            <span class="n">dic</span><span class="p">[</span><span class="s">"Name"</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s">'Name'</span><span class="p">]</span>
            <span class="n">dic</span><span class="p">[</span><span class="s">"Type 1"</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s">'Type 1'</span><span class="p">]</span>
            <span class="n">dic</span><span class="p">[</span><span class="s">"Type 2"</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s">'Type 2'</span><span class="p">]</span>
            <span class="n">dic</span><span class="p">[</span><span class="s">"Total"</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s">'Total'</span><span class="p">]</span>
            <span class="n">dic</span><span class="p">[</span><span class="s">"HP"</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s">'HP'</span><span class="p">]</span>
            <span class="n">dic</span><span class="p">[</span><span class="s">"Attack"</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s">'Attack'</span><span class="p">]</span>
            <span class="n">dic</span><span class="p">[</span><span class="s">"Defense"</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s">'Defense'</span><span class="p">]</span>
            <span class="n">dic</span><span class="p">[</span><span class="s">"Sp. Atk"</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s">'Sp. Atk'</span><span class="p">]</span>
            <span class="n">dic</span><span class="p">[</span><span class="s">"Sp. Def"</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s">'Sp. Def'</span><span class="p">]</span>
            <span class="n">dic</span><span class="p">[</span><span class="s">"Speed"</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s">'Speed'</span><span class="p">]</span>
            <span class="n">dic</span><span class="p">[</span><span class="s">"Generation"</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s">'Generation'</span><span class="p">]</span>
            <span class="n">dic</span><span class="p">[</span><span class="s">"Legendary"</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s">'Legendary'</span><span class="p">]</span>
            <span class="n">pokemons</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pokemons</span> <span class="c1"># ë¦¬ìŠ¤íŠ¸ í˜•íƒœë¡œ ë°˜í™˜
</span></code></pre></div></div>

<h1 id="ë°ì´í„°-ì „ì²˜ë¦¬">ë°ì´í„° ì „ì²˜ë¦¬</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">calc_features</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>    
    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s">"Attack"</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s">"Sp. Atk"</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s">"Speed"</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s">"Defense"</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s">"Sp. Def"</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s">"HP"</span><span class="p">])],</span> <span class="n">dtype</span><span class="o">=</span><span class="s">'int64'</span><span class="p">)</span>
</code></pre></div></div>

<p>í¬ì¼“ëª¬ ë°ì´í„°ì…‹ì—ëŠ” ë²”ì£¼í˜• ë°ì´í„°ê°€ ì¡´ì¬í•œë‹¤.</p>

<p>ë”°ë¼ì„œ, ìˆ˜ì¹˜í˜•ê³¼ ë²”ì£¼í˜• ë°ì´í„° typeì„ ì§€ì •í•˜ê³ , ì†ì‰¬ìš´ ì—°ì‚°ì„ ìœ„í•´ ìµœì¢… ì¶œë ¥ì„ numpy ë°°ì—´ì˜ í˜•íƒœë¡œ ë°˜í™˜í•˜ì.</p>

<h1 id="ê±°ë¦¬-ê³„ì‚°-í•¨ìˆ˜">ê±°ë¦¬ ê³„ì‚° í•¨ìˆ˜</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">get_min_distance</span><span class="p">(</span><span class="nb">min</span><span class="p">,</span> <span class="n">tmp</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">min</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
        <span class="k">if</span> <span class="nb">min</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
            <span class="c1"># equal first index ith
</span>            <span class="k">if</span> <span class="nb">min</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="k">if</span> <span class="nb">min</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="c1"># equal second index jth
</span>                    <span class="k">if</span> <span class="nb">min</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="c1"># share same pokemon stat
</span>                        <span class="nb">min</span> <span class="o">=</span> <span class="n">tmp</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">min</span> <span class="o">=</span> <span class="n">tmp</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">min</span> <span class="o">=</span> <span class="n">tmp</span>
    <span class="k">return</span> <span class="nb">min</span>
</code></pre></div></div>

<p>ìœ í´ë¦¬ë“œ ê±°ë¦¬ë¥¼ ì‚¬ìš©í•´ì„œ â€˜<strong>Complete-linkage(ì™„ì „ ì—°ê²°)</strong>â€™ ê¸°ë²•ìœ¼ë¡œ êµ°ì§‘ê°„ ê±°ë¦¬ë¥¼ ê³„ì‚°í•œë‹¤.</p>

<p>Complete-linkage(ì™„ì „ ì—°ê²°) ì´ì™¸ì—ë„ Average linkage ë“± ì—¬ëŸ¬ ë°©ë²•ìœ¼ë¡œ êµ°ì§‘ê°„ ê±°ë¦¬ë¥¼ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤.</p>

<blockquote>
  <p>ë³´ë‹¤ ìì„¸í•œ ë‚´ìš©ì€ <a href="https://github.com/hchoi256/ai-terms/blob/main/README.md">ì—¬ê¸°</a>ë¥¼ ì°¸ì¡°í•˜ì.</p>
</blockquote>

<h1 id="êµ°ì§‘-í•©ì¹˜ê¸°merge">êµ°ì§‘ í•©ì¹˜ê¸°(Merge)</h1>

<p>HACëŠ” êµ°ì§‘ë“¤ì„ í•©ì³ê°€ë©´ì„œ ê³„ì¸µì  êµ°ì§‘í™”ë¥¼ ì§„í–‰í•œë‹¤.</p>

<p>í•˜ê¸° ì½”ë“œëŠ” êµ°ì§‘ì„ í•©ì¹˜ê¸° ìœ„í•œ í•¨ìˆ˜ì´ë‹¤.</p>

<p>ë³´ë‹¤ ìì„¸í•œ ì´í•´ëŠ” ê° ì½”ë“œ ì˜† ì£¼ì„ì„ ì°¸ê³ í•˜ì.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">merge_distance</span><span class="p">(</span><span class="n">cluster_dict</span><span class="p">):</span>
    <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cluster_dict</span><span class="p">)</span>
    <span class="nb">min</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">inf</span><span class="p">]</span>  <span class="c1"># default to inf for replacement
</span>    <span class="c1"># iterate through cluster list (i.e., [1 2 3] --&gt; (1, 2), (1, 3), (2, 3))
</span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">cluster_dict</span><span class="p">[</span><span class="n">i</span><span class="p">])).</span><span class="n">find</span><span class="p">(</span><span class="s">'int'</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">continue</span>    <span class="c1"># already clustered
</span>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">length</span> <span class="o">-</span> <span class="n">i</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">cluster_dict</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">])).</span><span class="n">find</span><span class="p">(</span><span class="s">'int'</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">continue</span>    <span class="c1"># already clusterd
</span>            <span class="n">tfst</span> <span class="o">=</span> <span class="s">'tuple'</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">cluster_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">tsnd</span> <span class="o">=</span> <span class="s">'tuple'</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">cluster_dict</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]))</span>
            <span class="c1"># check if multiple pokemons in cluster or not
</span>            <span class="k">if</span> <span class="n">tfst</span> <span class="ow">and</span> <span class="n">tsnd</span><span class="p">:</span>
                <span class="c1"># multiple pokemons in both
</span>                <span class="n">distances</span> <span class="o">=</span> <span class="n">max_dist</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">cluster_list1</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cluster_dict</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">cluster_list2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cluster_dict</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">])</span>
                <span class="c1"># complete-linkage
</span>                <span class="k">for</span> <span class="n">c1</span> <span class="ow">in</span> <span class="n">cluster_list1</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">c2</span> <span class="ow">in</span> <span class="n">cluster_list2</span><span class="p">:</span>
                        <span class="n">tmp</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="n">LA</span><span class="p">.</span><span class="n">norm</span><span class="p">(</span><span class="n">c1</span> <span class="o">-</span> <span class="n">c2</span><span class="p">)]</span>
                        <span class="n">distances</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
                        <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">distances</span><span class="p">).</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># get distances only
</span>                        <span class="c1"># get index of max distance
</span>                        <span class="n">max_idx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span> <span class="c1"># complete-linkage
</span>                        <span class="n">max_dist</span> <span class="o">=</span> <span class="n">distances</span><span class="p">[</span><span class="n">max_idx</span><span class="p">]</span>
                <span class="nb">min</span> <span class="o">=</span> <span class="n">get_min_distance</span><span class="p">(</span><span class="nb">min</span><span class="p">,</span> <span class="n">max_dist</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">tfst</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">tsnd</span><span class="p">:</span>
                <span class="c1"># multiple pokemons in first cluster
</span>                <span class="n">distances</span> <span class="o">=</span> <span class="n">max_dist</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">cluster_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cluster_dict</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="c1"># complete-linkage
</span>                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cluster_list</span><span class="p">:</span>
                    <span class="n">tmp</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="n">LA</span><span class="p">.</span><span class="n">norm</span><span class="p">(</span><span class="n">c</span> <span class="o">-</span> <span class="n">cluster_dict</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">])]</span>
                    <span class="n">distances</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
                    <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">distances</span><span class="p">).</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># get distances only
</span>                    <span class="n">max_idx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>       <span class="c1"># get index of max distance
</span>                    <span class="n">max_dist</span> <span class="o">=</span> <span class="n">distances</span><span class="p">[</span><span class="n">max_idx</span><span class="p">]</span>
                <span class="nb">min</span> <span class="o">=</span> <span class="n">get_min_distance</span><span class="p">(</span><span class="nb">min</span><span class="p">,</span> <span class="n">max_dist</span><span class="p">)</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">tfst</span> <span class="ow">and</span> <span class="n">tsnd</span><span class="p">:</span>
                <span class="c1"># multiple pokemons in second cluster
</span>                <span class="n">distances</span> <span class="o">=</span> <span class="n">max_dist</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">cluster_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cluster_dict</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">])</span>
                <span class="c1"># complete-linkage
</span>                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cluster_list</span><span class="p">:</span>
                    <span class="n">tmp</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="n">LA</span><span class="p">.</span><span class="n">norm</span><span class="p">(</span><span class="n">cluster_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">c</span><span class="p">)]</span>
                    <span class="n">distances</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
                    <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">distances</span><span class="p">).</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># get distances only
</span>                    <span class="n">max_idx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>       <span class="c1"># get index of max distance
</span>                    <span class="n">max_dist</span> <span class="o">=</span> <span class="n">distances</span><span class="p">[</span><span class="n">max_idx</span><span class="p">]</span>
                <span class="nb">min</span> <span class="o">=</span> <span class="n">get_min_distance</span><span class="p">(</span><span class="nb">min</span><span class="p">,</span> <span class="n">max_dist</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># single pokemon in both
</span>                <span class="n">tmp</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="n">LA</span><span class="p">.</span><span class="n">norm</span><span class="p">(</span><span class="n">cluster_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">cluster_dict</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">])]</span>
                <span class="nb">min</span> <span class="o">=</span> <span class="n">get_min_distance</span><span class="p">(</span><span class="nb">min</span><span class="p">,</span> <span class="n">tmp</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">min</span>
</code></pre></div></div>

<p>ìƒê¸° ì½”ë“œëŠ” ì¡´ì¬í•˜ëŠ” êµ°ì§‘ ë¦¬ìŠ¤íŠ¸ ì¤‘ì—ì„œ ê°€ì¥ ê°€ê¹Œìš´ ê±°ë¦¬ì˜ êµ°ì§‘ ë‘ ê°œë¥¼ ì°¾ëŠ”ë‹¤.</p>

<p>ì—¬ê¸°ì„œ êµ°ì§‘ ê°„ ê±°ë¦¬ëŠ” â€˜complete-linkageâ€™ ë°©ë²•ì— ê·¼ê±°í•œë‹¤.</p>

<p>ì´ëŸ¬í•œ ë§¥ë½ì—ì„œ, ì£¼ëª©í•  ì ì€ â€˜<strong>max_idx = np.argmax(dist)</strong>â€™ ì—¬ê¸°ì´ë‹¤.</p>

<p>ìš°ë¦¬ëŠ” ì™„ì „ ì—°ê²° ë°©ë²•ì— ê¸°ë°˜í•´ì„œ êµ°ì§‘ ê°„ ê±°ë¦¬ë¥¼ êµ¬í•˜ê³  ì„œë¡œ ê°€ì¥ ê°€ê¹Œì´ ìœ„ì¹˜í•œ êµ°ì§‘ë“¤ì„ í•˜ë‚˜ì˜ êµ°ì§‘ìœ¼ë¡œ í†µí•©í•œë‹¤.</p>

<p>ì™„ì „ ì—°ê²°ì€ ì„œë¡œ ë‹¤ë¥¸ êµ°ì§‘ì— í¬í•¨ëœ ë°ì´í„°ë“¤ì˜ ê±°ë¦¬ê°€ ê°€ì¥ ë¨¼ ê°’ì„ êµ°ì§‘ì˜ ê±°ë¦¬ë¡œ ì±„íƒí•œë‹¤.</p>

<p>ì´ë¥¼ ìœ„í•´, â€˜np.argmaxâ€™ë¥¼ ì‚¬ìš©í•´ì„œ êµ°ì§‘ ê°„ ê±°ë¦¬ë¥¼ ë„ì¶œí•˜ê³ , â€˜get_min_distance(min, max_dist)â€™ë¥¼ í†µí•´ì„œ ê°€ì¥ ê°€ê¹Œìš´ ê±°ë¦¬ì— ìœ„ì¹˜í•œ êµ°ì§‘ì„ ì°¾ì•„ í•´ë‹¹ êµ°ì§‘ê³¼ í•˜ë‚˜ë¡œ í•©ì³ì§„ë‹¤.</p>

<p>ì´ ì™¸ ì½”ë“œëŠ” ì²œì²œíˆ ì½ì–´ë³´ë©´ ì¶©ë¶„íˆ ì´í•´ ê°€ëŠ¥í•œ ë¶€ë¶„ë“¤ì´ë‹¤.</p>

<h1 id="hac">HAC</h1>

<p>ì´ì œ HAC ê³„ì‚°ì— í•„ìš”í•œ ëª¨ë“  í•¨ìˆ˜ë“¤ì„ ë§Œë“¤ì—ˆìœ¼ë‹ˆ, HACë¥¼ êµ¬ì¶•í•´ë³´ì!</p>

<p>ì´ ë‹¨ê³„ì—ì„œëŠ” ê°€ì¥ ê°€ê¹Œìš´ ê±°ë¦¬ì˜ êµ°ì§‘ ë‘ ê°œë¥¼ ì°¾ì•„ì„œ í•˜ë‚˜ì˜ êµ°ì§‘ìœ¼ë¡œ í†µí•©í•˜ëŠ” ê³¼ì •ì´ ì§„í•¸ëœë‹¤.</p>

<p>ê° ì½”ë“œ ì˜†ì— ì£¼ì„ì„ ë‹¬ì•˜ìœ¼ë‹ˆ ì°¸ì¡°í•˜ë©° ì½ì–´ë³´ì.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">hac</span><span class="p">(</span><span class="n">features</span><span class="p">):</span>
    <span class="n">flen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
    <span class="c1"># (n-1) x 4 array
</span>    <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">flen</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="c1"># track clusters
</span>    <span class="n">cluster_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">flen</span><span class="p">):</span>
        <span class="n">cluster_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="c1"># compute complete-linkage
</span>    <span class="n">count</span> <span class="o">=</span> <span class="n">flen</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">flen</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="c1"># get minimum distance indices
</span>        <span class="n">indices</span> <span class="o">=</span> <span class="n">merge_distance</span><span class="p">(</span><span class="n">cluster_dict</span><span class="p">)</span>
        <span class="c1"># clusters to be merged
</span>        <span class="n">c1</span> <span class="o">=</span> <span class="n">cluster_dict</span><span class="p">[</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">c2</span> <span class="o">=</span> <span class="n">cluster_dict</span><span class="p">[</span><span class="n">indices</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
        <span class="c1"># check if multiple pokemons in cluster or not
</span>        <span class="c1"># if tuple, then multiple pokemons, otherwise single pokemon
</span>        <span class="n">tfst</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">c1</span><span class="p">)).</span><span class="n">find</span><span class="p">(</span><span class="s">'tuple'</span><span class="p">)</span>
        <span class="n">tsnd</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">c2</span><span class="p">)).</span><span class="n">find</span><span class="p">(</span><span class="s">'tuple'</span><span class="p">)</span>
        <span class="n">l1</span> <span class="o">=</span> <span class="n">l2</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">tfst</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">tsnd</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="c1"># single pokemon
</span>            <span class="n">l1</span> <span class="o">=</span> <span class="p">[</span><span class="n">c1</span><span class="p">]</span>
            <span class="n">l2</span> <span class="o">=</span> <span class="p">[</span><span class="n">c2</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># multiple pokemons
</span>            <span class="k">if</span> <span class="n">tfst</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">l1</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">l1</span> <span class="o">=</span> <span class="p">[</span><span class="n">c1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">tsnd</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">l2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">c2</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">l2</span> <span class="o">=</span> <span class="p">[</span><span class="n">c2</span><span class="p">]</span>
        <span class="c1"># merge clusters
</span>        <span class="n">ncluster</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">fst_idx</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">snd_idx</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># update output
</span>        <span class="n">res</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">fst_idx</span>         <span class="c1"># index of first cluster
</span>        <span class="n">res</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">snd_idx</span>         <span class="c1"># index of seoncd cluster
</span>        <span class="n">res</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>      <span class="c1"># distance
</span>        <span class="n">res</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ncluster</span><span class="p">)</span>   <span class="c1"># num of elements in cluster
</span>        <span class="c1"># add into cluster list
</span>        <span class="n">cluster_dict</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="n">ncluster</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1"># remove from cluster list
</span>        <span class="n">cluster_dict</span><span class="p">[</span><span class="n">fst_idx</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">cluster_dict</span><span class="p">[</span><span class="n">snd_idx</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    
    <span class="k">return</span> <span class="n">res</span>
</code></pre></div></div>

<h1 id="ê²°ê³¼-í™•ì¸">ê²°ê³¼ í™•ì¸</h1>

<p>HACë¥¼ ì‹œê°í™” í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ â€˜<strong><em>dendrogram</em></strong>â€˜ì´ë¼ëŠ” í•¨ìˆ˜ë¥¼ ìì£¼ ì‚¬ìš©í•œë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">imshow_hac</span><span class="p">(</span><span class="n">Z</span><span class="p">):</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">dn</span> <span class="o">=</span> <span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">21</span><span class="p">):</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">hac</span><span class="p">([</span><span class="n">calc_features</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span> <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">load_data</span><span class="p">(</span><span class="s">'Pokemon.csv'</span><span class="p">)][:</span><span class="n">n</span><span class="p">])</span>
    <span class="n">imshow_hac</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
</code></pre></div></div>

<p>êµ°ì§‘ ëª‡ ê°œë¥¼ í•©ì¹  ê²ƒì¸ì§€ ê·¸ ìˆ«ìë¥¼ ì¸í’‹ìœ¼ë¡œ ë¶€ì—¬í•œë‹¤.</p>

<p><em>[êµ°ì§‘ 2ê°œ]</em></p>

<p><img src="https://user-images.githubusercontent.com/39285147/184555068-caa7859d-9651-41c8-b3fe-41b6032fcce5.png" alt="image" /></p>

<p><em>[êµ°ì§‘ 3ê°œ]</em></p>

<p><img src="https://user-images.githubusercontent.com/39285147/184555089-1434d5be-0e8f-442f-b981-fdf65a12379f.png" alt="image" /></p>

<p><em>[êµ°ì§‘ 4ê°œ]</em></p>

<p><img src="https://user-images.githubusercontent.com/39285147/184555094-fe695724-17ee-47df-9ea8-070ea24c774b.png" alt="image" /></p>

<p>â€¦</p>

<p><img src="https://user-images.githubusercontent.com/39285147/184555117-ebd0bf14-f711-473b-b0ec-275833e32ad3.png" alt="image" /></p>
:ET