I"±:<h1 id="part-1-sttspeech-to-text">PART 1: STT(Speech to Text)</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">SpeechRecognition</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">PyAudio</span>

<span class="kn">import</span> <span class="nn">speech_recognition</span> <span class="k">as</span> <span class="n">sr</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">transform</span><span class="p">():</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">sr</span><span class="p">.</span><span class="n">Recognizer</span><span class="p">()</span>

    <span class="k">with</span> <span class="n">sr</span><span class="p">.</span><span class="n">Microphone</span><span class="p">()</span> <span class="k">as</span> <span class="n">source</span><span class="p">:</span>
        <span class="n">r</span><span class="p">.</span><span class="n">pause_threshold</span> <span class="o">=</span> <span class="mf">0.8</span> <span class="c1"># 0.8ì´ˆ ë™ì•ˆ ì •ì ì´ë©´ ìë™ìœ¼ë¡œ ìŒì„± ë…¹ìŒì„ ì¢…ë£Œí•œë‹¤ terminate recording in 0.8 seconds of silence
</span>        <span class="n">said</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">listen</span><span class="p">(</span><span class="n">source</span><span class="p">)</span> <span class="c1"># ë…¹ìŒë³¸ 'said'ì— ì €ì¥í•˜ê¸° save the record into 'said'
</span>        <span class="k">try</span><span class="p">:</span>
            <span class="n">q</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">recognize_google</span><span class="p">(</span><span class="n">said</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s">"ko"</span><span class="p">)</span> <span class="c1"># google ì–¸ì–´íŒ© ì‚¬ìš© using google language package
</span>            <span class="k">return</span> <span class="n">q</span>
        <span class="k">except</span> <span class="n">sr</span><span class="p">.</span><span class="n">UnknownValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">"ë¬´ìŠ¨ ë§ì¸ì§€ ì´í•´ë¥¼ ì˜ ëª» í–ˆì–´ìš”"</span> <span class="c1"># "Cannot understnad your saying"
</span>        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">"ëŒ€ê¸°ì¤‘ì…ë‹ˆë‹¤."</span> <span class="c1"># "Awaiting"
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">transform</span><span class="p">()</span> <span class="c1"># Start STT
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ë§ˆì´í¬ë¥¼ ì¼œê³ , ìŒì„±ì„ ë…¹ìŒí•˜ë©´ ë©”ì‹œì§€ë¡œ ì¶œë ¥ë˜ëŠ” ê²ƒì„ ë³´ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. Turn on your microphone, then check if the program creates your record 
</code></pre></div></div>

<h1 id="part-2-ttstext-to-speech">PART 2: TTS(Text to Speech)</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">pyttsx3</span> <span class="c1"># TTS í´ë˜ìŠ¤
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pyttsx3</span>

<span class="k">def</span> <span class="nf">speaking</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>
    <span class="n">engine</span> <span class="o">=</span> <span class="n">pyttsx3</span><span class="p">.</span><span class="n">init</span><span class="p">()</span> <span class="c1"># Run TTS engine
</span>    <span class="n">engine</span><span class="p">.</span><span class="n">say</span><span class="p">(</span><span class="n">message</span><span class="p">)</span> <span class="c1"># ë©”ì‹œì§€ ë‚´ìš© ì—”ì§„ì— ì „ë‹¬ Transfer message to the engine
</span>    <span class="n">engine</span><span class="p">.</span><span class="n">runAndWait</span><span class="p">()</span> <span class="c1"># ë©”ì‹œì§€ ìŒì„±ì¶œë ¥ speak out the message
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">speaking</span><span class="p">(</span><span class="s">"ì´ì œ STTê°€ ì¤€ë¹„ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤. ê³„ì† í•´ì„œ Voice Assistanceë¥¼ ë§Œë“¤ì–´ ë³´ê² ìŠµë‹ˆë‹¤."</span><span class="p">)</span> <span class="c1"># "Now, STT is ready. We are going to make 'Voice Assistance'"
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ìŠ¤í”¼ì»¤ì—ì„œ ìƒê¸° ë©”ì‹œì§€ê°€ ì¶œë ¥ë˜ëŠ” ê²ƒì„ ë³´ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. Your speaker will produce the message above
</code></pre></div></div>

<h2 id="tts-exercise-1-ìš”ì¼ì‹œê°„-ìŒì„±-ì¶œë ¥í•˜ê¸°-audio-output-daytime">TTS Exercise 1: ìš”ì¼/ì‹œê°„ ìŒì„± ì¶œë ¥í•˜ê¸° Audio Output (Day/Time)</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">query_day</span><span class="p">():</span>
    <span class="n">day</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="n">date</span><span class="p">.</span><span class="n">today</span><span class="p">()</span>
    <span class="n">weekday</span> <span class="o">=</span> <span class="n">day</span><span class="p">.</span><span class="n">weekday</span><span class="p">()</span>
    <span class="n">week_mapping</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mi">0</span><span class="p">:</span> <span class="s">"ì›”ìš”ì¼"</span><span class="p">,</span> <span class="c1"># Monday
</span>        <span class="mi">1</span><span class="p">:</span> <span class="s">"í™”ìš”ì¼"</span><span class="p">,</span> <span class="c1"># Tuesday
</span>        <span class="mi">2</span><span class="p">:</span> <span class="s">"ìˆ˜ìš”ì¼"</span><span class="p">,</span> <span class="c1"># Wednesday
</span>        <span class="mi">3</span><span class="p">:</span> <span class="s">"ëª©ìš”ì¼"</span><span class="p">,</span> <span class="c1"># Thursday
</span>        <span class="mi">4</span><span class="p">:</span> <span class="s">"ê¸ˆìš”ì¼"</span><span class="p">,</span> <span class="c1"># Friday
</span>        <span class="mi">5</span><span class="p">:</span> <span class="s">"í† ìš”ì¼"</span><span class="p">,</span> <span class="c1"># Saturday
</span>        <span class="mi">6</span><span class="p">:</span> <span class="s">"ì¼ìš”ì¼"</span><span class="p">,</span> <span class="c1"># Sunday
</span>    <span class="p">}</span>

    <span class="n">speaking</span><span class="p">(</span><span class="sa">f</span><span class="s">"ì˜¤ëŠ˜ì€ </span><span class="si">{</span><span class="n">week_mapping</span><span class="p">[</span><span class="n">weekday</span><span class="p">]</span><span class="si">}</span><span class="s">ì…ë‹ˆë‹¤. </span><span class="si">{</span><span class="n">week_mapping</span><span class="p">[</span><span class="n">weekday</span><span class="p">]</span><span class="si">}</span><span class="s">ì—ë„ ê³µë¶€í•˜ëŠë¼ ê³ ìƒì´ì‹œë„¤ìš”!"</span> <span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">query_day</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ì˜¤ëŠ˜ ìš”ì¼ì´ ìŒì„± ì¶œë ¥ë˜ëŠ” ê²ƒì„ ë³´ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. Audio output successfully produced
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">query_time</span><span class="p">():</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">().</span><span class="n">strftime</span><span class="p">(</span><span class="s">"%H:%M:%S"</span><span class="p">)</span>
    <span class="n">speaking</span><span class="p">(</span><span class="sa">f</span><span class="s">"í˜„ì¬ëŠ” </span><span class="si">{</span><span class="n">time</span><span class="p">[</span><span class="si">:</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s">ì‹œ </span><span class="si">{</span><span class="n">time</span><span class="p">[</span><span class="mi">3</span><span class="si">:</span><span class="mi">5</span><span class="p">]</span><span class="si">}</span><span class="s">ë¶„ì…ë‹ˆë‹¤."</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">query_time</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>í˜„ì¬ ì‹œê°„ì´ ìŒì„± ì¶œë ¥ë˜ëŠ” ê²ƒì„ ë³´ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. Audio output successfully produced
</code></pre></div></div>

<h2 id="tts-exercise-2-stt--tts">TTS Exercise 2: STT + TTS</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">webbrowser</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">while</span> <span class="p">(</span><span class="bp">True</span><span class="p">):</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">transform</span><span class="p">()</span>

    <span class="k">if</span>  <span class="s">"ë¬´ìŠ¨ ìš”ì¼"</span> <span class="ow">in</span> <span class="n">q</span><span class="p">:</span>
        <span class="n">query_day</span><span class="p">()</span>
        <span class="k">continue</span>
    <span class="k">elif</span> <span class="s">"ëª‡ ì‹œ"</span> <span class="ow">in</span> <span class="n">q</span><span class="p">:</span>
        <span class="n">query_time</span><span class="p">()</span>
        <span class="k">continue</span> 
    <span class="k">elif</span> <span class="s">"ìœ íŠœë¸Œ ì‹œì‘"</span> <span class="ow">in</span> <span class="n">q</span><span class="p">:</span>
        <span class="n">speaking</span><span class="p">(</span><span class="s">"ìœ íŠœë¸Œë¥¼ ì‹œì‘í•˜ê² ìŠµë‹ˆë‹¤. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”!"</span><span class="p">)</span>
        <span class="n">webbrowser</span><span class="p">.</span><span class="nb">open</span><span class="p">(</span><span class="s">"https://www.youtube.com"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s">"ë„¤ì´ë²„ ì‹œì‘"</span> <span class="ow">in</span> <span class="n">q</span><span class="p">:</span>
        <span class="n">speaking</span><span class="p">(</span><span class="s">"ë„¤ì´ë²„ë¥¼ ì‹œì‘í•˜ê² ìŠµë‹ˆë‹¤. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”!"</span><span class="p">)</span>
        <span class="n">webbrowser</span><span class="p">.</span><span class="nb">open</span><span class="p">(</span><span class="s">"https://www.naver.com"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s">"ì´ë™"</span> <span class="ow">in</span> <span class="n">q</span><span class="p">:</span>
        <span class="n">speaking</span><span class="p">(</span><span class="s">"ìœˆë„ìš°í‚¤ë¥¼ ì‹¤í–‰í•˜ê² ìŠµë‹ˆë‹¤. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”!"</span><span class="p">)</span>
        <span class="n">pyautogui</span><span class="p">.</span><span class="n">moveTo</span><span class="p">(</span><span class="mi">700</span><span class="p">,</span> <span class="mi">1050</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">pyautogui</span><span class="p">.</span><span class="n">click</span><span class="p">(</span><span class="n">button</span><span class="o">=</span><span class="s">"left"</span><span class="p">)</span>        
    <span class="k">elif</span> <span class="s">"ì´ì œ ê·¸ë§Œ"</span> <span class="ow">in</span> <span class="n">q</span><span class="p">:</span>
        <span class="n">speaking</span><span class="p">(</span><span class="s">"ì•„ì‰½ì§€ë§Œ ë‹¤ìŒì— ë˜ ëµ™ê² ìŠµë‹ˆë‹¤"</span><span class="p">)</span>
        <span class="k">break</span>
</code></pre></div></div>

<p>ê°€ë ¹, â€˜ë„¤ì´ë²„ ì‹œì‘â€™ì´ë¼ëŠ” ë§ˆì´í¬ ì…ë ¥ì„ ë„£ìœ¼ë©´, â€˜ë„¤ì´ë²„ ì‹œì‘â€™ì´ë¼ëŠ” ë§ì´ ìŠ¤í”¼ì»¤ë¡œ ë°˜í–¥ë˜ë©° webbrowser ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í†µí•˜ì—¬ ë„¤ì´ë²„ë¥¼ ë¸Œë¼ìš°ì €ì—ì„œ ë„ì›Œì¤€ë‹¤. <span style="color: blue">If you say â€˜NAVERâ€™, your speaker will produce â€œStart NAVERâ€ and then open the site on your browser.  </span></p>

<h1 id="bonus-keyboard-io">Bonus: Keyboard I/O</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">pyautogui</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pyautogui</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">screenWidth</span><span class="p">,</span> <span class="n">screenHeight</span> <span class="o">=</span> <span class="n">pyautogui</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="c1"># screen resolution
</span>
<span class="n">pyautogui</span><span class="p">.</span><span class="n">moveTo</span><span class="p">(</span><span class="mi">700</span><span class="p">,</span> <span class="mi">1050</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="c1"># ë§ˆìš°ìŠ¤ ì»¤ì„œë¥¼ x, y ì¢Œí‘œë¡œ ì´ë™ Move the cursor to the coordinate of x and y
</span><span class="n">pyautogui</span><span class="p">.</span><span class="n">click</span><span class="p">(</span><span class="n">button</span><span class="o">=</span><span class="s">"left"</span><span class="p">)</span> <span class="c1"># í•´ë‹¹ ìœ„ì¹˜ ë²„íŠ¼ì„ ì¢Œí´ë¦­ left-click the current position
</span></code></pre></div></div>
:ET