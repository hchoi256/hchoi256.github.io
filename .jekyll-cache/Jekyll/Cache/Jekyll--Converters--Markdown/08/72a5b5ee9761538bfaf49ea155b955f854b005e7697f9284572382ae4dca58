I"#<p><img src="https://user-images.githubusercontent.com/39285147/184294516-0dad2074-9c87-44f1-af52-6ea4c0b5f174.png" alt="image" /></p>

<p><a href="https://arxiv.org/abs/2206.05224"><strong>논문</strong></a></p>

<h1 id="들어가면서">들어가면서</h1>
<p>법률 계약서는 일반인이 독해하기 어려운 단어들 뿐만 아니라, 한 문장이 한 페이지를 차지할 정도로 긴 문장들을 포함한다.</p>

<p>이전에 참가한 한 세미나에서는 이러한 법률 계약서에 존재하는 오류를 검사하는 AI 모델을 실제 변호사와 대결시킨 사례를 소개했다.</p>

<p>AI 모델은 <strong>26초 만에 94%의 정확도</strong>로 오류를 검증해내었고, 반면 사람 변호사는 <strong>96분 동안 86%의 정확도</strong>로 오류를 잡아냈다.</p>

<p>이러한 압도적인 AI의 성능은 매번 적응되지 않을 정도로 정말이지 어마무시하다.</p>

<p>하지만, 상기 법률 계약서의 문서 내용은 영어로 적혀있었다. 다시 말해, 자연어 처리 분야에서 기계독해가 까다로운 <strong>한국어로 적힌 법률 계약서</strong>는 아직까진 그만한 성능을 내는 AI 모델이 전무하다.</p>

<p>상기 목표를 달성하기 위해서는 다양한 조건이 수반되어야 할터인데, 가령 한국어 기반 모델 검증을 위한 <strong>법률 평가 데이터셋</strong>이 필요할 것이고, 까다로운 한국어 문법을 정확히 이해하는 성능좋은 언어모델이 필요하다.</p>

<p>여기까지는 내 잡담이었으니 가볍게 무시해도 상관없다.</p>

<p>하지만, 앞서 언급된 사례는 다양한 전문 분야에서 <strong>한국어 기반 NLP 연구</strong>의 필요성을 부각한다는 점은 인지하자.</p>

<h1 id="introduction">INTRODUCTION</h1>
<p>[<em>KAIST AI Grad School, located in Seoul</em>]</p>

<p><img src="https://user-images.githubusercontent.com/39285147/184298843-e3edab46-0d27-4a74-a1f1-62762d1a794a.png" alt="image" /></p>

<p>정부에서 출시한 규칙 및 도메인 지식에 근거한 기존 법률 시스템은 유의미한 성과를 내기도 했으나, <strong>범용성이 부족</strong>하다는 한계점이 존재했다.</p>

<p>이러한 실패에는 해당 전문 분야에 대한 <strong>한국어 NLP 데이터셋 부재</strong>와 NLP 학습에 <strong>까다로운 한국어 특성</strong>이 내재되어 있을 것이다.</p>

<p>하지만, Deep Learning에 발전에 따라 자연어 처리 또한 많은 변화의 시기를 거쳐서 ‘판결 예측’과 같은 여러 법률 분야에 새로운 기술적 패러다임을 제시한다.</p>

<p>이러한 격동의 시기에 발맞춰 전세계에서는 AI 모델 학습에 필수적인 법률 데이터셋을 만들기 시작했고, 서교수 연구팀 또한 기존에 정부에서 내놓은 활용 가치가 떨어졌던 한국어 법률 데이터셋로부터 더 확장하여 새로운 한국어 기반 법률 데이터셋 연구 개발에 임하게 되었다.</p>

<p>서교수를 주축으로한 연구팀은 ‘최초로’ <strong>한국어 기반 대용량 법률 AI 데이터셋</strong>과 <strong>‘LBOX OPEN’</strong>이라는 법률 평가 데이터셋, 그리고 <strong>LCUBE라는 한국어 법률 언어 모델</strong>을 만들게 되었다 (<em>LBOX OPEN과 LCUBE는 해당 논문 페이지를 통해 다운받아 이용 가능하다</em>).</p>

<p>LBOX OPEN은 <em>1개의 법률 corpus</em>, <em>두 개의 분류 문제</em>, <em>두 개의 법률 판단 예측 문제</em>, 그리고 <em>한 개의 요약 문제</em>를 위한 평가 데이터셋이다.</p>

<blockquote>
  <p>범죄와 같이 어떠한 종류의 사례들을 기반으로 구성된 데이터셋인지, 언제/어떻게 데이터를 수집했는지 등 보다 자세한 내용은 해당 논문에서 확인하길 바란다.</p>
</blockquote>

<h1 id="lbox-open---large-scale-korean-legal-ai-benchmark"><em>LBOX OPEN</em> - Large-scale Korean legal AI benchmark.</h1>

<p>LBOX OPEN의 구성은 다음과 같다:</p>
<ul>
  <li>(1) <strong>a large-scale legal precedent corpus</strong> (PRECEDENT CORPUS)</li>
  <li>(2) <strong>two classification tasks</strong> (CASE NAME, STATUTE)</li>
  <li>(3) <strong>two legal judgement prediction tasks</strong> (LJP-CRIMINAL, LJPCIVIL)</li>
  <li>(4) <strong>one summarization task</strong> (SUMMARIZATION).</li>
</ul>

<blockquote>
  <p>각 구성 요소에 대한 활용 방벙과 같은 보다 자세한 설명은 해당 논문에 나와있다.</p>
</blockquote>

<h2 id="data-preprocessing">Data preprocessing</h2>
<p>서교수 연구팀은 기존에 정부에서 내놓은 Korean precedents라는 raw data에 포함된 non-trivial 정보들을 자동 parsing하고자 <strong>custom data engineering pipeline</strong>을 만들었다.</p>

<p>해당 Pipeline에서 여러 분류 작업을 거친다.</p>
<ul>
  <li><em>RestNet</em>을 기반 <em>Layout classifier</em>를 활용하여 각 페이지를 <em>‘text only’</em> 혹은 <em>‘text w/ tbl or pictures’</em>로 분류하였다.</li>
  <li><em>Mask-R-CNN</em>의 <em>Layout parser</em>를 사용하여 non-textual 요소들을 페이지로부터 분리한다.</li>
  <li>Save the information to the database:
    <ul>
      <li>If pdf, extract text w/ custom rule-based parser</li>
      <li>Otherwise if images, extract text segments and their coordinates w/ proprietary OCR engine and use language model to corret OCR errors.</li>
    </ul>
  </li>
</ul>

<p>상기 과정을 거친 후 <strong>confidence score</strong>를 계산해 기준치보다 낮을 경우, 해당 페이지들은 연구팀이 직접 수동으로 처리한다.</p>

<p>마지막으로, 하기 정보를 JSON 형식으로 저장하고 최종 output을 도출한다:</p>
<ul>
  <li>(1) meta information such as case name, sentencing dates, and names of attendees</li>
  <li>(2) ruling</li>
  <li>(3) gist of claim</li>
  <li>(4) appeal</li>
  <li>(5) reasoning body that consists of facts, claims, reasoning, and decision of judges.</li>
</ul>

<h1 id="lcube---language-model-based-on-lbox-open"><em>LCUBE</em> - Language model based on LBOX OPEN</h1>
<p><strong>Classification tasks</strong></p>
<ul>
  <li>GPT-2 활용 decoder-only 모델 –&gt; comparable performance with MT5 (a competitive encoder-decoder language model with larger size)</li>
</ul>

<p><strong>Summarization tasks</strong></p>
<ul>
  <li>타모델에 비해 상대적으로 안좋은 성능을 보인다.</li>
</ul>

<h1 id="experiments">EXPERIMENTS</h1>
<p>CASE NAME, STATUTE, LJP-CRIMINAL, LJP-CIVIL, 그리고 SUMMARIZATION tasks에 대하여 실험 평가를 진행한다.</p>

<h2 id="model-training">Model training</h2>
<p>서교수님의 LK 연구소는 한정된 예산으로 GPU와 같은 하드웨어를 따로 소유하는 것이 아니라 클라우드를 대여하는 연구 방식으로 유명하다.</p>

<p>이번 프로젝트에서 역시 클라우드에서 Nvidia RTX3090/RTX6000를 대여하여 모델 학습을 진행했다.</p>

<p>다음은 모델 학습에 사용된 parameter settings이다:</p>
<ul>
  <li><strong>learning rate</strong>: 0.00003-0.0001</li>
  <li><strong>batch</strong>: 8-16</li>
  <li><strong>optimizer</strong>: AdamW</li>
  <li><strong>fine-tuning</strong>: MT5-small (checkpoint: <em>‘google/mt5-small’</em>)</li>
  <li><strong>accracy</strong>: <em>F</em>1</li>
  <li>etc.</li>
</ul>

<blockquote>
  <p>보다 상세한 spec은 해당 논문을 참조하길 바란다.</p>
</blockquote>

<h2 id="metric">Metric</h2>
<ul>
  <li>(1) the case is counted as a true positive if their values are equal</li>
  <li>(2) false positive f their values are not equal</li>
  <li>(3) When the target field exists only in GT but not in the prediction, the case is counted as a false negative.</li>
  <li>(4) If the target field is empty in the GT but exists in the prediction it is counted as a false positive.</li>
  <li>(5) If the field is empty in both GT and the prediction, the case is considered as a truenegative.</li>
</ul>

<blockquote>
  <p>The zero labels in LJP-CRIMINAL are counted as nulls.</p>
</blockquote>

<h2 id="results">Results</h2>
<p><img src="https://user-images.githubusercontent.com/39285147/184300687-c0aa8c4c-5d9c-4156-b674-737bac61bbd8.png" alt="image" /></p>

<p><strong>LCUBE-base</strong> vs. <strong>KoGPT-2</strong></p>
<ul>
  <li>In all tasks except SUMMARIZATION, LCUBE-base shows a higher performance</li>
</ul>

<h1 id="limitations">LIMITATIONS</h1>
<p>해당 논문 모든 내용은 한국 법체계의 first level court에 대한 precedents만을 고려한 연구 결과이다.</p>

<p>또한, 원고, 피고와 같은 요인들을 인풋으로 고려하지 않은 판결 예측 결과라고 가정하며, LBOX OPEN은 legal information retrieval task 등 여러 문제에 대한 사례 정보는 반영하지 않는다.</p>

<p>상기 언급된 한계점들은 시스템적으로 구현이 매우 까다로우며, 도메인 지식이 풍부한 여러 전문가와의 협업이 필요시 될것이며, 이것이 곧 LBOX OPEN의 미래 과제일 것이다.</p>
:ET