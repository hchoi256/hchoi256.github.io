I"“f<h1 id="learning-goals">Learning Goals</h1>
<p>ANNì„ ì´ìš©í•œ ì£¼íƒ ê°€ê²© ì˜ˆì¸¡ <span style="color: blue">House Price Prediction Using ANN </span></p>

<h1 id="loading-the-dataset">Loading the dataset</h1>

<p class="notice--danger"><strong>[Notice]</strong> <a href="https://www.kaggle.com/datasets/harlfoxem/housesalesprediction">Download Dataset (Kaggle)</a></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>

<span class="n">house_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"kc-house-data.csv"</span><span class="p">)</span>
<span class="n">house_df</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            &lt;class 'pandas.core.frame.DataFrame'&gt;
            RangeIndex: 21613 entries, 0 to 21612
            Data columns (total 21 columns):
            #   Column         Non-Null Count  Dtype  
            ---  ------         --------------  -----  
            0   id             21613 non-null  int64  
            1   date           21613 non-null  object 
            2   price          21613 non-null  float64
            3   bedrooms       21613 non-null  int64  
            4   bathrooms      21613 non-null  float64
            5   sqft_living    21613 non-null  int64  
            6   sqft_lot       21613 non-null  int64  
            7   floors         21613 non-null  float64
            8   waterfront     21613 non-null  int64  
            9   view           21613 non-null  int64  
            10  condition      21613 non-null  int64  
            11  grade          21613 non-null  int64  
            12  sqft_above     21613 non-null  int64  
            13  sqft_basement  21613 non-null  int64  
            14  yr_built       21613 non-null  int64  
            15  yr_renovated   21613 non-null  int64  
            16  zipcode        21613 non-null  int64  
            17  lat            21613 non-null  float64
            18  long           21613 non-null  float64
            19  sqft_living15  21613 non-null  int64  
            20  sqft_lot15     21613 non-null  int64  
            dtypes: float64(5), int64(15), object(1)
            memory usage: 3.5+ MB
</code></pre></div></div>

<h1 id="eda">EDA</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="n">sns</span><span class="p">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">house_df</span><span class="p">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">annot</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/39285147/182361111-97d0802d-acd4-45bb-aa0b-94e1b1bab205.png" alt="image" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">"sqft_living"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"price"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">house_df</span><span class="p">)</span>
</code></pre></div></div>

<p>ë§›ë³´ê¸°ë¡œ â€˜sqft_livingâ€™ ë³€ìˆ˜ì™€ ì¢…ì†ë³€ìˆ˜(â€˜Priceâ€™)ì˜ ìƒê´€ê´€ê³„ ë¶„í¬ë„ë¥¼ ë§Œë“¤ì—ˆë‹¤. <span style="color: blue"> For testing, I created a plot of the correlation between â€˜sqft_livingâ€™ and â€˜Priceâ€™. </span></p>

<p><img src="https://user-images.githubusercontent.com/39285147/182361658-ed16e620-ce21-42b2-8f1c-c5fda874f1a4.png" alt="image" /></p>

<p>ìƒê¸° ê·¸ë¦¬ë“œëŠ” ëª¨ë“  ë³€ìˆ˜ë“¤ ê°„ì˜ ìƒê´€ê´€ê³„ ë¶„í¬ë„ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. <span style="color: blue"> The grid represents correlation distributions between all variables.</span></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">house_df</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/39285147/182361909-5dfe48f9-90b0-49ba-bb1d-584a4c7cdb5e.png" alt="image" /></p>

<h1 id="preprocessing">Preprocessing</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">selected_features</span> <span class="o">=</span> <span class="p">[</span><span class="s">'bedrooms'</span><span class="p">,</span><span class="s">'bathrooms'</span><span class="p">,</span><span class="s">'sqft_living'</span><span class="p">,</span><span class="s">'sqft_lot'</span><span class="p">,</span><span class="s">'floors'</span><span class="p">,</span> <span class="s">'sqft_above'</span><span class="p">,</span> <span class="s">'sqft_basement'</span><span class="p">,</span> <span class="s">'waterfront'</span><span class="p">,</span> <span class="s">'view'</span><span class="p">,</span> <span class="s">'condition'</span><span class="p">,</span> <span class="s">'grade'</span><span class="p">,</span> <span class="s">'sqft_above'</span><span class="p">,</span> <span class="s">'yr_built'</span><span class="p">,</span> 
<span class="s">'yr_renovated'</span><span class="p">,</span> <span class="s">'zipcode'</span><span class="p">,</span> <span class="s">'lat'</span><span class="p">,</span> <span class="s">'long'</span><span class="p">,</span> <span class="s">'sqft_living15'</span><span class="p">,</span> <span class="s">'sqft_lot15'</span><span class="p">]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">house_df</span><span class="p">[</span><span class="n">selected_features</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">house_df</span><span class="p">[</span><span class="s">"price"</span><span class="p">]</span>
</code></pre></div></div>

<h1 id="feature-scaling">Feature Scaling</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">.</span><span class="n">values</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="splitting-the-dataset-into-the-training-set-and-test-set">Splitting the dataset into the Training set and Test set</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">y_scaled</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="building-the-model">Building the model</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">"relu"</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">19</span><span class="p">,</span> <span class="p">)))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">"relu"</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">"relu"</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">"linear"</span><span class="p">))</span>

<span class="n">model</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span> <span class="o">=</span> <span class="s">"Adam"</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="s">"mean_squared_error"</span><span class="p">)</span>
<span class="n">epochs_hist</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">validation_split</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            Epoch 1/50
            277/277 [==============================] - 1s 2ms/step - loss: 8.2607e-04 - val_loss: 4.8727e-04
            Epoch 2/50
            277/277 [==============================] - 0s 1ms/step - loss: 5.2934e-04 - val_loss: 4.1871e-04
            Epoch 3/50
            277/277 [==============================] - 0s 1ms/step - loss: 4.4549e-04 - val_loss: 4.3053e-04
            ...
            Epoch 49/50
            277/277 [==============================] - 0s 2ms/step - loss: 1.9294e-04 - val_loss: 2.6583e-04
            Epoch 50/50
            277/277 [==============================] - 0s 1ms/step - loss: 1.9350e-04 - val_loss: 2.8596e-04
</code></pre></div></div>

<p>â€˜epochâ€™ ê°œìˆ˜ë¥¼ ì¦ê°€ì‹œí‚¤ë©´ ëª¨ë¸ì´ ì ì€ ì†ì‹¤ê°’ê³¼ í•¨ê»˜ ë” ì •í™•í•œ ì˜ˆì¸¡ì„ í•´ë‚¼ ê²ƒì´ë‹¤. <span style="color: blue"> Increasing the number of â€˜epochsâ€™ will cause the model to make more accurate predictions with fewer losses. </span></p>

<p>í•˜ì§€ë§Œ, ì´ê²ƒì€ <strong>ê³¼ì í•©</strong> í˜„ìƒì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆìœ¼ë‹ˆ, ì ì ˆí•œ ê°œìˆ˜ ì„¤ì •ì„ ìˆ˜ë™ìœ¼ë¡œ ë°”ê¿”ê°€ë©° í™•ì¸í•´ë³¼ í•„ìš”ê°€ ìˆë‹¤. <span style="color: blue"> However, this can lead to <strong>overfitting</strong>, so you need to manually change the appropriate number setting to check.</span></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">epochs_hist</span><span class="p">.</span><span class="n">history</span><span class="p">.</span><span class="n">keys</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            dict_keys(['loss', 'val_loss'])
</code></pre></div></div>

<h1 id="visualizing-the-results">Visualizing the results</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">epochs_hist</span><span class="p">.</span><span class="n">history</span><span class="p">[</span><span class="s">'loss'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">epochs_hist</span><span class="p">.</span><span class="n">history</span><span class="p">[</span><span class="s">'val_loss'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Model Loss Progress During Training'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Training and Validation Loss'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Epoch number'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">([</span><span class="s">'Training Loss'</span><span class="p">,</span> <span class="s">'Validation Loss'</span><span class="p">])</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/39285147/182364127-10aef50f-9e03-4abf-9d80-4520885520cc.png" alt="image" /></p>

<p>ë§Œì•½, í•™ìŠµ ê³¼ì •ì—ì„œ epochâ€™ ê°œìˆ˜ë¥¼ 50ì´ ì•„ë‹ˆë¼ 100ìœ¼ë¡œ í–ˆë‹¤ë©´, â€˜validation lossâ€™ ë¶„ì‚°ì´ ë” ì ê²Œ ë‚˜íƒ€ë‚¬ì„ ê²ƒì´ë‹¤. <span style="color: blue"> If the number of epochs was 100 instead of 50 in the training process, the â€˜validation lossâ€™ variance would be smaller. </span></p>

<p>ì°¸ê³ ë¡œ, ì…ë ¥ í”¼ì²˜ì˜ ê°œìˆ˜ë¥¼ ì ê²Œ ì„¤ì •í•˜ë©´ í•˜ê¸° ë¶„í¬ì²˜ëŸ¼ â€˜Validation lossâ€™ê°€ êµ‰ì¥íˆ íŠ€ëŠ” ëª¨ìŠµì„ ë³´ì¼ ê²ƒì´ë‹¤. <span style="color: blue"> For reference, if the number of input features is set to be smaller, the â€˜Validation lossâ€™ will be very bouncing like the following distribution. </span></p>

<p><img src="https://user-images.githubusercontent.com/39285147/182363306-02a5eef0-a504-47c2-a4e3-054ab9fac40a.png" alt="image" /></p>

<p>ì´ê²ƒì€ ë§ˆì¹˜ ìš°ë¦¬ê°€ ì‹œí—˜ ì„±ì ì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ìš”ì¸ ì¤‘ì—, ì‹œí—˜ ì „ë‚  ìˆ˜ë©´ ì‹œê°„ì´ ì£¼ìš”í•œ ì…ë ¥ í”¼ì²˜ì„ì—ë„ ë¬´ì‹œí•˜ê³  ìˆë‹¤ê°€, ë’¤ëŠ¦ê²Œ ëª¨ë¸ í•™ìŠµì— ë°˜ì˜í•˜ì—¬ ëª¨ë¸ì´ ìƒˆë¡œìš´ ë°ì´í„°ë“¤ì— ëŒ€í•´ ë” ì •í™•í•œ ì˜ˆì¸¡ì„ í•´ë‚´ëŠ” ê²ƒê³¼ ë¹„ìŠ·í•œ ì´ì¹˜ì´ë‹¤. <span style="color: blue"> For example, if you had an exam tomorrow but hadnâ€™t slept yesterday, you would likely screw up the exam. Similarly, we see that sleep time before the exam is a pivotal feature in training our AI model. </span></p>

<h1 id="predicting-the-test-set">Predicting the Test set</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y_predict</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_predict</span><span class="p">,</span> <span class="s">"^"</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'r'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"Model Predictions"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"True Value (ground Truth)"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Linear Regression Predictions'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/39285147/182363900-7d34d060-edd2-47e6-a2eb-95834311003b.png" alt="image" /></p>

<p>ì—­ì‹œ ì‹œê°í™”ì—ì„œ ë‹¨ìœ„ê°€ ì •ê·œí™”ëœ ëª¨ìŠµì´ë‹¤. <span style="color: blue"> As shown in the image, the units are normalized. </span></p>

<p>ì›ë˜ ë‹¨ìœ„ë¡œ ë³€í™˜ì‹œì¼œë³´ì. <span style="color: blue"> Letâ€™s convert to the original unit</span></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y_predict_orig</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_predict</span><span class="p">)</span>
<span class="n">y_test_orig</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>

<span class="n">y_predict</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_test_orig</span><span class="p">,</span> <span class="n">y_predict_orig</span><span class="p">,</span> <span class="s">"^"</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'r'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"Model Predictions"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"True Value (ground Truth)"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Linear Regression Predictions'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/39285147/182363915-2201e582-10bb-45b2-82a9-ac35d94754cd.png" alt="image" /></p>

<h1 id="evaluating-the-model-performance">Evaluating the model performance</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span>

<span class="n">RMSE</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test_orig</span><span class="p">,</span> <span class="n">y_predict_orig</span><span class="p">)),</span><span class="s">'.3f'</span><span class="p">))</span>
<span class="n">MSE</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test_orig</span><span class="p">,</span> <span class="n">y_predict_orig</span><span class="p">)</span>
<span class="n">MAE</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test_orig</span><span class="p">,</span> <span class="n">y_predict_orig</span><span class="p">)</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test_orig</span><span class="p">,</span> <span class="n">y_predict_orig</span><span class="p">)</span>
<span class="n">adj_r2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">r2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'RMSE ='</span><span class="p">,</span><span class="n">RMSE</span><span class="p">,</span> <span class="s">'</span><span class="se">\n</span><span class="s">MSE ='</span><span class="p">,</span><span class="n">MSE</span><span class="p">,</span> <span class="s">'</span><span class="se">\n</span><span class="s">MAE ='</span><span class="p">,</span><span class="n">MAE</span><span class="p">,</span> <span class="s">'</span><span class="se">\n</span><span class="s">R2 ='</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="s">'</span><span class="se">\n</span><span class="s">Adjusted R2 ='</span><span class="p">,</span> <span class="n">adj_r2</span><span class="p">)</span> 
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>            RMSE = 135724.235 
            MSE = 18421068040.530396 
            MAE = 79133.06868421813 
            R2 = 0.8656443648009154 
            Adjusted R2 = 0.8654264066441615
</code></pre></div></div>

<p>ìƒê¸° ë‹¤ì–‘í•œ ì¢…ë¥˜ì˜ ì†ì‹¤ê°’ì„ í™œìš©í•˜ì—¬ ëª¨ë¸ ì„±ëŠ¥ í‰ê°€ê°€ ê°€ëŠ¥í•˜ë‹¤. <span style="color: blue">It is possible to evaluate the model performance by using the above various types of loss values.</span></p>

<p>ì¢‹ì€ ëª¨ë¸ì¼ìˆ˜ë¡ ê° ì†ì‹¤ê°’ì´ ì‘ì„ ê²ƒì´ë‹¤. <span style="color: blue">The better the model, the smaller each loss value will be.</span></p>

<p>ì•ì„œ ì–¸ê¸‰í•œ â€˜epochâ€™ì™€ ê°™ì€ ìš”ì¸ë“¤ì„ ìˆ˜ë™ìœ¼ë¡œ ë°”ê¿”ê°€ë©° ê° ì†ì‹¤ê°’ë“¤ì˜ ë³€í™”ë¥¼ ê´€ì°°í•˜ì—¬ ìµœì ì˜ ì„¤ì •ê°’ì„ êµ¬í•˜ì.<span style="color: blue"> You need to manually change factors such as â€˜epochâ€™ and find the optimal combination of parameters by observing the change in each loss value.</span></p>

<p>ë˜í•œ, í˜¼ë™ í–‰ë ¬ ê°™ì€ ê¸°ë²•ìœ¼ë¡œ ì„±ëŠ¥ ë¶„ì„ì´ ê°€ëŠ¥í•  ê²ƒì´ë‹¤. <span style="color: blue"> You might want to use â€˜confusion matrixâ€™ for performance analysis.</span></p>

:ET