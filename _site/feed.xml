<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.2.2">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2022-08-19T00:39:44+09:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">ì •ë¦¬í•˜ì—¬ ë‚´ ê²ƒìœ¼ë¡œ, AI ğŸ“‚</title><subtitle>Leveraging SOTA Technologies in AI</subtitle><author><name>ì­ŒìŠ¤ğŸ„</name></author><entry><title type="html">NLP - Part 7: Name Entity Recognition (NER) ì•±</title><link href="http://localhost:4000/nlp/nlp-NER/" rel="alternate" type="text/html" title="NLP - Part 7: Name Entity Recognition (NER) ì•±" /><published>2022-08-16T00:00:00+09:00</published><updated>2022-08-16T00:00:00+09:00</updated><id>http://localhost:4000/nlp/nlp-NER</id><content type="html" xml:base="http://localhost:4000/nlp/nlp-NER/"><![CDATA[<h1 id="ì‚¬ì „-ì„¤ì •">ì‚¬ì „ ì„¤ì •</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">spacy</span> <span class="n">spacy_streamlit</span>
<span class="o">%</span> <span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">spacy</span> <span class="n">download</span> <span class="n">en_core_web_trf</span>
</code></pre></div></div>

<p>1) í•˜ë‚˜í•˜ë‚˜ ì§ì ‘ ì…ë ¥!
   -&gt; ë…¸ë™ë ¥ì´ í•„ìš”
   -&gt; ì‹œê°„ë„ í•„ìš”
   -&gt; ì‹¤ìˆ˜ê°€ ìˆì„ ìˆ˜ ìˆë‹¤.
   -&gt; ì…ë ¥ ë„ì¤‘ì— ê°’ì´ ë³€í•  ìˆ˜ë„ ìˆë‹¤.</p>

<p>2) Copy &amp; Paste ë¡œ í•  ë•Œ ì´ 1640ë²ˆì˜ ë°˜ë³µì‘ì—…ì„ í•´ì•¼í•œë‹¤.
    ë¶™ì—¬ë„£ê¸° í•˜ê³  ì •ë¦¬ê°€ í•„ìš”í•˜ë‹¤!</p>

<p>3) ìµœí›„ì˜ ìˆ˜ë‹¨ ì›¹ í¬ë¡¤ë§(Web Crawling)ì„ í•˜ì!
   -&gt; ë°˜ë³µì„ ë‚´ê°€ í•˜ê¸° ì‹«ë‹¤!
   -&gt; ë§¤ì¼ ì •í•´ì§„ ì‹œê°„ì— í•˜ê³  ì‹¶ë‹¤
   -&gt; ìˆ˜ì§‘í•œ í›„ì— ë°ì´í„°ë² ì´ìŠ¤ë“  ì—‘ì…€íŒŒì¼ì´ë“  ì €ì¥í•˜ê³  ì‹¶ë‹¤</p>

<p>ì›¹ í¬ë¡¤ë§ (Web Crawling) :
  =&gt; ë‚´ê°€ ìˆ˜ì§‘í•˜ê³ ì í•˜ëŠ” ë°ì´í„°ê°€ ìˆëŠ” ì„œë²„ì— ì ‘ì†í•´ì„œ í•´ë‹¹ ì›¹í˜ì´ì§€ì˜ ì†ŒìŠ¤ì½”ë“œë¥¼ ê°€ì ¸ì˜¤ëŠ” í–‰ìœ„
  =&gt; ë°˜ë³µì ì¸ ì¼ë„ ìˆê³ , í˜ì´ì§€ ì´ë™, ë¡œê·¸ì¸ ë“±ë“±ì´ í•„ìš”í•˜ë‹¤.
  =&gt; ì»´í“¨í„°ëŠ” ì‹œí‚¨ ì¼ì— ëŒ€í•´ì„œ ë¹ ë¥´ê²Œ ë°˜ë³µì ìœ¼ë¡œ ì˜ í•œë‹¤.
  =&gt; í•´ë‹¹ ì„œë²„ ëª¨ë‹ˆí„°ë§ ì¤‘ ìì£¼ ë¹ ë¥´ê²Œ ë°˜ë³µì ìœ¼ë¡œ ì ‘ê·¼í•˜ëŠ” IPë¥¼ ì°¨ë‹¨</p>

<p>ì›¹ ìŠ¤í¬ë˜í•‘ (Web Scraping) :
  =&gt; ì›í•˜ëŠ” ë°ì´í„°ê°€ ìˆëŠ” ì›¹í˜ì´ì§€ì—ì„œ ì›í•˜ëŠ” ë°ì´í„°ë¥¼ ì¶”ì¶œí•˜ëŠ” í–‰ìœ„</p>

<p>ê° ì›¹ì‚¬ì´íŠ¸ë§ˆë‹¤ 
https://www.[ì›¹ì‚¬ì´íŠ¸ ì£¼ì†Œ]/robots.txt</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">beautifulsoup4</span>
</code></pre></div></div>]]></content><author><name>ì­ŒìŠ¤ğŸ„</name></author><category term="NLP" /><category term="NLP" /><category term="NER" /><summary type="html"><![CDATA[ì‚¬ì „ ì„¤ì •]]></summary></entry><entry><title type="html">Minimax ì•Œê³ ë¦¬ì¦˜ - Teeko Game</title><link href="http://localhost:4000/others/ml-teeko-minimax/" rel="alternate" type="text/html" title="Minimax ì•Œê³ ë¦¬ì¦˜ - Teeko Game" /><published>2022-08-14T00:00:00+09:00</published><updated>2022-08-14T00:00:00+09:00</updated><id>http://localhost:4000/others/ml-teeko-minimax</id><content type="html" xml:base="http://localhost:4000/others/ml-teeko-minimax/"><![CDATA[<p><strong>Minimax</strong> ì•Œê³ ë¦¬ì¦˜ì„ í™œìš©í•´ì„œ <strong>Teeko</strong> ê²Œì„ì„ êµ¬í˜„í•œë‹¤.</p>

<p>Teeko ê²Œì„ì€ í•œêµ­ì¸ë“¤ì—ê²ŒëŠ” ìµìˆ™í•˜ì§€ ì•Šì€ ë³´ë“œ ê²Œì„ì¼ ìˆ˜ë„ ìˆë‹¤ (í•˜ê¸° ì„¤ëª… ì°¸ì¡°).</p>

<blockquote>
  <p><strong><em>Teeko Game</em></strong>ì´ë€?</p>

  <p>It is a game between two players on a 5x5 board. Each player has four markers of either red or black. Beginning with black, they take turns placing markers (the â€œdrop phaseâ€) until all markers are on the board, with the goal of getting <strong>four in a row horizontally, vertically, or diagonally, or in a 2x2 box as shown above</strong>. If after the drop phase neither player has won, they continue taking turns moving one marker at a time â€“ to an adjacent space only! (this includes diagonals, not just left, right, up, and down one space.) â€“ until one player wins. Note, the game has no â€œwrap-aroundâ€ similar to other board games, so a player can not move off of the board or win using pieces on the other side of the board.</p>
</blockquote>

<p>ìƒê¸° ì„¤ëª…ì— ë‚˜ì˜¨ ê²ƒì²˜ëŸ¼ 4ê°œì˜ ë§ˆì»¤ê°€ ìˆ˜ì§, ìˆ˜í‰, ëŒ€ê°, í˜¹ì€ 2x2 ë°•ìŠ¤ í˜•íƒœë¡œ ì¡´ì¬í•˜ê²Œ ë˜ë©´ ìŠ¹ë¦¬í•œë‹¤.</p>

<p>ì´ ê²Œì„ì—ì„œ ë‹¹ì‹ ì€ AI ë¡œë´‡ê³¼ Teeko ë³´ë“œ ê²Œì„ì„ í¼ì¹˜ê²Œ ë  ê²ƒì´ë‹¤.</p>

<p>ì´ í”„ë¡œì íŠ¸ëŠ” Minimax ì•Œê³ ë¦¬ì¦˜ì„ ì´í•´í•˜ê³  ìˆë‹¤ëŠ” ì „ì œë¡œ ì§„í–‰í•œë‹¤.</p>

<blockquote>
  <p><a href="https://github.com/hchoi256/ai-terms/blob/main/README.md">Minimax ì•Œê³ ë¦¬ì¦˜</a>ì´ë€?</p>
</blockquote>

<h1 id="code">Code</h1>
<p class="notice--danger"><strong>[Notice]</strong> <a href="https://github.com/hchoi256/cs540-AI/tree/main/teeko-minimax-game">download here</a></p>

<h1 id="teekoplayer-í´ë˜ìŠ¤">TeekoPlayer í´ë˜ìŠ¤</h1>

<p>Teeko ê²Œì„ì„ ì§„í–‰í•¨ì— ìˆì–´ì„œ ê° í”Œë ˆì´ì–´ Objectì— ëŒ€í•´ ì œì–´í•˜ê¸° ìœ„í•´ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ë³´ì.</p>

<p>ìì„¸í•œ ì„¤ëª…ì€ ì½”ë“œ ì£¼ì„ìœ¼ë¡œì¨ ì ì–´ë†¨ìœ¼ë‹ˆ ì°¸ê³ í•˜ì.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">TeekoPlayer</span><span class="p">:</span>
    <span class="s">""" An object representation for an AI game player for the game Teeko.
    """</span>
    <span class="n">board</span> <span class="o">=</span> <span class="p">[[</span><span class="s">' '</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
    <span class="n">pieces</span> <span class="o">=</span> <span class="p">[</span><span class="s">'b'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">""" Initializes a TeekoPlayer object by randomly selecting red or black as its
        piece color.
        """</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">my_piece</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">pieces</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">opp</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">pieces</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">my_piece</span> <span class="o">==</span> <span class="bp">self</span><span class="p">.</span><span class="n">pieces</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="bp">self</span><span class="p">.</span><span class="n">pieces</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>    

    <span class="k">def</span> <span class="nf">GetPiecePos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">r</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="s">'b'</span><span class="p">:</span>
                    <span class="n">b</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">))</span>
                <span class="k">elif</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="s">'r'</span><span class="p">:</span>
                    <span class="n">r</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">b</span><span class="p">,</span><span class="n">r</span>

    <span class="c1"># check largest # pieces nearby
</span>    <span class="k">def</span> <span class="nf">heuristic_gv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">piece</span><span class="p">):</span>
        <span class="n">b</span><span class="p">,</span><span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">GetPiecePos</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">piece</span> <span class="o">==</span> <span class="s">'b'</span><span class="p">:</span>
            <span class="n">mine</span> <span class="o">=</span> <span class="s">'b'</span>
            <span class="n">oppo</span> <span class="o">=</span> <span class="s">'r'</span>
        <span class="k">elif</span> <span class="n">piece</span> <span class="o">==</span> <span class="s">'r'</span><span class="p">:</span>
            <span class="n">mine</span> <span class="o">=</span> <span class="s">'r'</span>
            <span class="n">oppo</span> <span class="o">=</span> <span class="s">'b'</span>

        <span class="c1"># horizontal
</span>        <span class="n">mymax</span> <span class="o">=</span> <span class="n">oppmax</span> <span class="o">=</span> <span class="n">mycnt</span> <span class="o">=</span> <span class="n">oppcnt</span> <span class="o">=</span> <span class="mi">0</span>        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">mine</span><span class="p">:</span>
                    <span class="n">mycnt</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">mycnt</span> <span class="o">&gt;</span> <span class="n">mymax</span><span class="p">:</span>
                <span class="n">mymax</span> <span class="o">=</span> <span class="n">mycnt</span>
            <span class="n">mycnt</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="n">i</span> <span class="o">=</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">oppo</span><span class="p">:</span>
                    <span class="n">oppcnt</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">oppcnt</span> <span class="o">&gt;</span> <span class="n">oppmax</span><span class="p">:</span>
                <span class="n">oppmax</span> <span class="o">=</span> <span class="n">oppcnt</span>
            <span class="n">oppcnt</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># vertical
</span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">state</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">mine</span><span class="p">:</span>
                    <span class="n">mycnt</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">mycnt</span> <span class="o">&gt;</span> <span class="n">mymax</span><span class="p">:</span>
                <span class="n">mymax</span> <span class="o">=</span> <span class="n">mycnt</span>
            <span class="n">mycnt</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="n">i</span> <span class="o">=</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">state</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">oppo</span><span class="p">:</span>
                    <span class="n">oppcnt</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">oppcnt</span> <span class="o">&gt;</span> <span class="n">oppmax</span><span class="p">:</span>
                <span class="n">oppmax</span> <span class="o">=</span> <span class="n">oppcnt</span>
            <span class="n">oppcnt</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># for / diagonal
</span>        <span class="n">mycnt</span> <span class="o">=</span> <span class="n">oppcnt</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">mine</span> <span class="ow">or</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">mine</span> <span class="ow">or</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span> <span class="o">-</span> <span class="mi">2</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">mine</span> <span class="ow">or</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span> <span class="o">-</span> <span class="mi">3</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">mine</span><span class="p">:</span>
                    <span class="n">mycnt</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">mycnt</span> <span class="o">&gt;</span> <span class="n">mymax</span><span class="p">:</span>
                    <span class="n">mymax</span> <span class="o">=</span> <span class="n">mycnt</span>
                <span class="n">mycnt</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">row</span> <span class="o">=</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">oppo</span> <span class="ow">or</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">oppo</span> <span class="ow">or</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span> <span class="o">-</span> <span class="mi">2</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">oppo</span> <span class="ow">or</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span> <span class="o">-</span> <span class="mi">3</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">oppo</span><span class="p">:</span>
                    <span class="n">oppcnt</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">oppcnt</span> <span class="o">&gt;</span> <span class="n">oppmax</span><span class="p">:</span>
                    <span class="n">oppmax</span> <span class="o">=</span> <span class="n">oppcnt</span>
                <span class="n">oppcnt</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># diagonal
</span>        <span class="n">mycnt</span> <span class="o">=</span> <span class="n">oppcnt</span> <span class="o">=</span> <span class="n">row</span> <span class="o">=</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">mine</span> <span class="ow">or</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">mine</span> <span class="ow">or</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span> <span class="o">+</span> <span class="mi">2</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">mine</span> <span class="ow">or</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span> <span class="o">+</span> <span class="mi">3</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">mine</span><span class="p">:</span>
                    <span class="n">mycnt</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">mycnt</span> <span class="o">&gt;</span> <span class="n">mymax</span><span class="p">:</span>
                    <span class="n">mymax</span> <span class="o">=</span> <span class="n">mycnt</span>
                <span class="n">mycnt</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">row</span> <span class="o">=</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">oppo</span> <span class="ow">or</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">oppo</span> <span class="ow">or</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span> <span class="o">+</span> <span class="mi">2</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">oppo</span> <span class="ow">or</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span> <span class="o">+</span> <span class="mi">3</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="n">oppo</span><span class="p">:</span>
                    <span class="n">oppcnt</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">oppcnt</span> <span class="o">&gt;</span> <span class="n">oppmax</span><span class="p">:</span>
                    <span class="n">oppmax</span> <span class="o">=</span> <span class="n">oppcnt</span>
                <span class="n">oppcnt</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># 2X2
</span>        <span class="n">mycnt</span> <span class="o">=</span> <span class="n">oppcnt</span> <span class="o">=</span> <span class="n">row</span> <span class="o">=</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">mine</span> <span class="ow">or</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">mine</span> <span class="ow">or</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">mine</span> <span class="ow">or</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">==</span> <span class="n">mine</span><span class="p">:</span>
                    <span class="n">mycnt</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">mycnt</span> <span class="o">&gt;</span> <span class="n">mymax</span><span class="p">:</span>
                    <span class="n">mymax</span> <span class="o">=</span> <span class="n">mycnt</span>
                <span class="n">mycnt</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">row</span> <span class="o">=</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">oppo</span> <span class="ow">or</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">oppo</span> <span class="ow">or</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">oppo</span> <span class="ow">or</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">==</span> <span class="n">oppo</span><span class="p">:</span>
                    <span class="n">oppcnt</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">oppcnt</span> <span class="o">&gt;</span> <span class="n">oppmax</span><span class="p">:</span>
                    <span class="n">oppmax</span> <span class="o">=</span> <span class="n">oppcnt</span>
                <span class="n">oppcnt</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="n">mymax</span> <span class="o">==</span> <span class="n">oppmax</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="n">state</span>
        <span class="k">elif</span> <span class="n">mymax</span> <span class="o">&gt;</span> <span class="n">oppmax</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">mymax</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span> <span class="n">state</span> <span class="c1"># if mine is longer than opponent, return positive float
</span>
        <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">oppmax</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span> <span class="n">state</span> <span class="c1"># if opponent is longer than mine, return negative float
</span>
    <span class="k">def</span> <span class="nf">Max_Value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">depth</span><span class="p">):</span>
        <span class="n">bstate</span> <span class="o">=</span> <span class="n">state</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">game_value</span><span class="p">(</span><span class="n">state</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">game_value</span><span class="p">(</span><span class="n">state</span><span class="p">),</span><span class="n">state</span>
        <span class="k">if</span> <span class="n">depth</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">heuristic_gv</span><span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="bp">self</span><span class="p">.</span><span class="n">my_piece</span><span class="p">)</span>
                
        <span class="n">a</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s">'-Inf'</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">succ</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">my_piece</span><span class="p">):</span>
            <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">Min_Value</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">depth</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">a</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">bstate</span> <span class="o">=</span> <span class="n">s</span>        
        
        <span class="k">return</span> <span class="n">a</span><span class="p">,</span> <span class="n">bstate</span>

    <span class="k">def</span> <span class="nf">Min_Value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span><span class="n">depth</span><span class="p">):</span>
        <span class="n">bstate</span> <span class="o">=</span> <span class="n">state</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">game_value</span><span class="p">(</span><span class="n">state</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">game_value</span><span class="p">(</span><span class="n">state</span><span class="p">),</span><span class="n">state</span>        
        <span class="k">if</span> <span class="n">depth</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">heuristic_gv</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">opp</span><span class="p">)</span>
    
        <span class="n">b</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s">'Inf'</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">succ</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">opp</span><span class="p">):</span>
            <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">Max_Value</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">depth</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">:</span>
                <span class="n">b</span> <span class="o">=</span> <span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">bstate</span> <span class="o">=</span> <span class="n">s</span>

        <span class="k">return</span> <span class="n">b</span><span class="p">,</span> <span class="n">bstate</span>
    
    <span class="k">def</span> <span class="nf">make_move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="s">""" Selects a (row, col) space for the next move. You may assume that whenever
        this function is called, it is this player's turn to move.

        Args:
            state (list of lists): should be the current state of the game as saved in
                this TeekoPlayer object. Note that this is NOT assumed to be a copy of
                the game state and should NOT be modified within this method (use
                place_piece() instead). Any modifications (e.g. to generate successors)
                should be done on a deep copy of the state.

                In the "drop phase", the state will contain less than 8 elements which
                are not ' ' (a single space character).

        Return:
            move (list): a list of move tuples such that its format is
                    [(row, col), (source_row, source_col)]
                where the (row, col) tuple is the location to place a piece and the
                optional (source_row, source_col) tuple contains the location of the
                piece the AI plans to relocate (for moves after the drop phase). In
                the drop phase, this list should contain ONLY THE FIRST tuple.

        Note that without drop phase behavior, the AI will just keep placing new markers
            and will eventually take over the board. This is not a valid strategy and
            will earn you no points.
        """</span>
        <span class="n">drop_phase</span> <span class="o">=</span> <span class="bp">True</span>   <span class="c1"># TODO: detect drop phase        
</span>        <span class="k">if</span> <span class="nb">sum</span><span class="p">((</span><span class="n">i</span><span class="p">.</span><span class="n">count</span><span class="p">(</span><span class="s">'b'</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">state</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="mi">4</span> <span class="ow">and</span> <span class="nb">sum</span><span class="p">((</span><span class="n">i</span><span class="p">.</span><span class="n">count</span><span class="p">(</span><span class="s">'r'</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">state</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">drop_phase</span> <span class="o">=</span> <span class="bp">False</span>                    
        <span class="k">if</span> <span class="ow">not</span> <span class="n">drop_phase</span><span class="p">:</span>
            <span class="c1"># TODO: choose a piece to move and remove it from the board
</span>            <span class="c1"># (You may move this condition anywhere, just be sure to handle it)
</span>            <span class="c1">#
</span>            <span class="c1"># Until this part is implemented and the move list is updated
</span>            <span class="c1"># accordingly, the AI will not follow the rules after the drop phase!
</span>            <span class="n">move</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">value</span><span class="p">,</span> <span class="n">bstate</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">Max_Value</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>            
            <span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">state</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">bstate</span><span class="p">)</span>
            <span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">where</span><span class="p">(</span><span class="n">arr1</span> <span class="o">==</span> <span class="bp">False</span><span class="p">)</span> <span class="c1"># check difference between succ and curr state
</span>            <span class="k">if</span> <span class="n">state</span><span class="p">[</span><span class="n">arr2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="n">arr2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">==</span> <span class="s">' '</span><span class="p">:</span> <span class="c1"># find original to define move
</span>                <span class="p">(</span><span class="n">origrow</span><span class="p">,</span> <span class="n">origcol</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">arr2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">].</span><span class="n">item</span><span class="p">(),</span><span class="n">arr2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">].</span><span class="n">item</span><span class="p">())</span>
                <span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">arr2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">].</span><span class="n">item</span><span class="p">(),</span> <span class="n">arr2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">].</span><span class="n">item</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="p">(</span><span class="n">origrow</span><span class="p">,</span> <span class="n">origcol</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">arr2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">].</span><span class="n">item</span><span class="p">(),</span> <span class="n">arr2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">].</span><span class="n">item</span><span class="p">())</span>
                <span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">arr2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">].</span><span class="n">item</span><span class="p">(),</span> <span class="n">arr2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">].</span><span class="n">item</span><span class="p">())</span>
            <span class="n">move</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">))</span>
            <span class="n">move</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">origrow</span><span class="p">,</span> <span class="n">origcol</span><span class="p">))</span>  <span class="c1"># move for after drop phase
</span>            <span class="k">return</span> <span class="n">move</span>

        <span class="c1"># select an unoccupied space randomly
</span>        <span class="c1"># TODO: implement a minimax algorithm to play better       
</span>        <span class="n">move</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">value</span><span class="p">,</span> <span class="n">bstate</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">Max_Value</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">state</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">bstate</span><span class="p">)</span>
        <span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">where</span><span class="p">(</span><span class="n">arr1</span> <span class="o">==</span> <span class="bp">False</span><span class="p">)</span> <span class="c1"># diff between succ and curr state        
</span>        <span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">arr2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">].</span><span class="n">item</span><span class="p">(),</span> <span class="n">arr2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">].</span><span class="n">item</span><span class="p">())</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="s">' '</span><span class="p">:</span> <span class="c1"># find original to define move
</span>            <span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">arr2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">].</span><span class="n">item</span><span class="p">(),</span> <span class="n">arr2</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">].</span><span class="n">item</span><span class="p">())</span>

        <span class="c1"># ensure the destination (row,col) tuple is at the beginning of the move list
</span>        <span class="n">move</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">))</span>              
        <span class="k">return</span> <span class="n">move</span>

    <span class="k">def</span> <span class="nf">succ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">piece</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">game_value</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>        
        <span class="n">succ</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">drop_phase</span> <span class="o">=</span> <span class="bp">True</span>  <span class="c1"># TODO: detect drop phase
</span>
        <span class="k">if</span> <span class="nb">sum</span><span class="p">((</span><span class="n">i</span><span class="p">.</span><span class="n">count</span><span class="p">(</span><span class="s">'b'</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">state</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="mi">4</span> <span class="ow">and</span> <span class="nb">sum</span><span class="p">((</span><span class="n">i</span><span class="p">.</span><span class="n">count</span><span class="p">(</span><span class="s">'r'</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">state</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">drop_phase</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">drop_phase</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="n">piece</span><span class="p">:</span>
                        <span class="n">succ</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">up</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">))</span>
                        <span class="n">succ</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">down</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">))</span>
                        <span class="n">succ</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">left</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">))</span>
                        <span class="n">succ</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">right</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">))</span>
                        <span class="n">succ</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">upleft</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">))</span>
                        <span class="n">succ</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">upright</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">))</span>
                        <span class="n">succ</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">downleft</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">))</span>
                        <span class="n">succ</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">downright</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">))</span>
            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">succ</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="p">)):</span>
                <span class="n">new</span> <span class="o">=</span> <span class="n">copy</span><span class="p">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">new</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="s">' '</span><span class="p">:</span>
                    <span class="n">new</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">piece</span>
                    <span class="n">succ</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">succ</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">up</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">copy</span><span class="p">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="s">' '</span><span class="p">:</span>
            <span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">state</span>

    <span class="k">def</span> <span class="nf">down</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">copy</span><span class="p">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="p">)</span> <span class="ow">and</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="s">' '</span><span class="p">:</span>
            <span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">state</span>

    <span class="k">def</span> <span class="nf">left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">copy</span><span class="p">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">' '</span><span class="p">:</span>
            <span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">state</span>

    <span class="k">def</span> <span class="nf">right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">copy</span><span class="p">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="p">)</span> <span class="ow">and</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">' '</span><span class="p">:</span>
            <span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">state</span>

    <span class="k">def</span> <span class="nf">upleft</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">copy</span><span class="p">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">' '</span><span class="p">:</span>
            <span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">state</span>

    <span class="k">def</span> <span class="nf">upright</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">copy</span><span class="p">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="p">)</span> <span class="ow">and</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">' '</span><span class="p">:</span>
            <span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">state</span>

    <span class="k">def</span> <span class="nf">downleft</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">copy</span><span class="p">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="p">)</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">' '</span><span class="p">:</span>
            <span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">state</span>

    <span class="k">def</span> <span class="nf">downright</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">copy</span><span class="p">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="p">)</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="p">)</span> <span class="ow">and</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">' '</span><span class="p">:</span>
            <span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">state</span>
        
    <span class="k">def</span> <span class="nf">opponent_move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">move</span><span class="p">):</span>
        <span class="s">""" Validates the opponent's next move against the internal board representation.
        You don't need to touch this code.

        Args:
            move (list): a list of move tuples such that its format is
                    [(row, col), (source_row, source_col)]
                where the (row, col) tuple is the location to place a piece and the
                optional (source_row, source_col) tuple contains the location of the
                piece the AI plans to relocate (for moves after the drop phase). In
                the drop phase, this list should contain ONLY THE FIRST tuple.
        """</span>
        <span class="c1"># validate input
</span>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">move</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">source_row</span> <span class="o">=</span> <span class="n">move</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">source_col</span> <span class="o">=</span> <span class="n">move</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">source_row</span> <span class="o">!=</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="p">.</span><span class="n">board</span><span class="p">[</span><span class="n">source_row</span><span class="p">][</span><span class="n">source_col</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="p">.</span><span class="n">opp</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">print_board</span><span class="p">()</span>
                <span class="k">print</span><span class="p">(</span><span class="n">move</span><span class="p">)</span>
                <span class="k">raise</span> <span class="nb">Exception</span><span class="p">(</span><span class="s">"You don't have a piece there!"</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">source_row</span> <span class="o">-</span> <span class="n">move</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">source_col</span> <span class="o">-</span> <span class="n">move</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">print_board</span><span class="p">()</span>
                <span class="k">print</span><span class="p">(</span><span class="n">move</span><span class="p">)</span>
                <span class="k">raise</span> <span class="nb">Exception</span><span class="p">(</span><span class="s">'Illegal move: Can only move to an adjacent space'</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">board</span><span class="p">[</span><span class="n">move</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="n">move</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">!=</span> <span class="s">' '</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nb">Exception</span><span class="p">(</span><span class="s">"Illegal move detected"</span><span class="p">)</span>
        <span class="c1"># make move
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">place_piece</span><span class="p">(</span><span class="n">move</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">opp</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">place_piece</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">move</span><span class="p">,</span> <span class="n">piece</span><span class="p">):</span>
        <span class="s">""" Modifies the board representation using the specified move and piece

        Args:
            move (list): a list of move tuples such that its format is
                    [(row, col), (source_row, source_col)]
                where the (row, col) tuple is the location to place a piece and the
                optional (source_row, source_col) tuple contains the location of the
                piece the AI plans to relocate (for moves after the drop phase). In
                the drop phase, this list should contain ONLY THE FIRST tuple.

                This argument is assumed to have been validated before this method
                is called.
            piece (str): the piece ('b' or 'r') to place on the board
        """</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">move</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">board</span><span class="p">[</span><span class="n">move</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="n">move</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="s">' '</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">board</span><span class="p">[</span><span class="n">move</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="n">move</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">piece</span>

    <span class="k">def</span> <span class="nf">print_board</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">""" Formatted printing for the board """</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">board</span><span class="p">)):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span><span class="o">+</span><span class="s">": "</span>
            <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">board</span><span class="p">[</span><span class="n">row</span><span class="p">]:</span>
                <span class="n">line</span> <span class="o">+=</span> <span class="n">cell</span> <span class="o">+</span> <span class="s">" "</span>
            <span class="k">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"   A B C D E"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">game_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="s">""" Checks the current board status for a win condition

        Args:
        state (list of lists): either the current state of the game as saved in
            this TeekoPlayer object, or a generated successor state.

        Returns:
            int: 1 if this TeekoPlayer wins, -1 if the opponent wins, 0 if no winner

        TODO: complete checks for diagonal and box wins
        """</span>
        <span class="c1"># check horizontal wins        
</span>        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">state</span><span class="p">:</span>            
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>                
                <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="s">' '</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">row</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">row</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">row</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]:</span>
                    <span class="k">return</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="bp">self</span><span class="p">.</span><span class="n">my_piece</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>

        <span class="c1"># check vertical wins
</span>        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">!=</span> <span class="s">' '</span> <span class="ow">and</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">][</span><span class="n">col</span><span class="p">]:</span>
                    <span class="k">return</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">col</span><span class="p">]</span><span class="o">==</span><span class="bp">self</span><span class="p">.</span><span class="n">my_piece</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>

        <span class="c1"># TODO: check \ diagonal wins
</span>        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="s">' '</span> <span class="ow">and</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span> <span class="o">+</span> <span class="mi">2</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span> <span class="o">+</span> <span class="mi">3</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]:</span>                    
                    <span class="k">return</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="p">.</span><span class="n">my_piece</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>

        <span class="c1"># TODO: check / diagonal wins
</span>        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="s">' '</span> <span class="ow">and</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span> <span class="o">-</span> <span class="mi">2</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span> <span class="o">-</span> <span class="mi">3</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]:</span>                    
                    <span class="k">return</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="p">.</span><span class="n">my_piece</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>

        <span class="c1"># TODO: check 2x2 box wins
</span>        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="s">' '</span> <span class="ow">and</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]:</span>                    
                    <span class="k">return</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">state</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="p">.</span><span class="n">my_piece</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>    
        <span class="k">return</span> <span class="mi">0</span> <span class="c1"># no winner yet
</span>
</code></pre></div></div>

<p>í´ë˜ìŠ¤ í•¨ìˆ˜ ì„¤ëª…:</p>
<ul>
  <li><em><strong>init</strong></em>: ëœë¤ìœ¼ë¡œ Red or Black ë§ˆì»¤ ê²°ì •</li>
  <li><em>GetPiecePos</em>: 5x5 ë³´ë“œíŒì—ì„œ ê° ë§ˆì»¤ì˜ ìœ„ì¹˜ë¥¼ ë¦¬ìŠ¤íŠ¸ë¡œ ê°€ì ¸ì˜¨ë‹¤.</li>
  <li><em>heuristic_gv</em>: ê²Œì„ ì„±ê³µ ì¡°ê±´ ë§Œì¡±ì‹œ ì¢…ë£Œ, otherwise Minimax íŠ¸ë¦¬ì—ì„œ í˜„ ë…¸ë“œ ê°’ê³¼ í˜„ state ë¦¬í„´</li>
  <li><em>Max_Value</em>: Minimax ì•Œê³ ë¦¬ì¦˜ì—ì„œ Max ê°’ì„ ë„ì¶œí•œë‹¤.</li>
  <li><em>Min_Value</em>: Minimax ì•Œê³ ë¦¬ì¦˜ì—ì„œ Min ê°’ì„ ë„ì¶œí•œë‹¤.</li>
  <li><em>make_move</em>: ìì‹ ì˜ ë§ˆì»¤ê°€ ë‹¤ìŒìœ¼ë¡œ ì›€ì§ì¼ ì§€ì ì˜ row, col ê°’ì„ ê°€ì ¸ì˜¨ë‹¤.</li>
  <li><em>succ</em>: ë‹¤ìŒ ì›€ì§ì¼ ê²½ìš°ë“¤ì˜ ì§‘í•©
    <ul>
      <li>ê¶ê·¹ì ìœ¼ë¡œ, ìµœì„ ì˜ ë‹¤ìŒ ì›€ì§ì„ ì„ íƒì„ í•˜ê¸° ìœ„í•¨.</li>
    </ul>
  </li>
  <li><em>up, down, â€¦, downright</em>: í•´ë‹¹ ë°©í–¥ìœ¼ë¡œ ë§ˆì»¤ ì›€ì§ì„</li>
  <li><em>opponent_move</em>: ìƒëŒ€ë°©(AI)ì˜ ë§ˆì»¤ê°€ ë‹¤ìŒìœ¼ë¡œ ì›€ì§ì¼ ì§€ì ì˜ row col ê°’ì„ ê°€ì ¸ì˜¨ë‹¤.</li>
  <li><em>place_piece</em>: í•´ë‹¹ ì§€ì ìœ¼ë¡œ ì£¼ì–´ì§„ ë§ˆì»¤ë¥¼ ì‹¤ì œë¡œ ì´ë™ì‹œí‚¨ë‹¤.</li>
  <li><em>print_board</em>: ë³´ë“œíŒ í˜„í™© ì¶œë ¥</li>
  <li><em>game_value</em>: ê²Œì„ ì„±ê³µ ì¡°ê±´ ë§Œì¡± ì—¬ë¶€ íŒë‹¨</li>
</ul>

<h1 id="teeko-ê²Œì„-ì‹¤í–‰-í•¨ìˆ˜">Teeko ê²Œì„ ì‹¤í–‰ í•¨ìˆ˜</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Hello, this is Samaritan'</span><span class="p">)</span>
    <span class="n">ai</span> <span class="o">=</span> <span class="n">TeekoPlayer</span><span class="p">()</span>
    <span class="n">piece_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">turn</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># drop phase
</span>    <span class="k">while</span> <span class="n">piece_count</span> <span class="o">&lt;</span> <span class="mi">8</span> <span class="ow">and</span> <span class="n">ai</span><span class="p">.</span><span class="n">game_value</span><span class="p">(</span><span class="n">ai</span><span class="p">.</span><span class="n">board</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

        <span class="c1"># get the player or AI's move
</span>        <span class="k">if</span> <span class="n">ai</span><span class="p">.</span><span class="n">my_piece</span> <span class="o">==</span> <span class="n">ai</span><span class="p">.</span><span class="n">pieces</span><span class="p">[</span><span class="n">turn</span><span class="p">]:</span> <span class="c1"># ai í„´ì¼ ê²½ìš°
</span>            <span class="n">ai</span><span class="p">.</span><span class="n">print_board</span><span class="p">()</span> <span class="c1"># í˜„ ë³´ë“œíŒ í˜„í™©
</span>            <span class="n">move</span> <span class="o">=</span> <span class="n">ai</span><span class="p">.</span><span class="n">make_move</span><span class="p">(</span><span class="n">ai</span><span class="p">.</span><span class="n">board</span><span class="p">)</span> <span class="c1"># ai í˜„ ë³´ë“œ ìœ„ì¹˜ì—ì„œ ë‹¤ìŒ ìœ„ì¹˜ ì–»ê¸°
</span>            <span class="n">ai</span><span class="p">.</span><span class="n">place_piece</span><span class="p">(</span><span class="n">move</span><span class="p">,</span> <span class="n">ai</span><span class="p">.</span><span class="n">my_piece</span><span class="p">)</span> <span class="c1"># ë‹¤ìŒ ìœ„ì¹˜ë¡œ ì´ë™í•˜ê¸°
</span>            <span class="k">print</span><span class="p">(</span><span class="n">ai</span><span class="p">.</span><span class="n">my_piece</span><span class="o">+</span><span class="s">" moved at "</span><span class="o">+</span><span class="nb">chr</span><span class="p">(</span><span class="n">move</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="nb">ord</span><span class="p">(</span><span class="s">"A"</span><span class="p">))</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">move</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">move_made</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">ai</span><span class="p">.</span><span class="n">print_board</span><span class="p">()</span>
            <span class="k">print</span><span class="p">(</span><span class="n">ai</span><span class="p">.</span><span class="n">opp</span><span class="o">+</span><span class="s">"'s turn"</span><span class="p">)</span>
            <span class="k">while</span> <span class="ow">not</span> <span class="n">move_made</span><span class="p">:</span> <span class="c1"># í”Œë ˆì´ì–´ í„´
</span>                <span class="n">player_move</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Move (e.g. B3): "</span><span class="p">)</span>
                <span class="k">while</span> <span class="n">player_move</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s">"ABCDE"</span> <span class="ow">or</span> <span class="n">player_move</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s">"01234"</span><span class="p">:</span>
                    <span class="n">player_move</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Move (e.g. B3): "</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">ai</span><span class="p">.</span><span class="n">opponent_move</span><span class="p">([(</span><span class="nb">int</span><span class="p">(</span><span class="n">player_move</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">ord</span><span class="p">(</span><span class="n">player_move</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="nb">ord</span><span class="p">(</span><span class="s">"A"</span><span class="p">))])</span> <span class="c1"># aiì˜ opponentëŠ” í”Œë ˆì´ì–´ì´ë¯€ë¡œ, í”Œë ˆì´ì–´ ë§ˆì»¤ë¥¼ ì›€ì§ì¸ë‹¤.
</span>                    <span class="n">move_made</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

        <span class="c1"># update the game variables
</span>        <span class="n">piece_count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">turn</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">turn</span> <span class="o">%=</span> <span class="mi">2</span>

    <span class="c1"># move phase - can't have a winner until all 8 pieces are on the board
</span>    <span class="k">while</span> <span class="n">ai</span><span class="p">.</span><span class="n">game_value</span><span class="p">(</span><span class="n">ai</span><span class="p">.</span><span class="n">board</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

        <span class="c1"># get the player or AI's move
</span>        <span class="k">if</span> <span class="n">ai</span><span class="p">.</span><span class="n">my_piece</span> <span class="o">==</span> <span class="n">ai</span><span class="p">.</span><span class="n">pieces</span><span class="p">[</span><span class="n">turn</span><span class="p">]:</span>
            <span class="n">ai</span><span class="p">.</span><span class="n">print_board</span><span class="p">()</span>
            <span class="n">move</span> <span class="o">=</span> <span class="n">ai</span><span class="p">.</span><span class="n">make_move</span><span class="p">(</span><span class="n">ai</span><span class="p">.</span><span class="n">board</span><span class="p">)</span>
            <span class="n">ai</span><span class="p">.</span><span class="n">place_piece</span><span class="p">(</span><span class="n">move</span><span class="p">,</span> <span class="n">ai</span><span class="p">.</span><span class="n">my_piece</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="n">ai</span><span class="p">.</span><span class="n">my_piece</span><span class="o">+</span><span class="s">" moved from "</span><span class="o">+</span><span class="nb">chr</span><span class="p">(</span><span class="n">move</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="nb">ord</span><span class="p">(</span><span class="s">"A"</span><span class="p">))</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">move</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"  to "</span><span class="o">+</span><span class="nb">chr</span><span class="p">(</span><span class="n">move</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="nb">ord</span><span class="p">(</span><span class="s">"A"</span><span class="p">))</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">move</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">move_made</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">ai</span><span class="p">.</span><span class="n">print_board</span><span class="p">()</span>
            <span class="k">print</span><span class="p">(</span><span class="n">ai</span><span class="p">.</span><span class="n">opp</span><span class="o">+</span><span class="s">"'s turn"</span><span class="p">)</span>
            <span class="k">while</span> <span class="ow">not</span> <span class="n">move_made</span><span class="p">:</span>
                <span class="n">move_from</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Move from (e.g. B3): "</span><span class="p">)</span>
                <span class="k">while</span> <span class="n">move_from</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s">"ABCDE"</span> <span class="ow">or</span> <span class="n">move_from</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s">"01234"</span><span class="p">:</span>
                    <span class="n">move_from</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Move from (e.g. B3): "</span><span class="p">)</span>
                <span class="n">move_to</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Move to (e.g. B3): "</span><span class="p">)</span>
                <span class="k">while</span> <span class="n">move_to</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s">"ABCDE"</span> <span class="ow">or</span> <span class="n">move_to</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s">"01234"</span><span class="p">:</span>
                    <span class="n">move_to</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Move to (e.g. B3): "</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">ai</span><span class="p">.</span><span class="n">opponent_move</span><span class="p">([(</span><span class="nb">int</span><span class="p">(</span><span class="n">move_to</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">ord</span><span class="p">(</span><span class="n">move_to</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="nb">ord</span><span class="p">(</span><span class="s">"A"</span><span class="p">)),</span>
                                    <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">move_from</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">ord</span><span class="p">(</span><span class="n">move_from</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="nb">ord</span><span class="p">(</span><span class="s">"A"</span><span class="p">))])</span>
                    <span class="n">move_made</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

        <span class="c1"># update the game variables
</span>        <span class="n">turn</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">turn</span> <span class="o">%=</span> <span class="mi">2</span>

    <span class="n">ai</span><span class="p">.</span><span class="n">print_board</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ai</span><span class="p">.</span><span class="n">game_value</span><span class="p">(</span><span class="n">ai</span><span class="p">.</span><span class="n">board</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"AI wins! Game over."</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"You win! Game over."</span><span class="p">)</span>
</code></pre></div></div>

<p>ìƒê¸° ì½”ë“œ ì—­ì‹œ ì£¼ì„ìœ¼ë¡œ ì„¤ëª…ì„ ì¶”ê°€í–ˆì§€ë§Œ ì£¼ìš” ë¶€ë¶„ë§Œ ëœ¯ì–´ë‚´ì„œ ì‚´í´ë³´ì.</p>

<p>â€˜while piece_count &lt; 8 and ai.game_value(ai.board) == 0:â€™</p>
<ul>
  <li>ë³´ë“œíŒì— ë†“ì¸ ë§ˆì»¤ ê°œìˆ˜ê°€ 8ê°œ ì´ìƒì´ê±°ë‚˜ ëˆ„êµ°ê°€ ì„±ê³µ ì¡°ê±´ì„ ë‹¬ì„±í–ˆë‹¤ë©´ ì¢…ë£Œí•œë‹¤.</li>
</ul>

<p>â€˜while ai.game_value(ai.board) == 0:â€™</p>
<ul>
  <li>ë§Œì•½, ë³´ë“œíŒì— 8ê°œ ì´ìƒì˜ ë§ˆì»¤ê°€ ë†“ì˜€ëŠ”ë°ë„ ìŠ¹ì ì¡°ê±´ì´ ë§Œì¡±ëœ ì¸¡ì´ ì—†ì„ ê²½ìš° ì‹¤í–‰ë˜ëŠ” ë¶€ë¶„ì´ë‹¤.</li>
</ul>

<h1 id="ê²Œì„-ì‹¤í–‰">ê²Œì„ ì‹¤í–‰</h1>

<p>í•˜ê¸° ì½”ë“œë¥¼ í†µí•´ ê°„ë‹¨íˆ ê²Œì„ ì‹¤í–‰ì´ ê°€ëŠ¥í•˜ë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">main</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/39285147/184557144-b8d13395-4364-43d4-a312-6a4982288b0c.png" alt="image" /></p>

<p>ê²Œì„ ì‹¤í–‰ ì‹œ ì½˜ì†” í™˜ê²½ì—ì„œ ì…ë ¥ê°’ì„ ì…ë ¥í•˜ë©° ê²Œì„ ì§„í–‰ì´ ê°€ëŠ¥í•˜ë‹¤.</p>

<p>ì…ë ¥ê°’ìœ¼ë¡œ ABCDE ì—´ ì¤‘ì—ì„œ í•˜ë‚˜ë¥¼ íƒí•˜ê³  row indexë¥¼ ìˆ«ìë¡œ ì¡°í•©í•´ì„œ ì ì–´ì£¼ë©´ ëœë‹¤ (i.e., â€˜B3â€™ Bì—´ì˜ 4ë²ˆ ì§¸ rowì— ë§ˆì»¤ë¥¼ ë†“ëŠ”ë‹¤).</p>

<table>
  <tbody>
    <tr>
      <td>í•˜ê¸° ì‚¬ì§„ì²˜ëŸ¼ B3ì„ ì…ë ¥í•˜ë©´ ë³´ë“œíŒì´ ê°±ì‹ ëœë‹¤ (***RED: AI</td>
      <td>BLACK: í”Œë ˆì´ì–´***)</td>
    </tr>
  </tbody>
</table>

<p><img src="https://user-images.githubusercontent.com/39285147/184557947-90aad7de-ffb6-413f-8e40-bf2fdca30b35.png" alt="image" /></p>

<p>ëª‡ ì´ˆê°€ ì§€ë‚˜ë©´ AIê°€ ìë™ì ìœ¼ë¡œ ìµœì ì˜ ì„ íƒì„ í•˜ë©´ì„œ ë§ˆì»¤ë¥¼ ë†“ëŠ”ë‹¤ (í•˜ê¸° ì‚¬ì§„ ì°¸ì¡°).</p>

<p><img src="https://user-images.githubusercontent.com/39285147/184558029-c985a2b0-cd15-40f0-abaf-4a67492290aa.png" alt="image" /></p>

<p>ë‚´ê°€ ì´ìƒí•œ ê³³ì— ë§ˆì»¤ë¥¼ ë†“ì•„ì„œ, AIê°€ ê°€ì¥ ë¹ ë¥´ê²Œ ì„±ê³µ ì¡°ê±´ì„ ì™„ì„±ì‹œí‚¬ ìˆ˜ ìˆëŠ” ëŒ€ê°ì„  ë°©í–¥ìœ¼ë¡œ RED ë§ˆì»¤ë¥¼ ë†“ê³ ìˆë‹¤.</p>

<p>ê°ì ê²Œì„ ì§„í–‰ì„ í•´ë³´ë©´ì„œ ì½”ë“œ ë˜í•œ ë‹¤ì‹œ í•œ ë²ˆ ìˆ™ì§€í•´ë³´ê¸¸ ë°”ë€ë‹¤.</p>]]></content><author><name>ì­ŒìŠ¤ğŸ„</name></author><category term="Others" /><category term="Machine Learning" /><category term="Teeko Board Game" /><category term="Minimax" /><summary type="html"><![CDATA[Minimax ì•Œê³ ë¦¬ì¦˜ì„ í™œìš©í•´ì„œ Teeko ê²Œì„ì„ êµ¬í˜„í•œë‹¤.]]></summary></entry><entry><title type="html">Reinforcement Learning - Q-Learning ì•Œê³ ë¦¬ì¦˜</title><link href="http://localhost:4000/rl/ml-reinforcement-learning-q-learning/" rel="alternate" type="text/html" title="Reinforcement Learning - Q-Learning ì•Œê³ ë¦¬ì¦˜" /><published>2022-08-14T00:00:00+09:00</published><updated>2022-08-14T00:00:00+09:00</updated><id>http://localhost:4000/rl/ml-reinforcement-learning-q-learning</id><content type="html" xml:base="http://localhost:4000/rl/ml-reinforcement-learning-q-learning/"><![CDATA[<p><strong>Q-Learning ì•Œê³ ë¦¬ì¦˜</strong>ì„ í™œìš©í•œ ì˜ˆì œì´ë‹¤.</p>

<p>ì´ í”„ë¡œì íŠ¸ëŠ” Q-Learning ì•Œê³ ë¦¬ì¦˜ì„ ì´í•´í•˜ê³  ìˆë‹¤ëŠ” ì „ì œë¡œ ì§„í–‰í•œë‹¤.</p>

<h1 id="code">Code</h1>
<p class="notice--danger"><strong>[Notice]</strong> <a href="https://github.com/hchoi256/cs540-AI/tree/main/reinforcement-learning-qlearning">download here</a></p>]]></content><author><name>ì­ŒìŠ¤ğŸ„</name></author><category term="RL" /><category term="Reinforcement Learning" /><category term="Q-learning" /><summary type="html"><![CDATA[Q-Learning ì•Œê³ ë¦¬ì¦˜ì„ í™œìš©í•œ ì˜ˆì œì´ë‹¤.]]></summary></entry><entry><title type="html">PCA - Image Compression(ì´ë¯¸ì§€ ì••ì¶•)</title><link href="http://localhost:4000/usl/ml-pca/" rel="alternate" type="text/html" title="PCA - Image Compression(ì´ë¯¸ì§€ ì••ì¶•)" /><published>2022-08-14T00:00:00+09:00</published><updated>2022-08-14T00:00:00+09:00</updated><id>http://localhost:4000/usl/ml-pca</id><content type="html" xml:base="http://localhost:4000/usl/ml-pca/"><![CDATA[<p>PCAë¥¼ ì´ìš©í•´ì„œ ì´ë¯¸ì§€ ì••ì¶•ì„ ì§„í–‰í•´ë³´ì.</p>

<h1 id="code">Code</h1>
<p class="notice--danger"><strong>[Notice]</strong> <a href="https://github.com/hchoi256/cs540-AI/tree/main/PCA">download here</a></p>

<p>ì´ë²ˆ í”„ë¡œì íŠ¸ëŠ” <strong>PCA</strong>ë¥¼ í™œìš©í•´ì„œ <strong>ì´ë¯¸ì§€ ì••ì¶•</strong> ë¬¸ì œë¥¼ í•´ê²°í•œë‹¤.</p>

<p>ì´ë¡ ì ìœ¼ë¡œ PCAì˜ ê°œë…ì„ ì´í•´í•˜ê³  ìˆë‹¤ëŠ” ì „ì œë¡œ í”„ë¡œì íŠ¸ë¥¼ ìˆ˜í–‰í•œë‹¤.</p>

<blockquote>
  <p><a href="https://github.com/hchoi256/ai-terms/blob/main/README.md">PCA</a> ê°œë… ìˆ™ì§€ëŠ” ì—¬ê¸°!</p>
</blockquote>

<h1 id="ë°ì´í„°-ë¶ˆëŸ¬ì˜¤ê¸°">ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">scipy.linalg</span> <span class="kn">import</span> <span class="n">eigh</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">load_and_center_dataset</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">dc</span> <span class="o">=</span> <span class="n">f</span> <span class="o">-</span> <span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># ì •ê·œí™”
</span>    <span class="k">return</span> <span class="n">dc</span>
</code></pre></div></div>

<h1 id="ê³µë¶„ì‚°-í–‰ë ¬-êµ¬í•˜ê¸°">ê³µë¶„ì‚° í–‰ë ¬ êµ¬í•˜ê¸°</h1>

<p><img src="https://user-images.githubusercontent.com/39285147/184553498-b0da1938-a6d9-4ad1-b8f9-8c127c7cfbe7.png" alt="image" /></p>

<p><strong>ê³µë¶„ì‚°</strong>ì€ <strong>ë°ì´í„° ë¶„í¬ì— ëŒ€í•œ íŠ¹ì§•</strong>ì„ í¬í•¨í•˜ëŠ” í–‰ë ¬ì´ë‹¤.</p>

<blockquote>
  <p>ë³´ë‹¤ ìì„¸í•œ ì •ë³´ëŠ” <a href="https://github.com/hchoi256/ai-terms/blob/main/README.md">ì—¬ê¸°</a>ë¥¼ ì°¸ì¡°í•˜ì.</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">get_covariance</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">dataset</span><span class="p">),</span> <span class="n">dataset</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="ê³ ìœ ê°’-ë¶„í•´eigendecomposition">ê³ ìœ ê°’ ë¶„í•´(Eigendecomposition)</h1>

<p>ê³ ìœ ê°’ ë¶„í•´ëŠ” ì •ë°©í–‰ë ¬ì„ ëŒ€ìƒìœ¼ë¡œ ì ìš©í•  ìˆ˜ ìˆëŠ” ê¸°ë²•ì´ë‹¤.</p>

<p>ë§Œì•½ ìš°ë¦¬ê°€ ë‹¤ë£¨ëŠ” í–‰ë ¬ì´ <strong>ì •ë°©í–‰ë ¬</strong>ì´ ì•„ë‹Œ <strong>ì§ê°í–‰ë ¬</strong>ì´ë¼ë©´ ê³ ìœ ê°’ ë¶„í•´ëŒ€ì‹  <strong>íŠ¹ì´ê°’ ë¶„í•´(singular value decomposition)</strong>ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.</p>

<blockquote>
  <p>ì´ ë˜í•œ ë³´ë‹¤ ìì„¸í•œ ì •ë³´ëŠ” <a href="https://github.com/hchoi256/ai-terms/blob/main/README.md">ì—¬ê¸°</a>ë¥¼ ì°¸ì¡°í•˜ì.</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">get_eig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">eigh</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">subset_by_index</span><span class="o">=</span><span class="p">[</span><span class="n">d</span><span class="o">-</span><span class="n">m</span><span class="p">,</span> <span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># get largest m eigen-values/vectors
</span>    <span class="n">eigh_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="n">eigh_dict</span><span class="p">[</span><span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="c1"># save columns of eigenvectors
</span>    <span class="n">wsrt</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">sort</span><span class="p">(</span><span class="n">w</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># eigenvalues in decreasing order
</span>    <span class="n">vsrt</span> <span class="o">=</span> <span class="n">v</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="n">vsrt</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">eigh_dict</span><span class="p">[</span><span class="n">wsrt</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="c1"># rearrangement
</span>    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">diag</span><span class="p">(</span><span class="n">wsrt</span><span class="p">),</span> <span class="n">vsrt</span>
</code></pre></div></div>

<p>íŒŒì´ì¬ì—ì„œëŠ” â€˜<em>scipy.linalg import eigh</em>â€˜ë¥¼ í™œìš©í•´ì„œ ì†ì‰½ê²Œ ê³ ìœ ê°’ ë¶„í•´ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.</p>

<p>í•´ë‹¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ â€˜eighâ€™ í•¨ìˆ˜ë¥¼ í†µí•´ ê³ ìœ ê°’ê³¼ ê³ ìœ ë²¡í„°ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.</p>
<ul>
  <li>â€˜<em>subset_by_index</em>â€™: ë¶ˆëŸ¬ì˜¤ëŠ” ê³ ìœ ê°’ê³¼ ê³ ìœ ë²¡í„° ìˆ˜ë¥¼ ì§€ì •í•œë‹¤.</li>
</ul>

<p>ê³µë¶„ì‚° í–‰ë ¬ì— ê³ ìœ ê°’ ë¶„í•´ë¥¼ ì·¨í•˜ì—¬ ì–»ëŠ” ê³ ìœ ë²¡í„°ë“¤ ì¤‘ì—ì„œ <strong>ê·¸ í¬ê¸°ê°€ ê°€ì¥ í° ë²¡í„°ë“¤ì€ ë°ì´í„° ë¶„í¬ì—ì„œ ë¶„ì‚°ì„ ê°€ì¥ í¬ê²Œ ë§Œë“œëŠ” ì¶•ì— ëŒ€í•œ ì£¼ì„±ë¶„ ë²¡í„°</strong>ì´ë‹¤.</p>

<p>ì°¨ì›ì¶•ì†Œ ê³¼ì •ì—ì„œ, ë¶„ì‚°ì„ ê°€ì¥ í¬ê²Œ ë§Œë“œëŠ” ì£¼ì„±ë¶„ë“¤ ìœ„ë¡œ ë°ì´í„°ë¥¼ íˆ¬ì˜ì‹œí‚¤ë©´, ì°¨ì›ì´ ì¤„ì–´ë“¦ì— ë”°ë¼ ì†Œì‹¤ë˜ë©´ ì •ë³´ë¥¼ ìµœì†Œí™”í•  ìˆ˜ ìˆë‹¤.</p>

<blockquote>
  <p>ë³´ë‹¤ ìì„¸í•œ ì •ë³´ëŠ” <a href="https://github.com/hchoi256/ai-terms/blob/main/README.md">ì—¬ê¸°</a>ë¥¼ ì°¸ì¡°í•˜ì.</p>
</blockquote>

<p>ë”°ë¼ì„œ, ìš°ë¦¬ëŠ” m(ì••ì¶•í•˜ê³ ì í•˜ëŠ” ì´ë¯¸ì§€ ì°¨ì› ê°œìˆ˜)ê°œì˜ ê³ ìœ ë²¡í„°ë¥¼ ê°€ì ¸ì™€ì„œ ì¶•ì†Œë¥¼ ì§„í–‰í•œë‹¤.</p>

<p>â€˜get_eigâ€™ì˜ ì¶œë ¥ê°’ì€ ê° ê³ ìœ ë²¡í„°ì˜ <strong>í¬ê¸°ê°€ í° ìˆœì„œë¡œ</strong> ê³ ìœ ê°’ì„ ì •ë ¬í•œ ëŒ€ê°í–‰ë ¬ê³¼ ì´ì— ìƒì‘í•˜ëŠ” ê³ ìœ ë²¡í„°ë¥¼ returní•œë‹¤.</p>

<p>ì¶”ê°€ì ìœ¼ë¡œ, í•˜ê¸° â€˜get_eig_propâ€™ëŠ” ì••ì¶•í•˜ê³ ì í•˜ëŠ” ì´ë¯¸ì§€ í•´ìƒë„ í¬ê¸°ë¥¼ ì…ë ¥ìœ¼ë¡œ ë°›ëŠ” ê²ƒì´ ì•„ë‹Œ <strong>ì–´ëŠ ì •ë„ ë¹„ìœ¨ë¡œ ì´ë¯¸ì§€ë¥¼ ì••ì¶•í•  ê²ƒì¸ì§€</strong>ë¥¼ ì¸í’‹ìœ¼ë¡œ ë°›ëŠ” í•¨ìˆ˜ì´ë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">get_eig_prop</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">perc</span><span class="p">):</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">eigh</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
    <span class="n">wsum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">eigh</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">subset_by_value</span><span class="o">=</span><span class="p">[</span><span class="n">perc</span> <span class="o">*</span> <span class="n">wsum</span><span class="p">,</span> <span class="n">wsum</span><span class="p">])</span>
    <span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
    <span class="n">eigh_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="n">eigh_dict</span><span class="p">[</span><span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span>
    <span class="n">wsrt</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">sort</span><span class="p">(</span><span class="n">w</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># eigenvalues in decreasing order
</span>    <span class="n">vsrt</span> <span class="o">=</span> <span class="n">v</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="n">vsrt</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">eigh_dict</span><span class="p">[</span><span class="n">wsrt</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="c1"># rearrangement
</span>    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">diag</span><span class="p">(</span><span class="n">wsrt</span><span class="p">),</span> <span class="n">vsrt</span>
</code></pre></div></div>

<h1 id="ì°¨ì›ì¶•ì†Œ-íˆ¬ì˜projection">ì°¨ì›ì¶•ì†Œ: íˆ¬ì˜(projection)</h1>

<p>ìœ„ì—ì„œ íˆ¬ì˜ì‹œì¼œì•¼í•  ì¶•ë“¤ì„ êµ¬í•´ëƒˆìœ¼ë‹ˆ, ì‹¤ì§ˆì ìœ¼ë¡œ ë°ì´í„°ë¥¼ ê·¸ ì¶•ë“¤ì— íˆ¬ì˜ì‹œí‚¤ë©´ì„œ ì°¨ì›ì„ ì¶•ì†Œí•´ë³´ì.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">project_image</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">U</span><span class="p">):</span>
    <span class="nb">sum</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">img</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># img.shape: (1024,)
</span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">U</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span> <span class="c1"># U.shape: (1024, 2)
</span>        <span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">U</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="n">img</span><span class="p">)</span>
        <span class="nb">sum</span> <span class="o">+=</span> <span class="n">np</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">U</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="nb">sum</span>
</code></pre></div></div>

<p>â€˜np.zeros(img.shape[0])â€™ëŠ” ì›ë³¸ ì´ë¯¸ì§€ì˜ í¬ê¸°ë§Œí¼ì˜ ë°°ì—´ì„ ìƒì„±í•˜ê³ , ê·¸ ê°’ë“¤ì€ ì „ë¶€ 0ìœ¼ë¡œ ì´ˆê¸°í™”í•œë‹¤.</p>

<p>â€˜U.shape[1]â€™ëŠ” ìš°ë¦¬ê°€ íˆ¬ì˜ì‹œí‚¬ ì°¨ì›(= ì£¼ì„±ë¶„)ë“¤ì— ëŒ€í•œ ë²¡í„°ì˜ ê°œìˆ˜ì´ë‹¤.</p>
<ul>
  <li>â€˜U.shape[0]â€™ëŠ” ì›ë³¸ ì´ë¯¸ì§€ì˜ í•´ìƒë„ì¸ 1024(32x32)ì˜ ê°’ì„ ê°–ëŠ”ë‹¤.</li>
</ul>

<p>[<em>íˆ¬ì˜(Projection) ê³µì‹</em>]</p>

<p><img src="https://user-images.githubusercontent.com/39285147/184554057-7c2d4211-c7af-4c22-8e5d-37f157b54a48.png" alt="image" />
<img src="https://user-images.githubusercontent.com/39285147/184554076-25f700e4-e27f-4286-94dd-7254505d4f4b.png" alt="image" /></p>

<ul>
  <li>uë“¤ì€ ê³ ìœ ë²¡í„°ë“¤ ë§í•œë‹¤.</li>
  <li>xë“¤ì€ ì›ë³¸ ì´ë¯¸ì§€ ë°ì´í„°ì´ë‹¤.</li>
  <li>m: íˆ¬ì˜ì‹œí‚¬ ì°¨ì› ê°œìˆ˜(= ìµœì¢… í•´ìƒë„ í¬ê¸°)</li>
</ul>

<h1 id="ì‹œê°í™”-ì›ë³¸-ì´ë¯¸ì§€ì™€-ë¹„êµ">ì‹œê°í™”: ì›ë³¸ ì´ë¯¸ì§€ì™€ ë¹„êµ</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">display_image</span><span class="p">(</span><span class="n">orig</span><span class="p">,</span> <span class="n">proj</span><span class="p">):</span>
    <span class="c1"># reshape the images to be 32 x 32
</span>    <span class="n">org</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">orig</span><span class="p">,</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span><span class="mi">32</span><span class="p">),</span> <span class="n">order</span> <span class="o">=</span> <span class="s">'F'</span><span class="p">)</span>
    <span class="n">prj</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span><span class="mi">32</span><span class="p">),</span> <span class="n">order</span> <span class="o">=</span> <span class="s">'F'</span><span class="p">)</span>
    <span class="c1"># create a figure with one row of two subplots
</span>    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="c1"># title the subplots
</span>    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">set_title</span><span class="p">(</span><span class="s">'Original'</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">set_title</span><span class="p">(</span><span class="s">'Projection'</span><span class="p">)</span>
    <span class="c1"># adjust aspect ratio
</span>    <span class="n">ax0</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">imshow</span><span class="p">(</span><span class="n">org</span><span class="p">,</span><span class="n">aspect</span> <span class="o">=</span> <span class="s">'equal'</span><span class="p">)</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">imshow</span><span class="p">(</span><span class="n">prj</span><span class="p">,</span><span class="n">aspect</span> <span class="o">=</span> <span class="s">'equal'</span><span class="p">)</span>
    <span class="c1"># create a colorbar for each image
</span>    <span class="n">fig</span><span class="p">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ax0</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">fig</span><span class="p">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<h1 id="ê²°ê³¼">ê²°ê³¼</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">load_and_center_dataset</span><span class="p">(</span><span class="s">'&lt;ì´ë¯¸ì§€ íŒŒì¼&gt;.npy'</span><span class="p">)</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">get_covariance</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">Lambda</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">get_eig</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">projection</span> <span class="o">=</span> <span class="n">project_image</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">U</span><span class="p">)</span>
<span class="n">display_image</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">projection</span><span class="p">)</span>
</code></pre></div></div>

<p>ìƒê¸° ì½”ë“œë¥¼ í†µí•´ ì†ì‰½ê²Œ ì›ë³¸ ì´ë¯¸ì§€ì™€ ì••ì¶•ëœ ì´ë¯¸ì§€ë¥¼ ë¹„êµí•´ë³´ì.</p>

<p><img src="https://user-images.githubusercontent.com/39285147/184554368-15a426d7-fd5c-4838-97d6-2b13b820149c.png" alt="image" /></p>]]></content><author><name>ì­ŒìŠ¤ğŸ„</name></author><category term="USL" /><category term="PCA" /><category term="Image Compression" /><summary type="html"><![CDATA[PCAë¥¼ ì´ìš©í•´ì„œ ì´ë¯¸ì§€ ì••ì¶•ì„ ì§„í–‰í•´ë³´ì.]]></summary></entry><entry><title type="html">Hierarchical Agglomerate Clustering(HAC) - í¬ì¼“ëª¬ êµ°ì§‘í™”</title><link href="http://localhost:4000/usl/ml-hca/" rel="alternate" type="text/html" title="Hierarchical Agglomerate Clustering(HAC) - í¬ì¼“ëª¬ êµ°ì§‘í™”" /><published>2022-08-14T00:00:00+09:00</published><updated>2022-08-14T00:00:00+09:00</updated><id>http://localhost:4000/usl/ml-hca</id><content type="html" xml:base="http://localhost:4000/usl/ml-hca/"><![CDATA[<p>Hierarchical Agglomerate Clustering(HAC) ì´ìš©í•´ì„œ ì„œë¡œ ë‹¤ë¥¸ íŠ¹ì„±ì„ ê³µìœ í•˜ëŠ” Pokemonë“¤ì„ êµ°ì§‘ìœ¼ë¡œ ë¬¶ì–´ë³´ì.</p>

<p>â€˜Pokemon.csvâ€™ëŠ” ì˜¨ë¼ì¸ì—ì„œ ì†ì‰½ê²Œ êµ¬í•  ìˆ˜ ìˆë‹¤.</p>

<p>ì´ í”„ë¡œì íŠ¸ëŠ” <strong>êµ°ì§‘í™”(Clustering)</strong>ì˜ ê°œë…ì„ ìˆ™ì§€í•˜ê³  ìˆë‹¤ëŠ” ì „ì œë¡œ ìˆ˜í–‰í•œë‹¤.</p>

<h1 id="code">Code</h1>
<p class="notice--danger"><strong>[Notice]</strong> <a href="https://github.com/hchoi256/cs540-AI/tree/main/hierarchical-clustering-pokemon">download here</a></p>

<h1 id="ë°ì´í„°ì…‹-ê´€ì°°">ë°ì´í„°ì…‹ ê´€ì°°</h1>

<p><img src="https://user-images.githubusercontent.com/39285147/184554603-837ebc40-75b2-4c96-b87e-385eec2b63bd.png" alt="image" /></p>

<ul>
  <li>Columns: <em>Attack, Sp. Atk, Speed, Defense, Sp. Def, and HP</em></li>
</ul>

<h1 id="ë¼ì´ë¸ŒëŸ¬ë¦¬-ë¶ˆëŸ¬ì˜¤ê¸°">ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¶ˆëŸ¬ì˜¤ê¸°</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">dendrogram</span><span class="p">,</span> <span class="n">linkage</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy.linalg</span> <span class="k">as</span> <span class="n">LA</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</code></pre></div></div>

<h1 id="ë°ì´í„°-ë¶ˆëŸ¬ì˜¤ê¸°">ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
    <span class="n">pokemons</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">"utf-8"</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="p">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">csvfile</span><span class="p">)</span> <span class="c1"># ì‚¬ì „ í˜•íƒœë¡œ csv ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¨ë‹¤
</span>        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
            <span class="n">dic</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="n">dic</span><span class="p">[</span><span class="s">"#"</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s">'#'</span><span class="p">]</span>
            <span class="n">dic</span><span class="p">[</span><span class="s">"Name"</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s">'Name'</span><span class="p">]</span>
            <span class="n">dic</span><span class="p">[</span><span class="s">"Type 1"</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s">'Type 1'</span><span class="p">]</span>
            <span class="n">dic</span><span class="p">[</span><span class="s">"Type 2"</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s">'Type 2'</span><span class="p">]</span>
            <span class="n">dic</span><span class="p">[</span><span class="s">"Total"</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s">'Total'</span><span class="p">]</span>
            <span class="n">dic</span><span class="p">[</span><span class="s">"HP"</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s">'HP'</span><span class="p">]</span>
            <span class="n">dic</span><span class="p">[</span><span class="s">"Attack"</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s">'Attack'</span><span class="p">]</span>
            <span class="n">dic</span><span class="p">[</span><span class="s">"Defense"</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s">'Defense'</span><span class="p">]</span>
            <span class="n">dic</span><span class="p">[</span><span class="s">"Sp. Atk"</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s">'Sp. Atk'</span><span class="p">]</span>
            <span class="n">dic</span><span class="p">[</span><span class="s">"Sp. Def"</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s">'Sp. Def'</span><span class="p">]</span>
            <span class="n">dic</span><span class="p">[</span><span class="s">"Speed"</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s">'Speed'</span><span class="p">]</span>
            <span class="n">dic</span><span class="p">[</span><span class="s">"Generation"</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s">'Generation'</span><span class="p">]</span>
            <span class="n">dic</span><span class="p">[</span><span class="s">"Legendary"</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s">'Legendary'</span><span class="p">]</span>
            <span class="n">pokemons</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pokemons</span> <span class="c1"># ë¦¬ìŠ¤íŠ¸ í˜•íƒœë¡œ ë°˜í™˜
</span></code></pre></div></div>

<h1 id="ë°ì´í„°-ì „ì²˜ë¦¬">ë°ì´í„° ì „ì²˜ë¦¬</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">calc_features</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>    
    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s">"Attack"</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s">"Sp. Atk"</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s">"Speed"</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s">"Defense"</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s">"Sp. Def"</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s">"HP"</span><span class="p">])],</span> <span class="n">dtype</span><span class="o">=</span><span class="s">'int64'</span><span class="p">)</span>
</code></pre></div></div>

<p>í¬ì¼“ëª¬ ë°ì´í„°ì…‹ì—ëŠ” ë²”ì£¼í˜• ë°ì´í„°ê°€ ì¡´ì¬í•œë‹¤.</p>

<p>ë”°ë¼ì„œ, ìˆ˜ì¹˜í˜•ê³¼ ë²”ì£¼í˜• ë°ì´í„° typeì„ ì§€ì •í•˜ê³ , ì†ì‰¬ìš´ ì—°ì‚°ì„ ìœ„í•´ ìµœì¢… ì¶œë ¥ì„ numpy ë°°ì—´ì˜ í˜•íƒœë¡œ ë°˜í™˜í•˜ì.</p>

<h1 id="ê±°ë¦¬-ê³„ì‚°-í•¨ìˆ˜">ê±°ë¦¬ ê³„ì‚° í•¨ìˆ˜</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">get_min_distance</span><span class="p">(</span><span class="nb">min</span><span class="p">,</span> <span class="n">tmp</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">min</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
        <span class="k">if</span> <span class="nb">min</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
            <span class="c1"># equal first index ith
</span>            <span class="k">if</span> <span class="nb">min</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="k">if</span> <span class="nb">min</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="c1"># equal second index jth
</span>                    <span class="k">if</span> <span class="nb">min</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="c1"># share same pokemon stat
</span>                        <span class="nb">min</span> <span class="o">=</span> <span class="n">tmp</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">min</span> <span class="o">=</span> <span class="n">tmp</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">min</span> <span class="o">=</span> <span class="n">tmp</span>
    <span class="k">return</span> <span class="nb">min</span>
</code></pre></div></div>

<p>ìœ í´ë¦¬ë“œ ê±°ë¦¬ë¥¼ ì‚¬ìš©í•´ì„œ â€˜<strong>Complete-linkage(ì™„ì „ ì—°ê²°)</strong>â€™ ê¸°ë²•ìœ¼ë¡œ êµ°ì§‘ê°„ ê±°ë¦¬ë¥¼ ê³„ì‚°í•œë‹¤.</p>

<p>Complete-linkage(ì™„ì „ ì—°ê²°) ì´ì™¸ì—ë„ Average linkage ë“± ì—¬ëŸ¬ ë°©ë²•ìœ¼ë¡œ êµ°ì§‘ê°„ ê±°ë¦¬ë¥¼ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤.</p>

<blockquote>
  <p>ë³´ë‹¤ ìì„¸í•œ ë‚´ìš©ì€ <a href="https://github.com/hchoi256/ai-terms/blob/main/README.md">ì—¬ê¸°</a>ë¥¼ ì°¸ì¡°í•˜ì.</p>
</blockquote>

<h1 id="êµ°ì§‘-í•©ì¹˜ê¸°merge">êµ°ì§‘ í•©ì¹˜ê¸°(Merge)</h1>

<p>HACëŠ” êµ°ì§‘ë“¤ì„ í•©ì³ê°€ë©´ì„œ ê³„ì¸µì  êµ°ì§‘í™”ë¥¼ ì§„í–‰í•œë‹¤.</p>

<p>í•˜ê¸° ì½”ë“œëŠ” êµ°ì§‘ì„ í•©ì¹˜ê¸° ìœ„í•œ í•¨ìˆ˜ì´ë‹¤.</p>

<p>ë³´ë‹¤ ìì„¸í•œ ì´í•´ëŠ” ê° ì½”ë“œ ì˜† ì£¼ì„ì„ ì°¸ê³ í•˜ì.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">merge_distance</span><span class="p">(</span><span class="n">cluster_dict</span><span class="p">):</span>
    <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cluster_dict</span><span class="p">)</span>
    <span class="nb">min</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">inf</span><span class="p">]</span>  <span class="c1"># default to inf for replacement
</span>    <span class="c1"># iterate through cluster list (i.e., [1 2 3] --&gt; (1, 2), (1, 3), (2, 3))
</span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">cluster_dict</span><span class="p">[</span><span class="n">i</span><span class="p">])).</span><span class="n">find</span><span class="p">(</span><span class="s">'int'</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">continue</span>    <span class="c1"># already clustered
</span>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">length</span> <span class="o">-</span> <span class="n">i</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">cluster_dict</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">])).</span><span class="n">find</span><span class="p">(</span><span class="s">'int'</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">continue</span>    <span class="c1"># already clusterd
</span>            <span class="n">tfst</span> <span class="o">=</span> <span class="s">'tuple'</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">cluster_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">tsnd</span> <span class="o">=</span> <span class="s">'tuple'</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">cluster_dict</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]))</span>
            <span class="c1"># check if multiple pokemons in cluster or not
</span>            <span class="k">if</span> <span class="n">tfst</span> <span class="ow">and</span> <span class="n">tsnd</span><span class="p">:</span>
                <span class="c1"># multiple pokemons in both
</span>                <span class="n">distances</span> <span class="o">=</span> <span class="n">max_dist</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">cluster_list1</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cluster_dict</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">cluster_list2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cluster_dict</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">])</span>
                <span class="c1"># complete-linkage
</span>                <span class="k">for</span> <span class="n">c1</span> <span class="ow">in</span> <span class="n">cluster_list1</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">c2</span> <span class="ow">in</span> <span class="n">cluster_list2</span><span class="p">:</span>
                        <span class="n">tmp</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="n">LA</span><span class="p">.</span><span class="n">norm</span><span class="p">(</span><span class="n">c1</span> <span class="o">-</span> <span class="n">c2</span><span class="p">)]</span>
                        <span class="n">distances</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
                        <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">distances</span><span class="p">).</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># get distances only
</span>                        <span class="c1"># get index of max distance
</span>                        <span class="n">max_idx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span> <span class="c1"># complete-linkage
</span>                        <span class="n">max_dist</span> <span class="o">=</span> <span class="n">distances</span><span class="p">[</span><span class="n">max_idx</span><span class="p">]</span>
                <span class="nb">min</span> <span class="o">=</span> <span class="n">get_min_distance</span><span class="p">(</span><span class="nb">min</span><span class="p">,</span> <span class="n">max_dist</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">tfst</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">tsnd</span><span class="p">:</span>
                <span class="c1"># multiple pokemons in first cluster
</span>                <span class="n">distances</span> <span class="o">=</span> <span class="n">max_dist</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">cluster_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cluster_dict</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="c1"># complete-linkage
</span>                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cluster_list</span><span class="p">:</span>
                    <span class="n">tmp</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="n">LA</span><span class="p">.</span><span class="n">norm</span><span class="p">(</span><span class="n">c</span> <span class="o">-</span> <span class="n">cluster_dict</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">])]</span>
                    <span class="n">distances</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
                    <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">distances</span><span class="p">).</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># get distances only
</span>                    <span class="n">max_idx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>       <span class="c1"># get index of max distance
</span>                    <span class="n">max_dist</span> <span class="o">=</span> <span class="n">distances</span><span class="p">[</span><span class="n">max_idx</span><span class="p">]</span>
                <span class="nb">min</span> <span class="o">=</span> <span class="n">get_min_distance</span><span class="p">(</span><span class="nb">min</span><span class="p">,</span> <span class="n">max_dist</span><span class="p">)</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">tfst</span> <span class="ow">and</span> <span class="n">tsnd</span><span class="p">:</span>
                <span class="c1"># multiple pokemons in second cluster
</span>                <span class="n">distances</span> <span class="o">=</span> <span class="n">max_dist</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">cluster_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cluster_dict</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">])</span>
                <span class="c1"># complete-linkage
</span>                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cluster_list</span><span class="p">:</span>
                    <span class="n">tmp</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="n">LA</span><span class="p">.</span><span class="n">norm</span><span class="p">(</span><span class="n">cluster_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">c</span><span class="p">)]</span>
                    <span class="n">distances</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
                    <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">distances</span><span class="p">).</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># get distances only
</span>                    <span class="n">max_idx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>       <span class="c1"># get index of max distance
</span>                    <span class="n">max_dist</span> <span class="o">=</span> <span class="n">distances</span><span class="p">[</span><span class="n">max_idx</span><span class="p">]</span>
                <span class="nb">min</span> <span class="o">=</span> <span class="n">get_min_distance</span><span class="p">(</span><span class="nb">min</span><span class="p">,</span> <span class="n">max_dist</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># single pokemon in both
</span>                <span class="n">tmp</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="n">LA</span><span class="p">.</span><span class="n">norm</span><span class="p">(</span><span class="n">cluster_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">cluster_dict</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">])]</span>
                <span class="nb">min</span> <span class="o">=</span> <span class="n">get_min_distance</span><span class="p">(</span><span class="nb">min</span><span class="p">,</span> <span class="n">tmp</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">min</span>
</code></pre></div></div>

<p>ìƒê¸° ì½”ë“œëŠ” ì¡´ì¬í•˜ëŠ” êµ°ì§‘ ë¦¬ìŠ¤íŠ¸ ì¤‘ì—ì„œ ê°€ì¥ ê°€ê¹Œìš´ ê±°ë¦¬ì˜ êµ°ì§‘ ë‘ ê°œë¥¼ ì°¾ëŠ”ë‹¤.</p>

<p>ì—¬ê¸°ì„œ êµ°ì§‘ ê°„ ê±°ë¦¬ëŠ” â€˜complete-linkageâ€™ ë°©ë²•ì— ê·¼ê±°í•œë‹¤.</p>

<p>ì´ëŸ¬í•œ ë§¥ë½ì—ì„œ, ì£¼ëª©í•  ì ì€ â€˜<strong>max_idx = np.argmax(dist)</strong>â€™ ì—¬ê¸°ì´ë‹¤.</p>

<p>ìš°ë¦¬ëŠ” ì™„ì „ ì—°ê²° ë°©ë²•ì— ê¸°ë°˜í•´ì„œ êµ°ì§‘ ê°„ ê±°ë¦¬ë¥¼ êµ¬í•˜ê³  ì„œë¡œ ê°€ì¥ ê°€ê¹Œì´ ìœ„ì¹˜í•œ êµ°ì§‘ë“¤ì„ í•˜ë‚˜ì˜ êµ°ì§‘ìœ¼ë¡œ í†µí•©í•œë‹¤.</p>

<p>ì™„ì „ ì—°ê²°ì€ ì„œë¡œ ë‹¤ë¥¸ êµ°ì§‘ì— í¬í•¨ëœ ë°ì´í„°ë“¤ì˜ ê±°ë¦¬ê°€ ê°€ì¥ ë¨¼ ê°’ì„ êµ°ì§‘ì˜ ê±°ë¦¬ë¡œ ì±„íƒí•œë‹¤.</p>

<p>ì´ë¥¼ ìœ„í•´, â€˜np.argmaxâ€™ë¥¼ ì‚¬ìš©í•´ì„œ êµ°ì§‘ ê°„ ê±°ë¦¬ë¥¼ ë„ì¶œí•˜ê³ , â€˜get_min_distance(min, max_dist)â€™ë¥¼ í†µí•´ì„œ ê°€ì¥ ê°€ê¹Œìš´ ê±°ë¦¬ì— ìœ„ì¹˜í•œ êµ°ì§‘ì„ ì°¾ì•„ í•´ë‹¹ êµ°ì§‘ê³¼ í•˜ë‚˜ë¡œ í•©ì³ì§„ë‹¤.</p>

<p>ì´ ì™¸ ì½”ë“œëŠ” ì²œì²œíˆ ì½ì–´ë³´ë©´ ì¶©ë¶„íˆ ì´í•´ ê°€ëŠ¥í•œ ë¶€ë¶„ë“¤ì´ë‹¤.</p>

<h1 id="hac">HAC</h1>

<p>ì´ì œ HAC ê³„ì‚°ì— í•„ìš”í•œ ëª¨ë“  í•¨ìˆ˜ë“¤ì„ ë§Œë“¤ì—ˆìœ¼ë‹ˆ, HACë¥¼ êµ¬ì¶•í•´ë³´ì!</p>

<p>ì´ ë‹¨ê³„ì—ì„œëŠ” ê°€ì¥ ê°€ê¹Œìš´ ê±°ë¦¬ì˜ êµ°ì§‘ ë‘ ê°œë¥¼ ì°¾ì•„ì„œ í•˜ë‚˜ì˜ êµ°ì§‘ìœ¼ë¡œ í†µí•©í•˜ëŠ” ê³¼ì •ì´ ì§„í•¸ëœë‹¤.</p>

<p>ê° ì½”ë“œ ì˜†ì— ì£¼ì„ì„ ë‹¬ì•˜ìœ¼ë‹ˆ ì°¸ì¡°í•˜ë©° ì½ì–´ë³´ì.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">hac</span><span class="p">(</span><span class="n">features</span><span class="p">):</span>
    <span class="n">flen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
    <span class="c1"># (n-1) x 4 array
</span>    <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">flen</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="c1"># track clusters
</span>    <span class="n">cluster_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">flen</span><span class="p">):</span>
        <span class="n">cluster_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="c1"># compute complete-linkage
</span>    <span class="n">count</span> <span class="o">=</span> <span class="n">flen</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">flen</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="c1"># get minimum distance indices
</span>        <span class="n">indices</span> <span class="o">=</span> <span class="n">merge_distance</span><span class="p">(</span><span class="n">cluster_dict</span><span class="p">)</span>
        <span class="c1"># clusters to be merged
</span>        <span class="n">c1</span> <span class="o">=</span> <span class="n">cluster_dict</span><span class="p">[</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">c2</span> <span class="o">=</span> <span class="n">cluster_dict</span><span class="p">[</span><span class="n">indices</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
        <span class="c1"># check if multiple pokemons in cluster or not
</span>        <span class="c1"># if tuple, then multiple pokemons, otherwise single pokemon
</span>        <span class="n">tfst</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">c1</span><span class="p">)).</span><span class="n">find</span><span class="p">(</span><span class="s">'tuple'</span><span class="p">)</span>
        <span class="n">tsnd</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">c2</span><span class="p">)).</span><span class="n">find</span><span class="p">(</span><span class="s">'tuple'</span><span class="p">)</span>
        <span class="n">l1</span> <span class="o">=</span> <span class="n">l2</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">tfst</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">tsnd</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="c1"># single pokemon
</span>            <span class="n">l1</span> <span class="o">=</span> <span class="p">[</span><span class="n">c1</span><span class="p">]</span>
            <span class="n">l2</span> <span class="o">=</span> <span class="p">[</span><span class="n">c2</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># multiple pokemons
</span>            <span class="k">if</span> <span class="n">tfst</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">l1</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">l1</span> <span class="o">=</span> <span class="p">[</span><span class="n">c1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">tsnd</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">l2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">c2</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">l2</span> <span class="o">=</span> <span class="p">[</span><span class="n">c2</span><span class="p">]</span>
        <span class="c1"># merge clusters
</span>        <span class="n">ncluster</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">fst_idx</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">snd_idx</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># update output
</span>        <span class="n">res</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">fst_idx</span>         <span class="c1"># index of first cluster
</span>        <span class="n">res</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">snd_idx</span>         <span class="c1"># index of seoncd cluster
</span>        <span class="n">res</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>      <span class="c1"># distance
</span>        <span class="n">res</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ncluster</span><span class="p">)</span>   <span class="c1"># num of elements in cluster
</span>        <span class="c1"># add into cluster list
</span>        <span class="n">cluster_dict</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="n">ncluster</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1"># remove from cluster list
</span>        <span class="n">cluster_dict</span><span class="p">[</span><span class="n">fst_idx</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">cluster_dict</span><span class="p">[</span><span class="n">snd_idx</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    
    <span class="k">return</span> <span class="n">res</span>
</code></pre></div></div>

<h1 id="ê²°ê³¼-í™•ì¸">ê²°ê³¼ í™•ì¸</h1>

<p>HACë¥¼ ì‹œê°í™” í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ â€˜<strong><em>dendrogram</em></strong>â€˜ì´ë¼ëŠ” í•¨ìˆ˜ë¥¼ ìì£¼ ì‚¬ìš©í•œë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">imshow_hac</span><span class="p">(</span><span class="n">Z</span><span class="p">):</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">dn</span> <span class="o">=</span> <span class="n">dendrogram</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">21</span><span class="p">):</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">hac</span><span class="p">([</span><span class="n">calc_features</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span> <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">load_data</span><span class="p">(</span><span class="s">'Pokemon.csv'</span><span class="p">)][:</span><span class="n">n</span><span class="p">])</span>
    <span class="n">imshow_hac</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
</code></pre></div></div>

<p>êµ°ì§‘ ëª‡ ê°œë¥¼ í•©ì¹  ê²ƒì¸ì§€ ê·¸ ìˆ«ìë¥¼ ì¸í’‹ìœ¼ë¡œ ë¶€ì—¬í•œë‹¤.</p>

<p><em>[êµ°ì§‘ 2ê°œ]</em></p>

<p><img src="https://user-images.githubusercontent.com/39285147/184555068-caa7859d-9651-41c8-b3fe-41b6032fcce5.png" alt="image" /></p>

<p><em>[êµ°ì§‘ 3ê°œ]</em></p>

<p><img src="https://user-images.githubusercontent.com/39285147/184555089-1434d5be-0e8f-442f-b981-fdf65a12379f.png" alt="image" /></p>

<p><em>[êµ°ì§‘ 4ê°œ]</em></p>

<p><img src="https://user-images.githubusercontent.com/39285147/184555094-fe695724-17ee-47df-9ea8-070ea24c774b.png" alt="image" /></p>

<p>â€¦</p>

<p><img src="https://user-images.githubusercontent.com/39285147/184555117-ebd0bf14-f711-473b-b0ec-275833e32ad3.png" alt="image" /></p>]]></content><author><name>ì­ŒìŠ¤ğŸ„</name></author><category term="USL" /><category term="HAC" /><category term="Clustering" /><category term="Pokemon" /><summary type="html"><![CDATA[Hierarchical Agglomerate Clustering(HAC) ì´ìš©í•´ì„œ ì„œë¡œ ë‹¤ë¥¸ íŠ¹ì„±ì„ ê³µìœ í•˜ëŠ” Pokemonë“¤ì„ êµ°ì§‘ìœ¼ë¡œ ë¬¶ì–´ë³´ì.]]></summary></entry><entry><title type="html">A* Search - 8-tile Puzzle Game</title><link href="http://localhost:4000/others/ml-8-tile-puzzle-a-search/" rel="alternate" type="text/html" title="A* Search - 8-tile Puzzle Game" /><published>2022-08-14T00:00:00+09:00</published><updated>2022-08-14T00:00:00+09:00</updated><id>http://localhost:4000/others/ml-8-tile-puzzle-a-search</id><content type="html" xml:base="http://localhost:4000/others/ml-8-tile-puzzle-a-search/"><![CDATA[<p><strong>A-star ì•Œê³ ë¦¬ì¦˜</strong>ì„ í™œìš©í•´ì„œ <strong>8-tile Puzzle</strong> ê²Œì„ì„ êµ¬í˜„í•œë‹¤.</p>

<blockquote>
  <p><a href="https://natejin.tistory.com/22"><strong><em>8-tile Puzzle</em></strong></a> ì •ë³´ëŠ” ì—¬ê¸°ì„œ ì°¸ê³ í•˜ì.</p>
</blockquote>

<p>ì´ ê²Œì„ì—ì„œ ë‹¹ì‹ ì€ AI ë¡œë´‡ê³¼ Teeko ë³´ë“œ ê²Œì„ì„ í¼ì¹˜ê²Œ ë  ê²ƒì´ë‹¤.</p>

<p>ì´ í”„ë¡œì íŠ¸ëŠ” A* íƒìƒ‰ ì•Œê³ ë¦¬ì¦˜ì„ ì´í•´í•˜ê³  ìˆë‹¤ëŠ” ì „ì œë¡œ ì§„í–‰í•œë‹¤.</p>

<blockquote>
  <p><a href="https://github.com/hchoi256/ai-terms/blob/main/README.md">A* íƒìƒ‰ ì•Œê³ ë¦¬ì¦˜</a>ì´ë€?</p>
</blockquote>

<h1 id="code">Code</h1>
<p class="notice--danger"><strong>[Notice]</strong> <a href="https://github.com/hchoi256/cs540-AI/tree/main/A-star-8-tile-puzzle">download here</a></p>]]></content><author><name>ì­ŒìŠ¤ğŸ„</name></author><category term="Others" /><category term="Machine Learning" /><category term="Game" /><category term="A* Search" /><summary type="html"><![CDATA[A-star ì•Œê³ ë¦¬ì¦˜ì„ í™œìš©í•´ì„œ 8-tile Puzzle ê²Œì„ì„ êµ¬í˜„í•œë‹¤.]]></summary></entry><entry><title type="html">LeNet ì‹ ê²½ë§ - MiniPlaces ì´ë¯¸ì§€ ë¶„ë¥˜</title><link href="http://localhost:4000/sl/dl-miniplace-classification/" rel="alternate" type="text/html" title="LeNet ì‹ ê²½ë§ - MiniPlaces ì´ë¯¸ì§€ ë¶„ë¥˜" /><published>2022-08-14T00:00:00+09:00</published><updated>2022-08-14T00:00:00+09:00</updated><id>http://localhost:4000/sl/dl-miniplace-classification</id><content type="html" xml:base="http://localhost:4000/sl/dl-miniplace-classification/"><![CDATA[<p>LeNet ì‹ ê²½ë§ì„ í™œìš©í•´ì„œ MiniPlaces ë°ì´í„°ì…‹ ì´ë¯¸ì§€ ë¶„ë¥˜ ì‘ì—…ì„ ìˆ˜í–‰í•œë‹¤.</p>

<p>â€˜MiniPlacesâ€™ ë°ì´í„°ì…‹ì€ ìºê¸€ê³¼ ê°™ì€ ì˜¨ë¼ì¸ì—ì„œ ì†ì‰½ê²Œ êµ¬í•  ìˆ˜ ìˆë‹¤ <a href="https://www.kaggle.com/datasets/russchua/miniplaces">ì—¬ê¸°</a>.</p>

<h1 id="code">Code</h1>
<p class="notice--danger"><strong>[Notice]</strong> <a href="https://github.com/hchoi256/cs540-AI/tree/main/convolutional-neural-network">download here</a></p>

<blockquote>
  <p>CNNì´ë‚˜ LeNet ì‹ ê²½ë§ì— ëŒ€í•œ ë³´ë‹¤ ìì„¸í•œ ë‚´ìš©ì€ <a href="https://github.com/hchoi256/ai-terms/blob/main/README.md">ì—¬ê¸°</a>ë¥¼ ì°¸ì¡°í•˜ì.</p>
</blockquote>

<h1 id="ë¼ì´ë¸ŒëŸ¬ë¦¬-ë¶ˆëŸ¬ì˜¤ê¸°">ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¶ˆëŸ¬ì˜¤ê¸°</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># python imports
</span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>

<span class="c1"># torch imports
</span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="n">nn</span>
<span class="kn">import</span> <span class="nn">torch.optim</span> <span class="k">as</span> <span class="n">optim</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="n">F</span>

<span class="c1"># helper functions for computer vision
</span><span class="kn">import</span> <span class="nn">torchvision</span>
<span class="kn">import</span> <span class="nn">torchvision.transforms</span> <span class="k">as</span> <span class="n">transforms</span>
</code></pre></div></div>

<h1 id="lenet-ì‹ ê²½ë§-êµ¬ì¶•">LeNet ì‹ ê²½ë§ êµ¬ì¶•</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">LeNet</span><span class="p">(</span><span class="n">nn</span><span class="p">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">LeNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">).</span><span class="n">__init__</span><span class="p">()</span>
        <span class="c1"># certain definitions
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">conv2</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">flatten</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="n">Flatten</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">linear1</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span><span class="mi">256</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">linear2</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span><span class="mi">128</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">linear3</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">)</span>

    <span class="c1"># ìˆœì „íŒŒ
</span>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">shape_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># certain operations
</span>        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="p">.</span><span class="n">max_pool2d</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">conv1</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">shape_dict</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">shape</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="p">.</span><span class="n">max_pool2d</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">conv2</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">shape_dict</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">shape</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">shape_dict</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">shape</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="p">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">linear1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">shape_dict</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">shape</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="p">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">linear2</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">shape_dict</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">shape</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">linear3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">shape_dict</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">shape</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">x</span>
        <span class="k">return</span> <span class="n">out</span><span class="p">,</span> <span class="n">shape_dict</span>
</code></pre></div></div>

<p>ìƒê¸° LeNet ì‹ ê²½ë§ì—ì„œ ì´ˆê¸°ê°’ ë° ìˆœì „íŒŒ ê³¼ì •ì„ ì •ì˜í•œë‹¤.</p>

<p>PyTorch íŠ¹ì„±ìƒ ì´í›„ í•™ìŠµ ë‹¨ê³„ì—ì„œ <strong>ì—­ì „íŒŒ</strong>ë¥¼ ì •ì˜í•  ì˜ˆì •ì´ë‹¤.</p>

<blockquote>
  <p><strong><em>â€˜Stride, Pooling, Paddingâ€™</em></strong> í˜¹ì€ ìˆœ/ì—­ì „íŒŒì— ê´€í•œ ë³´ë‹¤ ìì„¸í•œ ë‚´ìš©ì€ <a href="https://github.com/hchoi256/ai-terms/blob/main/README.md">ì—¬ê¸°</a>ë¥¼ ì°¸ì¡°í•˜ì.</p>
</blockquote>

<h1 id="í•™ìŠµ-ê°€ëŠ¥-í”¼ë¼ë¯¸í„°-ê°œìˆ˜optional">í•™ìŠµ ê°€ëŠ¥ í”¼ë¼ë¯¸í„° ê°œìˆ˜(<em>Optional</em>)</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">count_model_params</span><span class="p">():</span>
    <span class="s">'''
    return the number of trainable parameters of LeNet.
    '''</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">LeNet</span><span class="p">()</span>
    <span class="n">model_params</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">model_params</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">numel</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">model</span><span class="p">.</span><span class="n">parameters</span><span class="p">()</span> <span class="k">if</span> <span class="n">p</span><span class="p">.</span><span class="n">requires_grad</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">model_params</span> <span class="o">/</span> <span class="mf">1e6</span>   
</code></pre></div></div>

<p>í•´ë‹¹ ê³¼ì •ì€ í•™ìŠµì— í•„ìˆ˜ëŠ” ì•„ë‹ˆì§€ë§Œ, êµìœ¡ ì¸¡ë©´ì—ì„œ ë„ì›€ì´ ë  ìˆ˜ ìˆìœ¼ë‹ˆ ë§Œë“¤ì–´ë³´ì•˜ë‹¤.</p>

<h1 id="ëª¨ë¸-í•™ìŠµ">ëª¨ë¸ í•™ìŠµ</h1>

<p>í•˜ê¸° ì½”ë“œ ì˜†ì— ì£¼ì„ì„ ìì„¸íˆ ë‹¬ì•„ë†¨ìœ¼ë‹ˆ ì°¸ì¡°í•˜ë©° ì½ì–´ë³´ê¸¸ ë°”ë€ë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">train_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train_loader</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">criterion</span><span class="p">,</span> <span class="n">epoch</span><span class="p">):</span>
    <span class="s">"""
    model (torch.nn.module): The model created to train
    train_loader (pytorch data loader): Training data loader
    optimizer (optimizer.*): A instance of some sort of optimizer, usually SGD
    criterion (nn.CrossEntropyLoss) : Loss function used to train the network
    epoch (int): Current epoch number
    """</span>
    <span class="n">model</span><span class="p">.</span><span class="n">train</span><span class="p">()</span>
    <span class="n">train_loss</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="nb">input</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">train_loader</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">train_loader</span><span class="p">)):</span>
        <span class="c1">###################################
</span>        <span class="c1"># fill in the standard training loop of forward pass,
</span>        <span class="c1"># backward pass, loss computation and optimizer step
</span>        <span class="c1">###################################
</span>
        <span class="c1"># 1) zero the parameter gradients
</span>        <span class="n">optimizer</span><span class="p">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="c1"># 2) forward + backward + optimize
</span>        <span class="n">output</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
        <span class="n">loss</span><span class="p">.</span><span class="n">backward</span><span class="p">()</span> <span class="c1"># ì—­ì „íŒŒ ì§„í–‰
</span>        <span class="n">optimizer</span><span class="p">.</span><span class="n">step</span><span class="p">()</span>

        <span class="c1"># Update the train_loss variable
</span>        <span class="c1"># .item() detaches the node from the computational graph
</span>        <span class="c1"># Uncomment the below line after you fill block 1 and 2
</span>        <span class="n">train_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="p">.</span><span class="n">item</span><span class="p">()</span>

    <span class="n">train_loss</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_loader</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'[Training set] Epoch: {:d}, Average loss: {:.4f}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">epoch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">train_loss</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">train_loss</span>
</code></pre></div></div>

<p>â€˜<strong>tqdm</strong>â€˜ëŠ” progress barë¥¼ ìƒì„±í•´ì£¼ê³ , í•¨ìˆ˜ë‚˜ ë°˜ë³µë¬¸ì˜ TTC (Time To Completion) ë¥¼ ì˜ˆì¸¡í•˜ëŠ” íŒŒì´ì¬ íŒ¨í‚¤ì§€ì´ë‹¤.</p>

<p>ëª¨ë¸ í•™ìŠµ ê³¼ì •ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ í™•ì¸í•˜ê¸° ìœ„í•´ ë¶ˆëŸ¬ì˜¨ íŒ¨í‚¤ì§€ì´ë‹¤.</p>

<p>ì£¼ìš” íŠ¹ì§•ë“¤ì„ ì‚´í´ë³´ì:</p>
<ul>
  <li><em>optimizer.zero_grad()</em>: ì´ì „ stepì—ì„œ ê° layer ë³„ë¡œ ê³„ì‚°ëœ gradient ê°’ì„ ëª¨ë‘ 0ìœ¼ë¡œ ì´ˆê¸°í™” ì‹œí‚¤ëŠ” ì‘ì—…ìœ¼ë¡œ, 0ìœ¼ë¡œ ì´ˆê¸°í™” í•˜ì§€ ì•Šìœ¼ë©´ ì´ì „ stepì˜ ê²°ê³¼ì— í˜„ì¬ stepì˜ gradientê°€ ëˆ„ì ìœ¼ë¡œ í•©í•´ì ¸ì„œ ê³„ì‚°ëœë‹¤.</li>
  <li><em>criterion</em>: ì†ì‹¤í•¨ìˆ˜ (ì´ í”„ë¡œì íŠ¸ëŠ” â€˜<em>í¬ë¡œìŠ¤ ì—”íŠ¸ë¡œí”¼</em>â€˜ë¥¼ í™œìš©í•œë‹¤)</li>
  <li><em>optimizer</em>: ìµœì í™” ë°©ë²• (i.e., Adam)</li>
  <li><em>loss.backward()</em>: back-propagationì„ í†µí•´ gradientë¥¼ ê³„ì‚°í•œë‹¤.</li>
  <li><em>optimizer.step()</em>: ê° layerì˜ gradient ê°’ì„ ì´ìš©í•˜ì—¬ íŒŒë¼ë¯¸í„°ë¥¼ ì—…ë°ì´íŠ¸.</li>
  <li><em>train_loss += loss.item()</em>: ì†ì‹¤ê°’ ëˆ„ì  ê³„ì‚°</li>
</ul>

<blockquote>
  <p><strong><em>í¬ë¡œìŠ¤ ì—”íŠ¸ë¡œí”¼(Cross Entropy)</em></strong>ì— ê´€í•œ ë³´ë‹¤ ìì„¸í•œ ë‚´ìš©ì€ <a href="https://github.com/hchoi256/ai-terms/blob/main/README.md">ì—¬ê¸°</a>ë¥¼ ì°¸ì¡°í•˜ì.</p>
</blockquote>

<blockquote>
  <p>ë³´ë‹¤ ìì„¸í•œ PyTorch ë¬¸ë²•ì€ ì™¸ë¶€ ì‚¬ì´íŠ¸ <a href="https://gaussian37.github.io/dl-pytorch-snippets/">ì—¬ê¸°</a>ë¥¼ ì°¸ì¡°í•˜ê¸¸ ë°”ë€ë‹¤.</p>
</blockquote>

<h1 id="ëª¨ë¸-í…ŒìŠ¤íŠ¸">ëª¨ë¸ í…ŒìŠ¤íŠ¸</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">test_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">test_loader</span><span class="p">,</span> <span class="n">epoch</span><span class="p">):</span>
    <span class="n">model</span><span class="p">.</span><span class="nb">eval</span><span class="p">()</span>
    <span class="n">correct</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">with</span> <span class="n">torch</span><span class="p">.</span><span class="n">no_grad</span><span class="p">():</span>
        <span class="k">for</span> <span class="nb">input</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">test_loader</span><span class="p">:</span>
            <span class="n">output</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
            <span class="n">pred</span> <span class="o">=</span> <span class="n">output</span><span class="p">.</span><span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="bp">True</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">correct</span> <span class="o">+=</span> <span class="n">pred</span><span class="p">.</span><span class="n">eq</span><span class="p">(</span><span class="n">target</span><span class="p">.</span><span class="n">view_as</span><span class="p">(</span><span class="n">pred</span><span class="p">)).</span><span class="nb">sum</span><span class="p">().</span><span class="n">item</span><span class="p">()</span>

    <span class="n">test_acc</span> <span class="o">=</span> <span class="n">correct</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_loader</span><span class="p">.</span><span class="n">dataset</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'[Test set] Epoch: {:d}, Accuracy: {:.2f}%</span><span class="se">\n</span><span class="s">'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span>
        <span class="n">epoch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mf">100.</span> <span class="o">*</span> <span class="n">test_acc</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">test_acc</span>
</code></pre></div></div>

<p>ì´ì œ ê°œì¸ì ìœ¼ë¡œ ê°ì MiniPlaces ë°ì´í„°ì…‹ì„ í™œìš©í•´ì„œ ì§ì ‘ PyTorchë¡œ ëª¨ë¸ì„ í•™ìŠµì‹œì¼œë³´ë„ë¡ í•˜ì.</p>]]></content><author><name>ì­ŒìŠ¤ğŸ„</name></author><category term="SL" /><category term="LeNet" /><category term="Classification" /><category term="PyTorch" /><summary type="html"><![CDATA[LeNet ì‹ ê²½ë§ì„ í™œìš©í•´ì„œ MiniPlaces ë°ì´í„°ì…‹ ì´ë¯¸ì§€ ë¶„ë¥˜ ì‘ì—…ì„ ìˆ˜í–‰í•œë‹¤.]]></summary></entry><entry><title type="html">Python: PART 2 - Web Application without Server</title><link href="http://localhost:4000/python/python-web-server-exercise/" rel="alternate" type="text/html" title="Python: PART 2 - Web Application without Server" /><published>2022-08-13T00:00:00+09:00</published><updated>2022-08-13T00:00:00+09:00</updated><id>http://localhost:4000/python/python-web-server-exercise</id><content type="html" xml:base="http://localhost:4000/python/python-web-server-exercise/"><![CDATA[<hr />
<h1 id="ê°•ì•„ì§€-í’ˆì¢…-ë¶„ë¥˜-ai-ì›¹í˜ì´ì§€">ê°•ì•„ì§€ í’ˆì¢… ë¶„ë¥˜ AI ì›¹í˜ì´ì§€</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">opencv</span><span class="o">-</span><span class="n">python</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Loading the libraries
</span><span class="kn">from</span> <span class="nn">distutils.command.install_egg_info</span> <span class="kn">import</span> <span class="n">to_filename</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">streamlit</span> <span class="k">as</span> <span class="n">st</span>
<span class="kn">import</span> <span class="nn">cv2</span> <span class="c1"># *opencv
</span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>
</code></pre></div></div>

<p>ìƒê¸° ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¤‘ì— ëˆˆì— ë„ëŠ” ê²ƒì´ ìˆë‹¤; <strong>cv2</strong></p>

<p>cv2 ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” opencv íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•´ì„œ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆë‹¤.</p>

<p>*OpenCV(Open Source Computer Vision)ëŠ” ë‹¤ì–‘í•œ ì˜ìƒ/ë™ì˜ìƒ ì²˜ë¦¬ì— ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì‹¤ì‹œê°„ ì²˜ë¦¬ì— ëŠ¥í•œ ì˜¤í”ˆì†ŒìŠ¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ë‹¤.</p>

<p>ì‹¤ì‹œê°„ ì›¹ì„œë²„ì™€ ê°™ì€ í™˜ê²½ì—ì„œ í™œìš©ì„±ì´ ì¢‹ë‹¤!</p>

<p>ì, ì´ì œ ì—¬ëŸ¬ ì¥ì˜ ì„œë¡œ ë‹¤ë¥¸ ê°•ì•„ì§€ í’ˆì¢… ì´ë¯¸ì§€ë¥¼ í•™ìŠµí•œ ì‚¬ì „ í•™ìŠµ ëª¨ë¸ â€˜dog_breed.h5â€™ë¥¼ ì „ì´í•™ìŠµì„ ìœ„í•´ ë¶ˆëŸ¬ì˜¤ì.</p>

<blockquote>
  <p>í•´ë‹¹ ì‚¬ì „ëª¨ë¸ ìš”ì²­ ì‹œ ì œê³µ.</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="p">.</span><span class="n">models</span><span class="p">.</span><span class="n">load_model</span><span class="p">(</span><span class="s">"dog_breed.h5"</span><span class="p">)</span>
</code></pre></div></div>

<p>ë¶ˆëŸ¬ì˜¨ ì‚¬ì „í•™ìŠµ ëª¨ë¸ì€ ë‹¤ìŒê³¼ ê°™ì´ ì„¸ ê°€ì§€ ê°•ì•„ì§€ í’ˆì¢…ì˜ í´ë˜ìŠ¤ë¡œ ìµœì¢… ì¶œë ¥ì„ ë„ì¶œí•œë‹¤.</p>

<p>ë§Œì•½, ë” ì™„ì„±ë„ ë†’ì€ ë¶„ë¥˜ ëª¨ë¸ì„ í˜•ì„±í•˜ê³  ì‹¶ë‹¤ë©´ <strong>fine-tuning</strong> ì‘ì—…ì„ í†µí•´ ëª¨ë¸ ê°œì„  í˜¹ì€ <strong>ImageNet</strong>ì„ ì‚¬ì „ëª¨ë¸ë¡œ ì±„íƒí•˜ëŠ” ì„ íƒì§€ë¥¼ ì·¨í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">CLASS_NAMES</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Scottish Deerhound'</span><span class="p">,</span><span class="s">'Maltese Dog'</span><span class="p">,</span><span class="s">'Bernese Mountain Dog'</span><span class="p">]</span>
</code></pre></div></div>

<p>ìƒê¸° ì„¸ ê°€ì§€ ê°•ì•„ì§€ í’ˆì¢… ì¤‘ì—ì„œ ê·¸ë‚˜ë§ˆ ê°€ì¥ ìœ ì‚¬í•œ ì¢…ìœ¼ë¡œ ì¸í’‹ ì´ë¯¸ì§€ë¥¼ ë¶„ë¥˜í•œë‹¤.</p>

<p>ì, ì´ì œ ì´ì „ ì‹œê°„ì— ë°°ì› ë˜ ì›¹ í˜ì´ì§€ë¥¼ ë””ìì¸í•  ì‹œê°„ì´ë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">st</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"ì—…ë¡œë“œí•œ ê°œì˜ í’ˆì¢…ë¥¼ ì•Œì•„ë³´ì!"</span><span class="p">)</span> <span class="c1"># title
</span><span class="n">st</span><span class="p">.</span><span class="n">markdown</span><span class="p">(</span><span class="s">"ê°œ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œ í•´ì£¼ì„¸ìš”!"</span><span class="p">)</span>
<span class="n">st</span><span class="p">.</span><span class="n">markdown</span><span class="p">(</span><span class="s">"---"</span><span class="p">)</span> <span class="c1"># division
</span>
<span class="c1"># file uploader
</span><span class="n">dog_image</span> <span class="o">=</span> <span class="n">st</span><span class="p">.</span><span class="n">file_uploader</span><span class="p">(</span>
    <span class="n">label</span> <span class="o">=</span> <span class="s">"ì´ë¯¸ì§€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”..."</span><span class="p">,</span> 
    <span class="nb">type</span> <span class="o">=</span> <span class="p">[</span><span class="s">"jpg"</span><span class="p">,</span> <span class="s">"png"</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">submit</span> <span class="o">=</span> <span class="n">st</span><span class="p">.</span><span class="n">button</span><span class="p">(</span><span class="s">"ì˜ˆì¸¡í•´ì£¼ì„¸ìš”!"</span><span class="p">)</span> <span class="c1"># button object
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># button event handler
</span><span class="k">if</span> <span class="n">submit</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">dog_image</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c1"># opencvì˜ imdecode ì¸ìë¡œ ì‚¬ìš©í•˜ê¸° ìœ„í•´ byteë¡œ ë³€í™˜í•œë‹¤
</span>        <span class="n">file_bytes</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">asarray</span><span class="p">(</span>
            <span class="nb">bytearray</span><span class="p">(</span><span class="n">dog_image</span><span class="p">.</span><span class="n">read</span><span class="p">()),</span> 
            <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">uint8</span>
    <span class="p">)</span>
    <span class="n">opencv_image</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">imdecode</span><span class="p">(</span><span class="n">file_bytes</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># save the input image
</span>
    <span class="n">st</span><span class="p">.</span><span class="n">image</span><span class="p">(</span><span class="n">opencv_image</span><span class="p">,</span> <span class="n">channels</span> <span class="o">=</span> <span class="s">"BGR"</span><span class="p">)</span> <span class="c1"># opencvëŠ” RGBê°€ ì•„ë‹Œ BGRë¡œ í¬ë§·ì„ ì €ì¥í•œë‹¤
</span>
    <span class="c1"># adjusting the size
</span>    <span class="n">opencv_image</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">opencv_image</span><span class="p">,</span> <span class="p">(</span><span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">))</span>
    <span class="n">opencv_image</span><span class="p">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="n">Y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">opencv_image</span><span class="p">)</span> <span class="c1"># fine-tuned model ì˜ˆì¸¡ ìˆ˜í–‰
</span>
    <span class="c1"># st.write(np.argmax(Y_pred))
</span>    <span class="n">st</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="s">"íŒë‹¨í•œ ê°œì˜ í’ˆì¢…ì€ "</span> <span class="o">+</span> <span class="n">CLASS_NAMES</span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">Y_pred</span><span class="p">)]))</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/39285147/184471368-46e7b321-db37-41d1-acd6-717e9478f320.png" alt="image" /></p>

<hr />
<h1 id="dataframe-ë¶„ì„í•˜ê¸°">Dataframe ë¶„ì„í•˜ê¸°</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">streamlit</span> <span class="k">as</span> <span class="n">st</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
</code></pre></div></div>

<p>ì–´ë– í•œ datasetì„ df ê°ì²´ì— ì €ì¥í–ˆë‹¤ê³  ê°€ì •í•˜ì.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data_types</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">dtypes</span>
<span class="n">cat_cols</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">data_types</span><span class="p">[</span><span class="n">data_types</span> <span class="o">==</span> <span class="s">"object"</span><span class="p">].</span><span class="n">index</span><span class="p">)</span> <span class="c1"># ë²”ì£¼í˜• ì»¬ëŸ¼ ì €ì¥
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># container
</span><span class="k">with</span> <span class="n">st</span><span class="p">.</span><span class="n">container</span><span class="p">():</span>
    <span class="n">st</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">"ì»¨í…Œì´ë„ˆ"</span><span class="p">)</span>
    <span class="n">value_counts</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">"Sex"</span><span class="p">].</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="n">st</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">value_counts</span><span class="p">.</span><span class="n">index</span><span class="p">)</span>
    <span class="n">col1</span><span class="p">,</span> <span class="n">col2</span> <span class="o">=</span> <span class="n">st</span><span class="p">.</span><span class="n">columns</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">col1</span><span class="p">:</span>
        <span class="c1"># ë‚¨ë…€ ì„±ë¹„ ë¶„í¬ (Pie)
</span>        <span class="n">st</span><span class="p">.</span><span class="n">subheader</span><span class="p">(</span><span class="s">"ì„œë¸Œ ì»¬ëŸ¼ 1"</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">pie</span><span class="p">(</span><span class="n">value_counts</span><span class="p">,</span> <span class="n">autopct</span><span class="o">=</span><span class="s">"%0.2f%%"</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">"Male"</span><span class="p">,</span> <span class="s">"Female"</span><span class="p">])</span> <span class="c1"># ì›í˜•ìœ¼ë¡œ ì„±ë¹„ í‘œí˜„
</span>        <span class="n">st</span><span class="p">.</span><span class="n">pyplot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">col2</span><span class="p">:</span>
        <span class="c1"># ë‚¨ë…€ ì„±ë¹„ ë¶„í¬ (Bar)
</span>        <span class="n">st</span><span class="p">.</span><span class="n">subheader</span><span class="p">(</span><span class="s">"ì„œë¸Œ ì»¬ëŸ¼ 2"</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">bar</span><span class="p">(</span><span class="n">value_counts</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">value_counts</span><span class="p">)</span> <span class="c1"># barë¡œ ì„±ë¹„ í‘œí˜„
</span>        <span class="n">st</span><span class="p">.</span><span class="n">pyplot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">st</span><span class="p">.</span><span class="n">expander</span><span class="p">(</span><span class="s">"Results of Sex Ratio"</span><span class="p">):</span>
        <span class="n">st</span><span class="p">.</span><span class="n">dataframe</span><span class="p">(</span><span class="n">value_counts</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/39285147/184472017-70a9dc48-5908-4104-9d56-167c49260c7f.png" alt="image" /></p>

<p>ë‹¹ì‹ ì€ ì›¹í˜ì´ì§€ ë‚´ì—ì„œ ë‹¤ë¥¸ plot ìœ í˜•ì„ ì„ íƒí•´ì„œ ë°ì´í„° ë¶„í¬ë¥¼ í™•ì¸í•˜ê³  ì‹¶ì„ì§€ë„ ëª¨ë¥¸ë‹¤.</p>

<p>ìƒê¸° ëª©í‘œ ì—­ì‹œ ì•„ë˜ì²˜ëŸ¼ ì†ì‰½ê²Œ êµ¬í˜„ ê°€ëŠ¥í•˜ë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ë‹¤ë¥¸ plot ìœ í˜• ì„ íƒ
</span><span class="k">with</span> <span class="n">st</span><span class="p">.</span><span class="n">container</span><span class="p">():</span>
    <span class="n">st</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">"asdfasdfasdf"</span><span class="p">)</span>

    <span class="n">chart</span> <span class="o">=</span> <span class="p">(</span><span class="s">"box"</span><span class="p">,</span> <span class="s">"violin"</span><span class="p">,</span> <span class="s">"kdeplot"</span><span class="p">,</span> <span class="s">"histogram"</span><span class="p">)</span>
    <span class="n">chart_selection</span> <span class="o">=</span> <span class="n">st</span><span class="p">.</span><span class="n">selectbox</span><span class="p">(</span><span class="s">"asefaefa"</span><span class="p">,</span> <span class="n">chart</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">chart_selection</span> <span class="o">==</span> <span class="s">"box"</span><span class="p">:</span>
        <span class="n">sns</span><span class="p">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">"Sex"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"Fare"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">chart_selection</span> <span class="o">==</span> <span class="s">"violin"</span><span class="p">:</span>
        <span class="n">sns</span><span class="p">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">"Sex"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"Fare"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">chart_selection</span> <span class="o">==</span> <span class="s">"kdeplot"</span><span class="p">:</span>
        <span class="n">sns</span><span class="p">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">"Fare"</span><span class="p">],</span> <span class="n">hue</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s">"Sex"</span><span class="p">],</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">shade</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">sns</span><span class="p">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">"Fare"</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">"Sex"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">)</span>

    <span class="n">st</span><span class="p">.</span><span class="n">pyplot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/39285147/184472175-c98abfb5-55c4-4af4-a688-521659032de1.png" alt="image" /></p>]]></content><author><name>ì­ŒìŠ¤ğŸ„</name></author><category term="Python" /><category term="Python Web App" /><category term="Streamlit" /><category term="Opencv" /><summary type="html"><![CDATA[ê°•ì•„ì§€ í’ˆì¢… ë¶„ë¥˜ AI ì›¹í˜ì´ì§€]]></summary></entry><entry><title type="html">[ë…¼ë¬¸ ë¶„ì„] A Multi-Task Benchmark for Korean Legal Language Understanding and Judgement Prediction (arXiv 2022)</title><link href="http://localhost:4000/aipapernlp/ai-paper-ko-legal-nlp/" rel="alternate" type="text/html" title="[ë…¼ë¬¸ ë¶„ì„] A Multi-Task Benchmark for Korean Legal Language Understanding and Judgement Prediction (arXiv 2022)" /><published>2022-08-12T00:00:00+09:00</published><updated>2022-08-12T00:00:00+09:00</updated><id>http://localhost:4000/aipapernlp/ai-paper-ko-legal-nlp</id><content type="html" xml:base="http://localhost:4000/aipapernlp/ai-paper-ko-legal-nlp/"><![CDATA[<p><img src="https://user-images.githubusercontent.com/39285147/184294516-0dad2074-9c87-44f1-af52-6ea4c0b5f174.png" alt="image" /></p>

<p><a href="https://arxiv.org/abs/2206.05224"><strong>ë…¼ë¬¸</strong></a></p>

<h1 id="ë“¤ì–´ê°€ë©´ì„œ">ë“¤ì–´ê°€ë©´ì„œ</h1>
<p>ë²•ë¥  ê³„ì•½ì„œëŠ” ì¼ë°˜ì¸ì´ ë…í•´í•˜ê¸° ì–´ë ¤ìš´ ë‹¨ì–´ë“¤ ë¿ë§Œ ì•„ë‹ˆë¼, í•œ ë¬¸ì¥ì´ í•œ í˜ì´ì§€ë¥¼ ì°¨ì§€í•  ì •ë„ë¡œ ê¸´ ë¬¸ì¥ë“¤ì„ í¬í•¨í•œë‹¤.</p>

<p>ì´ì „ì— ì°¸ê°€í•œ í•œ ì„¸ë¯¸ë‚˜ì—ì„œëŠ” ì´ëŸ¬í•œ ë²•ë¥  ê³„ì•½ì„œì— ì¡´ì¬í•˜ëŠ” ì˜¤ë¥˜ë¥¼ ê²€ì‚¬í•˜ëŠ” AI ëª¨ë¸ì„ ì‹¤ì œ ë³€í˜¸ì‚¬ì™€ ëŒ€ê²°ì‹œí‚¨ ì‚¬ë¡€ë¥¼ ì†Œê°œí–ˆë‹¤.</p>

<p>AI ëª¨ë¸ì€ <strong>26ì´ˆ ë§Œì— 94%ì˜ ì •í™•ë„</strong>ë¡œ ì˜¤ë¥˜ë¥¼ ê²€ì¦í•´ë‚´ì—ˆê³ , ë°˜ë©´ ì‚¬ëŒ ë³€í˜¸ì‚¬ëŠ” <strong>96ë¶„ ë™ì•ˆ 86%ì˜ ì •í™•ë„</strong>ë¡œ ì˜¤ë¥˜ë¥¼ ì¡ì•„ëƒˆë‹¤.</p>

<p>ì´ëŸ¬í•œ ì••ë„ì ì¸ AIì˜ ì„±ëŠ¥ì€ ë§¤ë²ˆ ì ì‘ë˜ì§€ ì•Šì„ ì •ë„ë¡œ ì •ë§ì´ì§€ ì–´ë§ˆë¬´ì‹œí•˜ë‹¤.</p>

<p>í•˜ì§€ë§Œ, ìƒê¸° ë²•ë¥  ê³„ì•½ì„œì˜ ë¬¸ì„œ ë‚´ìš©ì€ ì˜ì–´ë¡œ ì í˜€ìˆì—ˆë‹¤. ë‹¤ì‹œ ë§í•´, ìì—°ì–´ ì²˜ë¦¬ ë¶„ì•¼ì—ì„œ ê¸°ê³„ë…í•´ê°€ ê¹Œë‹¤ë¡œìš´ <strong>í•œêµ­ì–´ë¡œ ì íŒ ë²•ë¥  ê³„ì•½ì„œ</strong>ëŠ” ì•„ì§ê¹Œì§„ ê·¸ë§Œí•œ ì„±ëŠ¥ì„ ë‚´ëŠ” AI ëª¨ë¸ì´ ì „ë¬´í•˜ë‹¤.</p>

<p>ìƒê¸° ëª©í‘œë¥¼ ë‹¬ì„±í•˜ê¸° ìœ„í•´ì„œëŠ” ë‹¤ì–‘í•œ ì¡°ê±´ì´ ìˆ˜ë°˜ë˜ì–´ì•¼ í• í„°ì¸ë°, ê°€ë ¹ í•œêµ­ì–´ ê¸°ë°˜ ëª¨ë¸ ê²€ì¦ì„ ìœ„í•œ <strong>ë²•ë¥  í‰ê°€ ë°ì´í„°ì…‹</strong>ì´ í•„ìš”í•  ê²ƒì´ê³ , ê¹Œë‹¤ë¡œìš´ í•œêµ­ì–´ ë¬¸ë²•ì„ ì •í™•íˆ ì´í•´í•˜ëŠ” ì„±ëŠ¥ì¢‹ì€ ì–¸ì–´ëª¨ë¸ì´ í•„ìš”í•˜ë‹¤.</p>

<p>ì—¬ê¸°ê¹Œì§€ëŠ” ë‚´ ì¡ë‹´ì´ì—ˆìœ¼ë‹ˆ ê°€ë³ê²Œ ë¬´ì‹œí•´ë„ ìƒê´€ì—†ë‹¤.</p>

<p>í•˜ì§€ë§Œ, ì•ì„œ ì–¸ê¸‰ëœ ì‚¬ë¡€ëŠ” ë‹¤ì–‘í•œ ì „ë¬¸ ë¶„ì•¼ì—ì„œ <strong>í•œêµ­ì–´ ê¸°ë°˜ NLP ì—°êµ¬</strong>ì˜ í•„ìš”ì„±ì„ ë¶€ê°í•œë‹¤ëŠ” ì ì€ ì¸ì§€í•˜ì.</p>

<h1 id="introduction">INTRODUCTION</h1>
<p>[<em>KAIST AI Grad School, located in Seoul</em>]</p>

<p><img src="https://user-images.githubusercontent.com/39285147/184298843-e3edab46-0d27-4a74-a1f1-62762d1a794a.png" alt="image" /></p>

<p>ì •ë¶€ì—ì„œ ì¶œì‹œí•œ ê·œì¹™ ë° ë„ë©”ì¸ ì§€ì‹ì— ê·¼ê±°í•œ ê¸°ì¡´ ë²•ë¥  ì‹œìŠ¤í…œì€ ìœ ì˜ë¯¸í•œ ì„±ê³¼ë¥¼ ë‚´ê¸°ë„ í–ˆìœ¼ë‚˜, <strong>ë²”ìš©ì„±ì´ ë¶€ì¡±</strong>í•˜ë‹¤ëŠ” í•œê³„ì ì´ ì¡´ì¬í–ˆë‹¤.</p>

<p>ì´ëŸ¬í•œ ì‹¤íŒ¨ì—ëŠ” í•´ë‹¹ ì „ë¬¸ ë¶„ì•¼ì— ëŒ€í•œ <strong>í•œêµ­ì–´ NLP ë°ì´í„°ì…‹ ë¶€ì¬</strong>ì™€ NLP í•™ìŠµì— <strong>ê¹Œë‹¤ë¡œìš´ í•œêµ­ì–´ íŠ¹ì„±</strong>ì´ ë‚´ì¬ë˜ì–´ ìˆì„ ê²ƒì´ë‹¤.</p>

<p>í•˜ì§€ë§Œ, Deep Learningì— ë°œì „ì— ë”°ë¼ ìì—°ì–´ ì²˜ë¦¬ ë˜í•œ ë§ì€ ë³€í™”ì˜ ì‹œê¸°ë¥¼ ê±°ì³ì„œ â€˜íŒê²° ì˜ˆì¸¡â€™ê³¼ ê°™ì€ ì—¬ëŸ¬ ë²•ë¥  ë¶„ì•¼ì— ìƒˆë¡œìš´ ê¸°ìˆ ì  íŒ¨ëŸ¬ë‹¤ì„ì„ ì œì‹œí•œë‹¤.</p>

<p>ì´ëŸ¬í•œ ê²©ë™ì˜ ì‹œê¸°ì— ë°œë§ì¶° ì „ì„¸ê³„ì—ì„œëŠ” AI ëª¨ë¸ í•™ìŠµì— í•„ìˆ˜ì ì¸ ë²•ë¥  ë°ì´í„°ì…‹ì„ ë§Œë“¤ê¸° ì‹œì‘í–ˆê³ , ì„œêµìˆ˜ ì—°êµ¬íŒ€ ë˜í•œ ê¸°ì¡´ì— ì •ë¶€ì—ì„œ ë‚´ë†“ì€ í™œìš© ê°€ì¹˜ê°€ ë–¨ì–´ì¡Œë˜ í•œêµ­ì–´ ë²•ë¥  ë°ì´í„°ì…‹ë¡œë¶€í„° ë” í™•ì¥í•˜ì—¬ ìƒˆë¡œìš´ í•œêµ­ì–´ ê¸°ë°˜ ë²•ë¥  ë°ì´í„°ì…‹ ì—°êµ¬ ê°œë°œì— ì„í•˜ê²Œ ë˜ì—ˆë‹¤.</p>

<p>ì„œêµìˆ˜ë¥¼ ì£¼ì¶•ìœ¼ë¡œí•œ ì—°êµ¬íŒ€ì€ â€˜ìµœì´ˆë¡œâ€™ <strong>í•œêµ­ì–´ ê¸°ë°˜ ëŒ€ìš©ëŸ‰ ë²•ë¥  AI ë°ì´í„°ì…‹</strong>ê³¼ <strong>â€˜LBOX OPENâ€™</strong>ì´ë¼ëŠ” ë²•ë¥  í‰ê°€ ë°ì´í„°ì…‹, ê·¸ë¦¬ê³  <strong>LCUBEë¼ëŠ” í•œêµ­ì–´ ë²•ë¥  ì–¸ì–´ ëª¨ë¸</strong>ì„ ë§Œë“¤ê²Œ ë˜ì—ˆë‹¤ (<em>LBOX OPENê³¼ LCUBEëŠ” í•´ë‹¹ ë…¼ë¬¸ í˜ì´ì§€ë¥¼ í†µí•´ ë‹¤ìš´ë°›ì•„ ì´ìš© ê°€ëŠ¥í•˜ë‹¤</em>).</p>

<p>LBOX OPENì€ <em>1ê°œì˜ ë²•ë¥  corpus</em>, <em>ë‘ ê°œì˜ ë¶„ë¥˜ ë¬¸ì œ</em>, <em>ë‘ ê°œì˜ ë²•ë¥  íŒë‹¨ ì˜ˆì¸¡ ë¬¸ì œ</em>, ê·¸ë¦¬ê³  <em>í•œ ê°œì˜ ìš”ì•½ ë¬¸ì œ</em>ë¥¼ ìœ„í•œ í‰ê°€ ë°ì´í„°ì…‹ì´ë‹¤.</p>

<blockquote>
  <p>ë²”ì£„ì™€ ê°™ì´ ì–´ë– í•œ ì¢…ë¥˜ì˜ ì‚¬ë¡€ë“¤ì„ ê¸°ë°˜ìœ¼ë¡œ êµ¬ì„±ëœ ë°ì´í„°ì…‹ì¸ì§€, ì–¸ì œ/ì–´ë–»ê²Œ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í–ˆëŠ”ì§€ ë“± ë³´ë‹¤ ìì„¸í•œ ë‚´ìš©ì€ í•´ë‹¹ ë…¼ë¬¸ì—ì„œ í™•ì¸í•˜ê¸¸ ë°”ë€ë‹¤.</p>
</blockquote>

<h1 id="lbox-open---large-scale-korean-legal-ai-benchmark"><em>LBOX OPEN</em> - Large-scale Korean legal AI benchmark.</h1>

<p>LBOX OPENì˜ êµ¬ì„±ì€ ë‹¤ìŒê³¼ ê°™ë‹¤:</p>
<ul>
  <li>(1) <strong>a large-scale legal precedent corpus</strong> (PRECEDENT CORPUS)</li>
  <li>(2) <strong>two classification tasks</strong> (CASE NAME, STATUTE)</li>
  <li>(3) <strong>two legal judgement prediction tasks</strong> (LJP-CRIMINAL, LJPCIVIL)</li>
  <li>(4) <strong>one summarization task</strong> (SUMMARIZATION).</li>
</ul>

<blockquote>
  <p>ê° êµ¬ì„± ìš”ì†Œì— ëŒ€í•œ í™œìš© ë°©ë²™ê³¼ ê°™ì€ ë³´ë‹¤ ìì„¸í•œ ì„¤ëª…ì€ í•´ë‹¹ ë…¼ë¬¸ì— ë‚˜ì™€ìˆë‹¤.</p>
</blockquote>

<h2 id="data-preprocessing">Data preprocessing</h2>
<p>ì„œêµìˆ˜ ì—°êµ¬íŒ€ì€ ê¸°ì¡´ì— ì •ë¶€ì—ì„œ ë‚´ë†“ì€ Korean precedentsë¼ëŠ” raw dataì— í¬í•¨ëœ non-trivial ì •ë³´ë“¤ì„ ìë™ parsingí•˜ê³ ì <strong>custom data engineering pipeline</strong>ì„ ë§Œë“¤ì—ˆë‹¤.</p>

<p>í•´ë‹¹ Pipelineì—ì„œ ì—¬ëŸ¬ ë¶„ë¥˜ ì‘ì—…ì„ ê±°ì¹œë‹¤.</p>
<ul>
  <li><em>RestNet</em>ì„ ê¸°ë°˜ <em>Layout classifier</em>ë¥¼ í™œìš©í•˜ì—¬ ê° í˜ì´ì§€ë¥¼ <em>â€˜text onlyâ€™</em> í˜¹ì€ <em>â€˜text w/ tbl or picturesâ€™</em>ë¡œ ë¶„ë¥˜í•˜ì˜€ë‹¤.</li>
  <li><em>Mask-R-CNN</em>ì˜ <em>Layout parser</em>ë¥¼ ì‚¬ìš©í•˜ì—¬ non-textual ìš”ì†Œë“¤ì„ í˜ì´ì§€ë¡œë¶€í„° ë¶„ë¦¬í•œë‹¤.</li>
  <li>Save the information to the database:
    <ul>
      <li>If pdf, extract text w/ custom rule-based parser</li>
      <li>Otherwise if images, extract text segments and their coordinates w/ proprietary OCR engine and use language model to corret OCR errors.</li>
    </ul>
  </li>
</ul>

<p>ìƒê¸° ê³¼ì •ì„ ê±°ì¹œ í›„ <strong>confidence score</strong>ë¥¼ ê³„ì‚°í•´ ê¸°ì¤€ì¹˜ë³´ë‹¤ ë‚®ì„ ê²½ìš°, í•´ë‹¹ í˜ì´ì§€ë“¤ì€ ì—°êµ¬íŒ€ì´ ì§ì ‘ ìˆ˜ë™ìœ¼ë¡œ ì²˜ë¦¬í•œë‹¤.</p>

<p>ë§ˆì§€ë§‰ìœ¼ë¡œ, í•˜ê¸° ì •ë³´ë¥¼ JSON í˜•ì‹ìœ¼ë¡œ ì €ì¥í•˜ê³  ìµœì¢… outputì„ ë„ì¶œí•œë‹¤:</p>
<ul>
  <li>(1) meta information such as case name, sentencing dates, and names of attendees</li>
  <li>(2) ruling</li>
  <li>(3) gist of claim</li>
  <li>(4) appeal</li>
  <li>(5) reasoning body that consists of facts, claims, reasoning, and decision of judges.</li>
</ul>

<h1 id="lcube---language-model-based-on-lbox-open"><em>LCUBE</em> - Language model based on LBOX OPEN</h1>
<p><strong>Classification tasks</strong></p>
<ul>
  <li>GPT-2 í™œìš© decoder-only ëª¨ë¸ â€“&gt; comparable performance with MT5 (a competitive encoder-decoder language model with larger size)</li>
</ul>

<p><strong>Summarization tasks</strong></p>
<ul>
  <li>íƒ€ëª¨ë¸ì— ë¹„í•´ ìƒëŒ€ì ìœ¼ë¡œ ì•ˆì¢‹ì€ ì„±ëŠ¥ì„ ë³´ì¸ë‹¤.</li>
</ul>

<h1 id="experiments">EXPERIMENTS</h1>
<p>CASE NAME, STATUTE, LJP-CRIMINAL, LJP-CIVIL, ê·¸ë¦¬ê³  SUMMARIZATION tasksì— ëŒ€í•˜ì—¬ ì‹¤í—˜ í‰ê°€ë¥¼ ì§„í–‰í•œë‹¤.</p>

<h2 id="model-training">Model training</h2>
<p>ì„œêµìˆ˜ë‹˜ì˜ LK ì—°êµ¬ì†ŒëŠ” í•œì •ëœ ì˜ˆì‚°ìœ¼ë¡œ GPUì™€ ê°™ì€ í•˜ë“œì›¨ì–´ë¥¼ ë”°ë¡œ ì†Œìœ í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ í´ë¼ìš°ë“œë¥¼ ëŒ€ì—¬í•˜ëŠ” ì—°êµ¬ ë°©ì‹ìœ¼ë¡œ ìœ ëª…í•˜ë‹¤.</p>

<p>ì´ë²ˆ í”„ë¡œì íŠ¸ì—ì„œ ì—­ì‹œ í´ë¼ìš°ë“œì—ì„œ Nvidia RTX3090/RTX6000ë¥¼ ëŒ€ì—¬í•˜ì—¬ ëª¨ë¸ í•™ìŠµì„ ì§„í–‰í–ˆë‹¤.</p>

<p>ë‹¤ìŒì€ ëª¨ë¸ í•™ìŠµì— ì‚¬ìš©ëœ parameter settingsì´ë‹¤:</p>
<ul>
  <li><strong>learning rate</strong>: 0.00003-0.0001</li>
  <li><strong>batch</strong>: 8-16</li>
  <li><strong>optimizer</strong>: AdamW</li>
  <li><strong>fine-tuning</strong>: MT5-small (checkpoint: <em>â€˜google/mt5-smallâ€™</em>)</li>
  <li><strong>accracy</strong>: <em>F</em>1</li>
  <li>etc.</li>
</ul>

<blockquote>
  <p>ë³´ë‹¤ ìƒì„¸í•œ specì€ í•´ë‹¹ ë…¼ë¬¸ì„ ì°¸ì¡°í•˜ê¸¸ ë°”ë€ë‹¤.</p>
</blockquote>

<h2 id="metric">Metric</h2>
<ul>
  <li>(1) the case is counted as a true positive if their values are equal</li>
  <li>(2) false positive f their values are not equal</li>
  <li>(3) When the target field exists only in GT but not in the prediction, the case is counted as a false negative.</li>
  <li>(4) If the target field is empty in the GT but exists in the prediction it is counted as a false positive.</li>
  <li>(5) If the field is empty in both GT and the prediction, the case is considered as a truenegative.</li>
</ul>

<blockquote>
  <p>The zero labels in LJP-CRIMINAL are counted as nulls.</p>
</blockquote>

<h2 id="results">Results</h2>
<p><img src="https://user-images.githubusercontent.com/39285147/184300687-c0aa8c4c-5d9c-4156-b674-737bac61bbd8.png" alt="image" /></p>

<p><strong>LCUBE-base</strong> vs. <strong>KoGPT-2</strong></p>
<ul>
  <li>In all tasks except SUMMARIZATION, LCUBE-base shows a higher performance</li>
</ul>

<h1 id="limitations">LIMITATIONS</h1>
<p>í•´ë‹¹ ë…¼ë¬¸ ëª¨ë“  ë‚´ìš©ì€ í•œêµ­ ë²•ì²´ê³„ì˜ first level courtì— ëŒ€í•œ precedentsë§Œì„ ê³ ë ¤í•œ ì—°êµ¬ ê²°ê³¼ì´ë‹¤.</p>

<p>ë˜í•œ, ì›ê³ , í”¼ê³ ì™€ ê°™ì€ ìš”ì¸ë“¤ì„ ì¸í’‹ìœ¼ë¡œ ê³ ë ¤í•˜ì§€ ì•Šì€ íŒê²° ì˜ˆì¸¡ ê²°ê³¼ë¼ê³  ê°€ì •í•˜ë©°, LBOX OPENì€ legal information retrieval task ë“± ì—¬ëŸ¬ ë¬¸ì œì— ëŒ€í•œ ì‚¬ë¡€ ì •ë³´ëŠ” ë°˜ì˜í•˜ì§€ ì•ŠëŠ”ë‹¤.</p>

<p>ìƒê¸° ì–¸ê¸‰ëœ í•œê³„ì ë“¤ì€ ì‹œìŠ¤í…œì ìœ¼ë¡œ êµ¬í˜„ì´ ë§¤ìš° ê¹Œë‹¤ë¡œìš°ë©°, ë„ë©”ì¸ ì§€ì‹ì´ í’ë¶€í•œ ì—¬ëŸ¬ ì „ë¬¸ê°€ì™€ì˜ í˜‘ì—…ì´ í•„ìš”ì‹œ ë ê²ƒì´ë©°, ì´ê²ƒì´ ê³§ LBOX OPENì˜ ë¯¸ë˜ ê³¼ì œì¼ ê²ƒì´ë‹¤.</p>]]></content><author><name>ì­ŒìŠ¤ğŸ„</name></author><category term="AIPaperNLP" /><category term="AI Research Paper" /><category term="Kaist" /><summary type="html"><![CDATA[]]></summary></entry><entry><title type="html">Part 3: BERT Language Model</title><link href="http://localhost:4000/bert/bert-3/" rel="alternate" type="text/html" title="Part 3: BERT Language Model" /><published>2022-08-08T00:00:00+09:00</published><updated>2022-08-08T00:00:00+09:00</updated><id>http://localhost:4000/bert/bert-3</id><content type="html" xml:base="http://localhost:4000/bert/bert-3/"><![CDATA[<h1 id="bert">BERT</h1>
<p>Bi-directional transformerë¡œ ì´ë£¨ì–´ì§„ ì–¸ì–´ëª¨ë¸ë¡œ, BERT ì–¸ì–´ëª¨ë¸ ìœ„ì— 1ê°œì˜ classification layerë§Œ ë¶€ì°©í•˜ì—¬ ë‹¤ì–‘í•œ NLP taskë¥¼ ìˆ˜í–‰í•œë‹¤.</p>

<h1 id="wordpiece-tokenizing">WordPiece tokenizing</h1>
<p>ì…ë ¥ ë¬¸ì¥ì„ toeknizingí•˜ê³ , ê·¸ tokenë“¤ë¡œ â€˜token sequenceâ€™ë¥¼ ë§Œë“¤ì–´ í•™ìŠµì— ì‚¬ìš©í•œë‹¤.</p>

<p>BPEì™€ëŠ” ë‹¤ë¥´ê²Œ WordPieceëŠ” <strong>ìš°ë„</strong>ë¡œ ë³‘í•©ì„ ì§„í–‰í•˜ì—¬, ë‘ ë¬¸ìê°€ ê°™ì´ ì˜¤ëŠ” ë¬¸ì ë‹¨ìœ„ë¥¼ ì¤‘ìš”ì‹œí•œë‹¤.</p>

<blockquote>
  <p><em>ìš°ë„</em>: ì „ì²´ ê¸€ì ì¤‘ ê° ë‹¨ì–´ê°€ ë”°ë¡œ ë“±ì¥í•œ ê²ƒì„ â€˜ë¶„ëª¨â€™ë¡œ, ê°™ì´ ë“±ì¥í•œ ë¹ˆë„ìˆ˜ë¥¼ â€˜ë¶„ìâ€™ë¡œ ì‚¼ëŠ”ë‹¤.</p>
</blockquote>

<h1 id="bpe-byte-pair-encoding">BPE (Byte Pair Encoding)</h1>
<p><img src="https://user-images.githubusercontent.com/39285147/183617390-94429c10-1868-4967-a534-f56199dfeba3.png" alt="image" /></p>

<p>ì´ëŸ¬í•œ ì‘ì—…ì„ ìœ„í•´ ë¹ˆë„ìˆ˜ì— ê¸°ë°˜í•˜ì—¬ í† í°ì„ ë³‘í•©í•˜ëŠ” <strong>BPE (Byte Pair Encoding)</strong> ì•Œê³ ë¦¬ì¦˜ì„ ì´ìš©í•œë‹¤.</p>

<p>BPEëŠ” ì–¸ì–´ ì§‘í•©ì˜ í¬ê¸°ëŠ” ì–µì œí•˜ë©´ì„œ ì‹œí€€ìŠ¤ì˜ ê¸¸ì´ë¥¼ ì••ì¶•í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ì´ë‹¤ (<em>ì‹œí€€ìŠ¤ ì••ì¶•</em>: â€˜l, o, wâ€™ â€“&gt; â€˜lowâ€™).</p>

<p>Word2Vecìœ¼ë¡œ ì–´ì ˆ ë‹¨ìœ„ë¡œ 1ì°¨ tokenizingì„ ì§„í•¸í•œ í›„, iterationì„ í†µí•´ ë‚˜íƒ€ë‚œ token sequence ë¹ˆë„ìˆ˜ì— ê¸°ë°˜í•˜ì—¬ <strong>ì˜ë¯¸ ìˆëŠ” íŒ¨í„´(subword)</strong>ìœ¼ë¡œ ì˜ë¼ì„œ tokenizingí•œë‹¤.</p>

<p>ê°€ë ¹, BERT ëª¨ë¸ì€ â€˜ê³ ì–‘ê²½ì°°ì„œâ€™ì™€ â€˜ì¢…ë¡œê²½ì°°ì„œâ€™ì—ì„œ â€˜##ê²½ì°°ì„œâ€™ë¼ëŠ” token sequenceë¥¼ í˜•ì„±í•œë‹¤.</p>

<h1 id="etri-korbert">ETRI KorBERT</h1>
<p>í•œêµ­ì–´ëŠ” ì˜ì–´ì™€ ë‹¤ë¥´ê²Œ <strong>ì¡°ì‚¬ì˜ ì“°ì„ì— ë”°ë¼ í˜•íƒœì†Œê°€ ë³€í•˜ëŠ” ë¬¸ë²•ì  íŠ¹ì„±</strong>ë‚˜ <strong>êµì°©ì–´</strong> ë“± NLP ì²˜ë¦¬ì— ê¹Œë‹¤ë¡œìš´ tasksë¥¼ ìˆ˜ë°˜í•˜ëŠ” ì–¸ì–´ ì¤‘ í•˜ë‚˜ì´ë‹¤.</p>

<p>ì˜ì–´ BERT ëª¨ë¸ê³¼ ë‹¤ë¥´ê²Œ, í˜•íƒœì†Œ ë‹¨ìœ„ë¡œ corpusë¥¼ ë¶„ì ˆí•˜ê³ (= <em>Mecab tokenzier</em>) Word2Vecìœ¼ë¡œ 1ì°¨ tokenizing ì´ì „ì— í˜•íƒœì†Œ íƒœê·¸ë¥¼ ë‹¨ì–´ë§ˆë‹¤ ë¶™ì—¬ë†“ëŠ” <strong>labeling ì‘ì—…</strong>ì´ ìˆ˜ë°˜ëœë‹¤.</p>

<p>ì´ ì‘ì—…ì€ í…ìŠ¤íŠ¸ê°€ ë” ìª¼ê°œì§ˆ ìˆ˜ ìˆë„ë¡ ë„ì™€ì¤€ë‹¤</p>
<ul>
  <li>ê°€ë ¹, â€˜ì´â€™ë¼ëŠ” ë‹¨ì–´ê°€ ì–´ë–¤ ê²ƒì„ ê°€ë¥´í‚¤ëŠ” ì´ê²ƒì˜ ì˜ë¯¸ì¸ì§€ ìˆ«ì 2ì˜ ì˜ë¯¸ì¸ì§€ êµ¬ë¶„í•´ì¤€ë‹¤.</li>
</ul>

<p><strong>KorBERT Morphology</strong>ì™€ <strong>KorBERT WordPiece</strong> ë‘ ê°€ì§€ ì„¸ë¶€ ëª¨ë¸ì´ ì¡´ì¬í•œë‹¤.</p>

<h2 id="korbert-ì„±ëŠ¥ì—-ì˜í–¥ì„-ë¯¸ì¹˜ëŠ”-ìš”ì¸">KorBERT ì„±ëŠ¥ì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ìš”ì¸</h2>
<ul>
  <li>Corpus ì‚¬ì´ì¦ˆ</li>
  <li>Corpus ë„ë©”ì¸</li>
  <li>Corpus tokenizing (ì–´ì ˆ, BPE, í˜•íƒœì†Œ)</li>
  <li>Vocab ì‚¬ì´ì¦ˆ å°</li>
  <li><strong>ë°ì´í„° ì „ì²˜ë¦¬</strong></li>
</ul>

<h1 id="korbert-ì‹¤ìŠµ-ê³¼ì •">KorBERT ì‹¤ìŠµ ê³¼ì •</h1>
<ol>
  <li>
    <p>ì›í•˜ëŠ” <strong>corpus</strong> í…ìŠ¤íŠ¸(ê°€ë ¹, ìœ„í‚¤ ê¸°ì‚¬) ë¶ˆëŸ¬ì˜¤ê¸°</p>
  </li>
  <li>
    <p><strong>SentenceTokenizer</strong>/WordTokenizer 1ì°¨ ë¶„ì ˆ</p>
  </li>
  <li>â€˜Mecabâ€™ tokenizer ê¸°ë°˜ <strong>í˜•íƒœì†Œ ë‹¨ìœ„ ë¶„ì ˆ</strong>
    <ul>
      <li>â€˜Mecabâ€™ì´ ê°€ì¥ ì„±ëŠ¥ì´ ì¢‹ë‹¤.</li>
    </ul>
  </li>
  <li><strong>êµì°©ì–´ ë°©ì§€ token sequences í˜•ì„±</strong> (â€˜<em>BertWordPieceTokenizer</em>â€™)
    <ul>
      <li>GPT ëª¨ë¸ì€ â€˜<em>ByteLevelBPETokenizer</em>â€˜ë¥¼ ì‚¬ìš©í•œë‹¤/</li>
    </ul>
  </li>
  <li>
    <p>ë°ì´í„° ì „ì²˜ë¦¬ (i.e., ë¶ˆìš©ì–´ ë“± ì œê±°)</p>
  </li>
  <li>
    <p>BERT í•™ìŠµ</p>
  </li>
  <li><em>*KorQuAD</em> ë°ì´í„°ì…‹ìœ¼ë¡œ í•™ìŠµëœ BERT ëª¨ë¸ í‰ê°€
    <ul>
      <li><em>KorQuAD</em>: ìì—°ì–´ ì´í•´(NLU, Natural Language Understanding) í•™ìŠµìš© í•œêµ­ì–´ ì§ˆì˜ì‘ë‹µ í‘œì¤€ ë°ì´í„°ì…‹ì´ë‹¤.</li>
    </ul>
  </li>
  <li>
    <p><a href="https://github.com/e9t/nsmc"><em>BERT ë„¤ì´ë²„ ì˜í™” ë¦¬ë·° ë°ì´í„° ê°ì„±ë¶„ì„</em></a></p>
  </li>
  <li>
    <p><a href="https://github.com/machinereading/kor-re-gold"><em>BERT ê´€ê³„ ì¶”ì¶œ</em></a></p>
  </li>
  <li><strong>ìœ íŠœë¸Œ ëŒ“ê¸€ ë°ì´í„° ê°ì„± ë¶„ì„</strong> (ë°ì´í„° ìˆ˜ì§‘: â€˜<em>ì¸íŠ¸ëœë“œ</em>â€™)</li>
</ol>

<h1 id="references">References</h1>
<p><a href="https://www.slideshare.net/qksksk657/korquad-v10"><em>KorQuAD</em></a></p>

<p><a href="https://arxiv.org/abs/1810.04805"><em>BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding</em></a></p>]]></content><author><name>ì­ŒìŠ¤ğŸ„</name></author><category term="BERT" /><category term="NLP" /><category term="BERT" /><category term="Language Model" /><summary type="html"><![CDATA[BERT Bi-directional transformerë¡œ ì´ë£¨ì–´ì§„ ì–¸ì–´ëª¨ë¸ë¡œ, BERT ì–¸ì–´ëª¨ë¸ ìœ„ì— 1ê°œì˜ classification layerë§Œ ë¶€ì°©í•˜ì—¬ ë‹¤ì–‘í•œ NLP taskë¥¼ ìˆ˜í–‰í•œë‹¤.]]></summary></entry></feed>